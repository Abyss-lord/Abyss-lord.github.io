<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Gravitino committer</title>
      <link href="/2025/07/04/2025-07-04-gravitino-committer/"/>
      <url>/2025/07/04/2025-07-04-gravitino-committer/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h2><p>Apache è½¯ä»¶åŸºé‡‘ä¼š(ä»¥ä¸‹ç®€ç§° AFS)æ˜¯ä¸–ç•Œä¸Šæœ€å¤§çš„å¼€æºè½¯ä»¶åŸºé‡‘ä¼šï¼Œæˆªæ­¢ç›®å‰å®˜æ–¹çš„ä¸€äº›ç»Ÿè®¡æ•°æ®ï¼š</p><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/img/v2-b3abcd6cf476d6a29e782040be26b424_1440w.jpg" alt="ASF ç»Ÿè®¡"></p><p>ASF èƒ½ä¿è¯æ——ä¸‹ 320 å¤šä¸ªé¡¹ç›®çš„ç¤¾åŒºæ´»åŠ¨è¿è½¬è‰¯å¥½ï¼Œå¾—ç›Šäºå…¶ç‹¬ç‰¹çš„ç»„ç»‡æ¶æ„å’Œè‰¯å¥½çš„åˆ¶åº¦ã€‚</p><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/img/20250704ASF%20%E9%A1%B9%E7%9B%AE%E7%BB%84%E7%BB%87%E6%9E%B6%E6%9E%84.png" alt="ASF é¡¹ç›®ç»„ç»‡æ¶æ„"></p><ul><li>ç”¨æˆ· (User): é€šè¿‡ä½¿ç”¨ç¤¾åŒºçš„é¡¹ç›®æ„å»ºè‡ªå·±çš„ä¸šåŠ¡æ¶æ„çš„å¼€å‘è€…éƒ½æ˜¯ Apache çš„ç”¨æˆ·ã€‚</li><li>è´¡çŒ®è€… (Contributor): å¸®åŠ©è§£ç­”ç”¨æˆ·çš„é—®é¢˜ï¼Œè´¡çŒ®ä»£ç æˆ–æ–‡æ¡£ï¼Œåœ¨é‚®ä»¶åˆ—è¡¨ä¸­å‚ä¸è®¨è®ºè®¾è®¡å’Œæ–¹æ¡ˆçš„éƒ½æ˜¯ Contributorã€‚</li><li>æäº¤è€… (Committer): è´¡çŒ®å¤šäº†ä»¥åï¼Œå°±æœ‰å¯èƒ½ç»è¿‡ PMC çš„æè®®å’ŒæŠ•ç¥¨ï¼Œé‚€è¯·ä½ æˆä¸º Committerã€‚æˆä¸º Committer ä¹Ÿå°±æ„å‘³ç€æ­£å¼åŠ å…¥ Apacheäº†ï¼Œä¸ä½†æ‹¥æœ‰ç›¸åº”é¡¹ç›®çš„å†™å…¥æƒé™è¿˜æœ‰ <a href="http://apache.org">apache.org</a> çš„ä¸“å±é‚®ç®±ã€‚æˆä¸º Committer çš„ä¸€ä¸ªç¦åˆ©æ˜¯å¯ä»¥å…è´¹ä½¿ç”¨ JetBrains å®¶çš„å…¨å¥—ä»˜è´¹äº§å“ï¼ŒåŒ…æ‹¬å…¨å®‡å®™æœ€å¥½ç”¨çš„ IntelliJ IDEAã€‚</li><li>PMC: Committer å†å¾€ä¸Šèµ°å°±æ˜¯ PMCï¼Œè¿™ä¸ªå¿…é¡»ç”±ç°æœ‰ PMC æˆå‘˜æåã€‚PMC ä¸»è¦è´Ÿè´£ä¿è¯å¼€æºé¡¹ç›®çš„ç¤¾åŒºæ´»åŠ¨éƒ½èƒ½è¿è½¬è‰¯å¥½ï¼ŒåŒ…æ‹¬ Roadmap çš„åˆ¶å®šï¼Œç‰ˆæœ¬çš„å‘å¸ƒï¼ŒCommitter çš„ææ‹”ã€‚</li><li>ASF Member ç›¸å½“äºæ˜¯åŸºé‡‘ä¼šçš„â€œè‚¡ä¸œâ€ï¼Œæœ‰è‘£äº‹ä¼šé€‰ä¸¾çš„æŠ•ç¥¨æƒï¼Œä¹Ÿå¯ä»¥å‚ä¸è‘£äº‹ä¼šç«é€‰ã€‚ASF Member ä¹Ÿæœ‰æƒåˆ©å†³å®šæ˜¯å¦æ¥å—ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œä¸»è¦å…³æ³¨ Apache åŸºé‡‘ä¼šæœ¬èº«çš„å‘å±•ã€‚ASF Member é€šå¸¸è¦ä» Contributor, Committer ç­‰è¿™äº›è§’è‰²èµ·æ­¥ï¼Œé€æ­¥é€šè¿‡è¡ŒåŠ¨è¯æ˜è‡ªå·±åï¼Œæ‰å¯èƒ½è¢«æ¥å—æˆä¸ºASF Memberã€‚</li></ul><h2 id="æˆä¸º-committer"><a class="markdownIt-Anchor" href="#æˆä¸º-committer"></a> æˆä¸º Committer</h2><p>ğŸ‰å®ï¼å¼€æºæˆå°± +1 ğŸ–ï¸<br>å¾ˆè£å¹¸æ­£å¼æˆä¸º Apache Gravitino çš„ Committerï¼</p><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/img/%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_95575bcd-629f-47f9-9203-657e17c3a911.png" alt="Gravitino Committer"></p><p>æ„Ÿè°¢ Gravitino ç¤¾åŒºçš„æ¯ä¸€ä½å°ä¼™ä¼´ï¼Œæ„Ÿè°¢ä½ ä»¬çš„è€å¿ƒæŒ‡å¯¼ã€æ— ç§åˆ†äº«ï¼Œä»¥åŠä¸€æ¬¡æ¬¡ç»†è‡´å…¥å¾®çš„ code reviewã€‚æ²¡æœ‰ä½ ä»¬çš„å¸®åŠ©ï¼Œæˆ‘æ— æ³•å–å¾—ä»Šå¤©çš„æˆæœã€‚ä¹Ÿç‰¹åˆ«æ„Ÿè°¢å…¬å¸é¢†å¯¼å’Œå›¢é˜Ÿçš„æ”¯æŒï¼Œè®©æˆ‘èƒ½å¤Ÿåœ¨å·¥ä½œä¸­æŒç»­ã€æ·±å…¥åœ°å‚ä¸å¼€æºï¼Œå°†çƒ­çˆ±è½¬åŒ–ä¸ºçœŸæ­£çš„å½±å“åŠ›ã€‚</p><p>æœ€åï¼Œç”±è¡·æ„Ÿè°¢ä¸€ç›´é™ªä¼´åœ¨æˆ‘èº«è¾¹çš„è€å©†ç‹—ğŸ¶â€”â€”é‚£äº›ç„¦è™‘çš„æ—¥å¤œé‡Œï¼Œæ˜¯ä½ çš„ç†è§£ä¸é™ªä¼´æŠšå¹³äº†æˆ‘çš„æƒ…ç»ªï¼Œè®©æˆ‘å¾—ä»¥åšå®šåœ°èµ°ä¸‹å»ã€‚</p><p>æ¯ä¸€æ¬¡æœºä¼šéƒ½æ¥ä¹‹ä¸æ˜“ï¼Œæ„¿æˆ‘ä»¬éƒ½èƒ½æŠ“ä½äººç”Ÿä¸­çš„æ¯ä¸€ä¸ªå¯èƒ½ï¼Œåœ¨çƒ­çˆ±ä¸­åšå®šå‰è¡Œ â¤ï¸</p>]]></content>
      
      
      <categories>
          
          <category> ä¸ªäºº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> github </tag>
            
            <tag> committer </tag>
            
            <tag> ASF </tag>
            
            <tag> å¼€æº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gravitino å¦‚ä½•è¿›è¡Œ JMH æµ‹è¯•</title>
      <link href="/2025/07/02/gravitino/2025-07-02-jmh/"/>
      <url>/2025/07/02/gravitino/2025-07-02-jmh/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è§ˆ"><a class="markdownIt-Anchor" href="#æ¦‚è§ˆ"></a> æ¦‚è§ˆ</h2><p>Gravitino JMH ç›®å½•åŒ…å«ä¸€å¥—åŸºäº&nbsp;JMH&nbsp;çš„å¾®åŸºå‡†æµ‹è¯•ï¼ˆMicrobenchmarkï¼‰å¥—ä»¶ï¼Œä¸“é—¨ç”¨äºè¯„ä¼° Gravitino ä¸­æ ¸å¿ƒå­ç³»ç»Ÿçš„æ€§èƒ½ç‰¹å¾ï¼Œå¦‚ï¼šå®ä½“ç¼“å­˜ï¼ˆEntity Cacheï¼‰ã€å…ƒæ•°æ®è§£æé€»è¾‘ä»¥åŠå¹¶å‘æ§åˆ¶æœºåˆ¶ç­‰ã€‚</p><h2 id="æ‰§è¡Œæ–¹å¼"><a class="markdownIt-Anchor" href="#æ‰§è¡Œæ–¹å¼"></a> æ‰§è¡Œæ–¹å¼</h2><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿è¡Œ JMH æµ‹è¯•ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./gradlew :core:jmh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æµ‹è¯•å®Œæˆåï¼Œç»“æœå°†ä¿å­˜äºï¼š<code>build/reports/jmh</code>&nbsp;ç›®å½•ä¸­ã€‚</p><h2 id="ç¤ºä¾‹æŠ¥å‘Šæ ¼å¼"><a class="markdownIt-Anchor" href="#ç¤ºä¾‹æŠ¥å‘Šæ ¼å¼"></a> ç¤ºä¾‹æŠ¥å‘Šæ ¼å¼</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Benchmark                                         <span class="token punctuation">(</span>totalCnt<span class="token punctuation">)</span>  Mode  Cnt        Score        Error  UnitsEntityCacheGetBenchmark.benchmarkGet                     <span class="token number">100</span>  thrpt   <span class="token number">10</span>  <span class="token number">17906401.139</span> Â±  <span class="token number">905521.957</span>  ops/sEntityCachePutBenchmark.benchmarkPut                   <span class="token number">1000</span>  avgt    <span class="token number">10</span>       <span class="token number">0.002</span> Â±     <span class="token number">0.001</span>   s/op<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li><strong>Score</strong>ï¼šæ¯ç§’æ“ä½œæ•°æˆ–æ¯æ¬¡è°ƒç”¨è€—æ—¶ï¼›</li><li><strong>Error</strong>ï¼šè¯¯å·®èŒƒå›´ï¼ˆé€šå¸¸ä¸º 99.9% ç½®ä¿¡åŒºé—´ï¼‰ï¼Œå³ç»“æœå¯ä¿¡åŒºé—´ä¸º Score Â± Errorï¼›</li></ul><p>ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Score: <span class="token number">19008727.28</span> ops/sError: Â± <span class="token number">1172892.70</span> ops/s<span class="token operator">=</span><span class="token operator">&gt;</span> å®é™…æ€§èƒ½å¤§æ¦‚ç‡å¤„äº <span class="token number">17,835</span>,834 ~ <span class="token number">20,181</span>,620 ops/s ä¹‹é—´<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¯¯å·®è¶Šå°ï¼Œè¯´æ˜æµ‹è¯•ç»“æœè¶Šç¨³å®šå¯é ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯-jmh"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯-jmh"></a> ä»€ä¹ˆæ˜¯ JMHï¼Ÿ</h2><p>JMHï¼ˆJava Microbenchmark Harnessï¼‰æ˜¯ OpenJDK å›¢é˜Ÿä¸“ä¸º Java å¾®åŸºå‡†æµ‹è¯•å¼€å‘çš„æ¡†æ¶ï¼Œä¸»è¦ç”¨äºç²¾ç¡®æµ‹é‡æ–¹æ³•è°ƒç”¨ã€ç¼“å­˜è®¿é—®ã€å¯¹è±¡åˆ†é…ç­‰ç»†ç²’åº¦æ“ä½œçš„æ€§èƒ½ã€‚</p><p>ç›¸è¾ƒäºä¼ ç»Ÿæµ‹è¯•æ–¹å¼ï¼ŒJMH èƒ½å¤„ç†å¦‚ä¸‹å½±å“å› ç´ ï¼š</p><ul><li>JIT ç¼–è¯‘å’Œ JVM çƒ­èº«ï¼ˆwarm-upï¼‰</li><li>æ­»ä»£ç æ¶ˆé™¤ï¼ˆDead Code Eliminationï¼‰</li><li>é€ƒé€¸åˆ†æï¼ˆEscape Analysisï¼‰</li><li>çº¿ç¨‹äº‰ç”¨å’Œä¼ªå…±äº«ï¼ˆFalse Sharingï¼‰</li></ul><p>JMH æä¾›åŸºäºæ³¨è§£çš„ APIï¼Œå¹¶è‡ªåŠ¨å¤„ç†å¤šæ¬¡è¿­ä»£ã€é¢„çƒ­ã€JVM fork å’Œç»Ÿè®¡æŠ¥å‘Šï¼Œå·²è¢«å¹¿æ³›åº”ç”¨äº JDKã€Springã€Nettyã€Lucene ç­‰é«˜æ€§èƒ½é¡¹ç›®ã€‚</p><h3 id="ç¤ºä¾‹åŸºå‡†ä»£ç "><a class="markdownIt-Anchor" href="#ç¤ºä¾‹åŸºå‡†ä»£ç "></a> ç¤ºä¾‹åŸºå‡†ä»£ç </h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@BenchmarkMode</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">Mode<span class="token punctuation">.</span>Throughput</span><span class="token punctuation">,</span> <span class="token class-name">Mode<span class="token punctuation">.</span>AverageTime</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token annotation punctuation">@OutputTimeUnit</span><span class="token punctuation">(</span><span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token annotation punctuation">@State</span><span class="token punctuation">(</span><span class="token class-name">Scope<span class="token punctuation">.</span>Thread</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StringConnectTest</span> <span class="token punctuation">{</span>  <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"10"</span><span class="token punctuation">,</span> <span class="token string">"50"</span><span class="token punctuation">,</span> <span class="token string">"100"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token keyword">private</span> <span class="token keyword">int</span> length<span class="token punctuation">;</span>  <span class="token annotation punctuation">@Benchmark</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testStringAdd</span><span class="token punctuation">(</span><span class="token class-name">Blackhole</span> blackhole<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token class-name">String</span> a <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      a <span class="token operator">+=</span> i<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    blackhole<span class="token punctuation">.</span><span class="token function">consume</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token annotation punctuation">@Benchmark</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testStringBuilderAdd</span><span class="token punctuation">(</span><span class="token class-name">Blackhole</span> blackhole<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    blackhole<span class="token punctuation">.</span><span class="token function">consume</span><span class="token punctuation">(</span>sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="å¸¸ç”¨æ³¨è§£è¯´æ˜"><a class="markdownIt-Anchor" href="#å¸¸ç”¨æ³¨è§£è¯´æ˜"></a> å¸¸ç”¨æ³¨è§£è¯´æ˜</h4><table><thead><tr><th>æ³¨è§£</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>@Benchmark</code></td><td>å£°æ˜åŸºå‡†æ–¹æ³•ï¼ŒJMH ä¼šå¤šæ¬¡è°ƒç”¨å¹¶æµ‹é‡å…¶æ€§èƒ½</td></tr><tr><td><code>@BenchmarkMode</code></td><td>è®¾ç½®æµ‹é‡æ¨¡å¼ï¼Œå¦‚ååé‡ï¼ˆThroughputï¼‰ã€å¹³å‡æ—¶é—´ï¼ˆAverageTimeï¼‰</td></tr><tr><td><code>@OutputTimeUnit</code></td><td>è®¾ç½®æ—¶é—´å•ä½ï¼Œå¦‚ç§’ï¼ˆSECONDSï¼‰ã€æ¯«ç§’ã€çº³ç§’ç­‰</td></tr><tr><td><code>@State</code></td><td>è®¾ç½®å¯¹è±¡å…±äº«ç²’åº¦ï¼Œå¸¸ç”¨ä¸º&nbsp;<code>Scope.Thread</code>ï¼ˆæ¯çº¿ç¨‹ç‹¬ç«‹ï¼‰</td></tr><tr><td><code>@Param</code></td><td>å‚æ•°åŒ–æµ‹è¯•ï¼Œç”Ÿæˆå¤šç»„è¾“å…¥ç”¨ä¾‹</td></tr></tbody></table><h4 id="benchmarkmode-æ¨¡å¼è¯´æ˜"><a class="markdownIt-Anchor" href="#benchmarkmode-æ¨¡å¼è¯´æ˜"></a> BenchmarkMode æ¨¡å¼è¯´æ˜</h4><table><thead><tr><th>æ¨¡å¼</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><code>Throughput</code></td><td>ååé‡ï¼Œæ¯ç§’å®Œæˆæ“ä½œæ•°</td></tr><tr><td><code>AverageTime</code></td><td>æ¯æ¬¡æ“ä½œçš„å¹³å‡è€—æ—¶</td></tr><tr><td><code>SampleTime</code></td><td>å¯¹å¤šä¸ªæ ·æœ¬æµ‹é‡æ“ä½œè€—æ—¶ï¼Œå±•ç¤ºåˆ†å¸ƒ</td></tr><tr><td><code>SingleShotTime</code></td><td>å•æ¬¡è°ƒç”¨è€—æ—¶ï¼Œé€‚åˆå†·å¯åŠ¨åˆ†æ</td></tr><tr><td><code>All</code></td><td>æ‰§è¡Œæ‰€æœ‰æ¨¡å¼</td></tr></tbody></table><h2 id="åœ¨-gravitino-ä¸­ä½¿ç”¨-jmh"><a class="markdownIt-Anchor" href="#åœ¨-gravitino-ä¸­ä½¿ç”¨-jmh"></a> åœ¨ Gravitino ä¸­ä½¿ç”¨ JMH</h2><p>Gravitino ä½¿ç”¨&nbsp;<a href="https://github.com/melix/jmh-gradle-plugin">jmh-gradle-plugin</a>&nbsp;é›†æˆ JMH åˆ° Gradle æ„å»ºä¸­ã€‚</p><h3 id="æ’ä»¶é…ç½®"><a class="markdownIt-Anchor" href="#æ’ä»¶é…ç½®"></a> æ’ä»¶é…ç½®</h3><p>åœ¨&nbsp;<code>build.gradle</code>&nbsp;ä¸­æ·»åŠ ï¼š</p><pre class="line-numbers language-groovy" data-language="groovy"><code class="language-groovy">plugins <span class="token punctuation">{</span>  id <span class="token interpolation-string"><span class="token string">"me.champeau.jmh"</span></span> version <span class="token interpolation-string"><span class="token string">"0.7.3"</span></span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p>æ³¨æ„ï¼š0.6.0 ä¹‹å‰ç‰ˆæœ¬çš„æ’ä»¶ ID ä¸º&nbsp;<code>me.champeau.gradle.jmh</code></p></blockquote><h3 id="ç›®å½•ç»“æ„"><a class="markdownIt-Anchor" href="#ç›®å½•ç»“æ„"></a> ç›®å½•ç»“æ„</h3><p>åŸºå‡†æµ‹è¯•æ–‡ä»¶éœ€æ”¾ç½®äºä»¥ä¸‹ç›®å½•ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">src/jmh/java       <span class="token comment"># Java æµ‹è¯•ä»£ç </span>src/jmh/resources  <span class="token comment"># èµ„æºæ–‡ä»¶ï¼ˆå¯é€‰ï¼‰</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="ä¾èµ–å¼•å…¥"><a class="markdownIt-Anchor" href="#ä¾èµ–å¼•å…¥"></a> ä¾èµ–å¼•å…¥</h3><p>è‹¥åŸºå‡†æµ‹è¯•ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚ commons-ioï¼Œå¯åœ¨&nbsp;<code>dependencies</code>&nbsp;ä¸­æ·»åŠ ï¼š</p><pre class="line-numbers language-groovy" data-language="groovy"><code class="language-groovy">dependencies <span class="token punctuation">{</span>  jmh <span class="token string">'commons-io:commons-io:2.7'</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¦æŒ‡å®š JMH ç‰ˆæœ¬ï¼š</p><pre class="line-numbers language-groovy" data-language="groovy"><code class="language-groovy">dependencies <span class="token punctuation">{</span>  jmh <span class="token string">'org.openjdk.jmh:jmh-core:1.37'</span>  jmh <span class="token string">'org.openjdk.jmh:jmh-generator-annprocess:1.37'</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="jmh-æµ‹è¯•ä»»åŠ¡"><a class="markdownIt-Anchor" href="#jmh-æµ‹è¯•ä»»åŠ¡"></a> JMH æµ‹è¯•ä»»åŠ¡</h3><table><thead><tr><th>ä»»åŠ¡å</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>jmhClasses</code></td><td>ç¼–è¯‘æµ‹è¯•æºä»£ç </td></tr><tr><td><code>jmhRunBytecodeGenerator</code></td><td>è¿è¡Œå­—èŠ‚ç ç”Ÿæˆå™¨</td></tr><tr><td><code>jmhCompileGeneratedClasses</code></td><td>ç¼–è¯‘ç”Ÿæˆä»£ç </td></tr><tr><td><code>jmhJar</code></td><td>æ‰“åŒ…æˆå¯è¿è¡Œ JMH jar</td></tr><tr><td><code>jmh</code></td><td>æ‰§è¡Œæ‰€æœ‰åŸºå‡†æµ‹è¯•ï¼ˆä¸»ä»»åŠ¡ï¼‰</td></tr></tbody></table><p>æ‰§è¡Œå‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./gradlew :core:jmh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="å¸¸ç”¨é…ç½®é¡¹"><a class="markdownIt-Anchor" href="#å¸¸ç”¨é…ç½®é¡¹"></a> å¸¸ç”¨é…ç½®é¡¹</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">jmh <span class="token punctuation">{</span>  includes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'.*Benchmark'</span><span class="token punctuation">]</span>     // æ­£åˆ™åŒ¹é…è¦æ‰§è¡Œçš„æµ‹è¯•ç±»  iterations <span class="token operator">=</span> <span class="token number">10</span>                // æµ‹é‡é˜¶æ®µè¿­ä»£æ¬¡æ•°  warmupIterations <span class="token operator">=</span> <span class="token number">5</span>           // é¢„çƒ­é˜¶æ®µè¿­ä»£æ¬¡æ•°  fork <span class="token operator">=</span> <span class="token number">1</span>                       // JVM å¯åŠ¨æ¬¡æ•°ï¼ˆç‹¬ç«‹è¿è¡Œï¼‰  threads <span class="token operator">=</span> <span class="token number">4</span>                    // å·¥ä½œçº¿ç¨‹æ•°  resultFormat <span class="token operator">=</span> <span class="token string">'CSV'</span>          // æŠ¥å‘Šæ ¼å¼ï¼ˆCSVã€JSONã€TEXTç­‰ï¼‰  resultsFile <span class="token operator">=</span> file<span class="token punctuation">(</span><span class="token string">"<span class="token variable">$buildDir</span>/reports/jmh/results.csv"</span><span class="token punctuation">)</span>  includeTests <span class="token operator">=</span> <span class="token boolean">true</span>            // æ˜¯å¦åŒ…å« <span class="token builtin class-name">test</span> ç›®å½•ä¸­çš„ç±»  duplicateClassesStrategy <span class="token operator">=</span> DuplicatesStrategy.FAIL<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ›´å¤šæ˜ å°„ä¸å‘½ä»¤è¡Œé€‰é¡¹è§ï¼š<a href="https://github.com/melix/jmh-gradle-plugin#configuration-options">é…ç½®é€‰é¡¹æ˜ å°„è¡¨</a></p><h2 id="jmh-è¡¥å……è¯´æ˜"><a class="markdownIt-Anchor" href="#jmh-è¡¥å……è¯´æ˜"></a> JMH è¡¥å……è¯´æ˜</h2><h3 id="ä¸ºä»€ä¹ˆéœ€è¦-warm-upé¢„çƒ­"><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦-warm-upé¢„çƒ­"></a> ä¸ºä»€ä¹ˆéœ€è¦ Warm-upï¼ˆé¢„çƒ­ï¼‰ï¼Ÿ</h3><p>ç”±äº JVM å­˜åœ¨ JIT ç¼–è¯‘æœºåˆ¶ï¼Œé¢‘ç¹è°ƒç”¨çš„æ–¹æ³•å¯èƒ½ä¼šè¢«ç¼–è¯‘ä¸ºæœ¬åœ°ä»£ç ã€‚é¢„çƒ­é˜¶æ®µå¯ç¡®ä¿æµ‹è¯•ç»“æœæ›´è´´è¿‘ç”Ÿäº§ç¯å¢ƒä¸‹çš„çœŸå®æ€§èƒ½ã€‚</p><h3 id="å¯è§†åŒ–å·¥å…·"><a class="markdownIt-Anchor" href="#å¯è§†åŒ–å·¥å…·"></a> å¯è§†åŒ–å·¥å…·</h3><ul><li><a href="http://deepoove.com/jmh-visual-chart/">JMH Visual Chart</a></li><li><a href="https://jmh.morethan.io/">JMH Visualizer</a></li></ul><p>æ”¯æŒå¯¼å…¥ JSON/CSV æŠ¥å‘Šç”Ÿæˆå›¾è¡¨ã€‚</p><h3 id="intellij-æ’ä»¶æ”¯æŒ"><a class="markdownIt-Anchor" href="#intellij-æ’ä»¶æ”¯æŒ"></a> IntelliJ æ’ä»¶æ”¯æŒ</h3><p>å®‰è£… JMH æ’ä»¶åï¼Œå¯åƒè¿è¡Œ JUnit ä¸€æ ·è¿è¡ŒåŸºå‡†æµ‹è¯•ï¼š</p><ul><li>è‡ªåŠ¨ç”Ÿæˆå¸¦&nbsp;<code>@Benchmark</code>&nbsp;çš„æ–¹æ³•æ¨¡æ¿</li><li>å•ç‹¬è¿è¡Œæ–¹æ³•æˆ–ç±»ä¸­çš„æ‰€æœ‰æµ‹è¯•</li><li>æ’ä»¶è·¯å¾„ï¼š<code>File â†’ Settings â†’ Plugins â†’ æœç´¢ JMH</code></li></ul>]]></content>
      
      
      <categories>
          
          <category> æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Gravitino </tag>
            
            <tag> gradle-plugin </tag>
            
            <tag> JMH </tag>
            
            <tag> performance-testing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gravitino å¦‚ä½•è¿›è¡Œä¸€è‡´æ€§æµ‹è¯•</title>
      <link href="/2025/07/02/gravitino/2025-07-02-jcstress/"/>
      <url>/2025/07/02/gravitino/2025-07-02-jcstress/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a class="markdownIt-Anchor" href="#æ¦‚è¿°"></a> æ¦‚è¿°</h2><p>åœ¨ Gravitino ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨&nbsp;<a href="https://github.com/openjdk/jcstress">JCStress</a>&nbsp;æ¡†æ¶è¿›è¡Œå¹¶å‘å‹åŠ›æµ‹è¯•ï¼Œä»¥è¯†åˆ«çº¿ç¨‹å®‰å…¨ç›¸å…³çš„å¾®å¦™ç¼ºé™·ã€‚è¿™ç±»é—®é¢˜å¾€å¾€éš¾ä»¥é€šè¿‡ä¼ ç»Ÿçš„å•å…ƒæµ‹è¯•æ•æ‰ï¼Œä¾‹å¦‚ï¼š</p><ul><li>æ•°æ®ç«äº‰ï¼ˆRace Conditionï¼‰</li><li>å†…å­˜å¯è§æ€§é—®é¢˜ï¼ˆVisibility Violationï¼‰</li><li>åŸå­æ€§ç¼ºå¤±ï¼ˆAtomicity Violationï¼‰</li></ul><p>JCStress èƒ½æœ‰æ•ˆå¸®åŠ©æˆ‘ä»¬éªŒè¯å¹¶å‘ä»£ç çš„æ­£ç¡®æ€§ï¼Œç¡®ä¿ç¼“å­˜ã€å…ƒæ•°æ®ç­‰æ ¸å¿ƒç»„ä»¶å…·å¤‡è‰¯å¥½çš„çº¿ç¨‹å®‰å…¨ä¿éšœã€‚</p><h2 id="ä»€ä¹ˆæ˜¯-jcstress"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯-jcstress"></a> ä»€ä¹ˆæ˜¯ JCStressï¼Ÿ</h2><p><a href="https://github.com/openjdk/jcstress">JCStress</a>&nbsp;æ˜¯ Oracle å®˜æ–¹æä¾›çš„ Java å¹¶å‘æµ‹è¯•å·¥å…·ï¼Œä¸“ä¸ºæ£€æµ‹å¹¶å‘åœºæ™¯ä¸‹çš„éç¡®å®šæ€§é”™è¯¯è€Œè®¾è®¡ã€‚å…¶ä¸»è¦ç‰¹æ€§åŒ…æ‹¬ï¼š</p><ul><li>åœ¨å¤šä¸ªçº¿ç¨‹é—´å¹¶å‘æ‰§è¡Œæ“ä½œï¼Œæ¨¡æ‹Ÿå®é™…ç«äº‰ç¯å¢ƒï¼›</li><li>ä½¿ç”¨å¤§é‡çº¿ç¨‹äº¤é”™ï¼ˆInterleavingï¼‰ç»„åˆåå¤è¿è¡Œï¼›</li><li>æ­ç¤ºæä½æ¦‚ç‡ä½†é«˜å±çš„å¹¶å‘ç¼ºé™·ï¼›</li><li>å°†æµ‹è¯•ç»“æœåˆ†ä¸ºä¸‰ç±»ï¼š<strong>å¯æ¥å—ï¼ˆACCEPTABLEï¼‰</strong>ã€<strong>ç¦æ­¢ï¼ˆFORBIDDENï¼‰</strong>ã€<strong>å€¼å¾—å…³æ³¨ï¼ˆINTERESTINGï¼‰</strong>ã€‚</li></ul><h2 id="å¦‚ä½•è¿è¡Œæµ‹è¯•"><a class="markdownIt-Anchor" href="#å¦‚ä½•è¿è¡Œæµ‹è¯•"></a> å¦‚ä½•è¿è¡Œæµ‹è¯•</h2><p>åœ¨ Gravitino ä¸­ä½¿ç”¨&nbsp;<a href="https://github.com/reyerizo/jcstress-gradle-plugin"><code>jcstress-gradle-plugin</code></a>&nbsp;å°† JCStress é›†æˆåˆ° Gradle build ç³»ç»Ÿä¸­ã€‚</p><p>è¯¥æ’ä»¶çš„ä¼˜åŠ¿å¦‚ä¸‹ï¼š</p><ul><li>è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•è¿è¡Œå™¨ï¼ˆtest harnessï¼‰ï¼›</li><li>æä¾›å†…ç½® Gradle ä»»åŠ¡ï¼ˆå¦‚&nbsp;<code>:core:jcstress</code>ï¼‰ï¼›</li><li>è‡ªåŠ¨ç”ŸæˆæŠ¥å‘Šï¼Œåœ¨&nbsp;<code>build/reports/jcstress/</code>&nbsp;ä¸‹ç”Ÿæˆè¯¦ç»†çš„ HTML æŠ¥å‘Šã€‚</li></ul><h3 id="è¿è¡Œæµ‹è¯•çš„å‘½ä»¤"><a class="markdownIt-Anchor" href="#è¿è¡Œæµ‹è¯•çš„å‘½ä»¤"></a> è¿è¡Œæµ‹è¯•çš„å‘½ä»¤</h3><p>è¿è¡Œæ‰€æœ‰ JCStress æµ‹è¯•ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./gradlew :core:jcstress<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä»…è¿è¡ŒæŒ‡å®šæµ‹è¯•ç±»ï¼ˆæ­£åˆ™åŒ¹é…ï¼‰ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gradle jcstress <span class="token parameter variable">--tests</span> <span class="token string">"MyFirstTest|MySecondTest"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰§è¡Œå®Œæ¯•åï¼Œå¯ä»¥åœ¨å¦‚ä¸‹ä½ç½®æŸ¥çœ‹æŠ¥å‘Šï¼š <code>core/build/reports/jcstress/index.html</code></p><blockquote><p>æµ‹è¯•è¿è¡Œæ—¶é—´å–å†³äºæµ‹è¯•å¤æ‚åº¦ä¸ç³»ç»Ÿ CPU èµ„æºï¼Œé€šå¸¸ä¸ºæ•°åˆ†é’Ÿè‡³æ•°ååˆ†é’Ÿä¸ç­‰ã€‚</p></blockquote><h2 id="è§£è¯»æµ‹è¯•ç»“æœ"><a class="markdownIt-Anchor" href="#è§£è¯»æµ‹è¯•ç»“æœ"></a> è§£è¯»æµ‹è¯•ç»“æœ</h2><p>JCStress çš„æµ‹è¯•ç»“æœä»¥è¡¨æ ¼å½¢å¼å±•ç¤ºï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>æ¯ç§è§‚å¯Ÿç»“æœçš„å†…å®¹ä¸å‡ºç°é¢‘ç‡ï¼›</li><li>æ¯ä¸ªç»“æœçš„æœŸæœ›åˆ†ç±»ï¼ˆACCEPTABLE/FORBIDDEN/INTERESTINGï¼‰ï¼›</li><li>æ€»è¿­ä»£æ¬¡æ•°ä¸æ‰§è¡Œæ—¶é•¿ã€‚</li></ul><p>å¦‚æœæµ‹è¯•å‡ºç°&nbsp;<strong>FAILED</strong>ï¼Œè¯´æ˜æ£€æµ‹åˆ°è¢«å®šä¹‰ä¸º&nbsp;<strong>FORBIDDEN</strong>&nbsp;çš„ç»“æœï¼Œè¡¨ç¤ºå­˜åœ¨æ½œåœ¨å¹¶å‘é—®é¢˜ã€‚</p><h2 id="é…ç½®æ–¹å¼"><a class="markdownIt-Anchor" href="#é…ç½®æ–¹å¼"></a> é…ç½®æ–¹å¼</h2><p>é€šè¿‡åœ¨&nbsp;<code>build.gradle</code>&nbsp;ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼Œå¯è°ƒæ•´æµ‹è¯•ç­–ç•¥ï¼š</p><pre class="line-numbers language-groovy" data-language="groovy"><code class="language-groovy">jcstress <span class="token punctuation">{</span>    verbose <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">"true"</span></span>    timeMillis <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">"200"</span></span>    spinStyle <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">"THREAD_YIELD"</span></span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¸¸ç”¨é…ç½®é¡¹è¯´æ˜ï¼š</p><table><thead><tr><th>é…ç½®é¡¹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>mode</code></td><td>æ‰§è¡Œæ¨¡å¼ï¼š<code>sanity</code>ã€<code>quick</code>ã€<code>default</code>ã€<code>tough</code>ã€<code>stress</code>ã€‚</td></tr><tr><td><code>cpuCount</code></td><td>ä½¿ç”¨çš„ CPU æ ¸å¿ƒæ•°ï¼Œé»˜è®¤ä½¿ç”¨å…¨éƒ¨ã€‚</td></tr><tr><td><code>forks</code></td><td>æ¯ä¸ªæµ‹è¯•è¢« fork çš„æ¬¡æ•°ã€‚</td></tr><tr><td><code>iterations</code></td><td>æ¯ä¸ªæµ‹è¯•çš„è¿­ä»£æ¬¡æ•°ã€‚</td></tr><tr><td><code>heapPerFork</code></td><td>æ¯æ¬¡ fork çš„æœ€å¤§å†…å­˜ï¼ˆMBï¼‰ã€‚</td></tr><tr><td><code>spinStyle</code></td><td>ç­‰å¾…ç­–ç•¥ï¼šå¦‚&nbsp;<code>THREAD_YIELD</code>ã€<code>HARD</code>&nbsp;ç­‰ã€‚</td></tr><tr><td><code>affinityMode</code></td><td>çº¿ç¨‹ä¸ CPU çš„ç»‘å®šæ¨¡å¼ï¼š<code>NONE</code>ã€<code>GLOBAL</code>ã€<code>LOCAL</code>ã€‚</td></tr><tr><td><code>jvmArgs/jvmArgsPrepend</code></td><td>è®¾ç½® JVM å¯åŠ¨å‚æ•°ã€‚</td></tr><tr><td><code>reportDir</code></td><td>æŠ¥å‘Šè¾“å‡ºç›®å½•ã€‚</td></tr></tbody></table><h2 id="å¦‚ä½•ç¼–å†™-jcstress-æµ‹è¯•"><a class="markdownIt-Anchor" href="#å¦‚ä½•ç¼–å†™-jcstress-æµ‹è¯•"></a> å¦‚ä½•ç¼–å†™ JCStress æµ‹è¯•</h2><p>JCStress æä¾›ä¸¤ç§æµ‹è¯•é£æ ¼ï¼Œé€‚ç”¨äºä¸åŒçš„å¹¶å‘éªŒè¯åœºæ™¯ã€‚</p><h3 id="é£æ ¼ä¸€åŸºäº-arbiter-çš„æµ‹è¯•"><a class="markdownIt-Anchor" href="#é£æ ¼ä¸€åŸºäº-arbiter-çš„æµ‹è¯•"></a> é£æ ¼ä¸€ï¼šåŸºäº Arbiter çš„æµ‹è¯•</h3><p>ç‰¹ç‚¹æ˜¯é€šè¿‡ç‹¬ç«‹çš„&nbsp;<code>@Arbiter</code>&nbsp;æ–¹æ³•è§‚å¯Ÿæœ€ç»ˆçŠ¶æ€ï¼š</p><ol><li>å®šä¹‰å…±äº«å˜é‡ï¼›</li><li>ç”¨&nbsp;<code>@Actor</code>&nbsp;æ³¨è§£è¦å¹¶å‘æ‰§è¡Œçš„æ–¹æ³•ï¼›</li><li>ç”¨&nbsp;<code>@Arbiter</code>&nbsp;æ³¨è§£æ ‡æ³¨æœ€ç»ˆçš„è§‚å¯Ÿæ–¹æ³•ï¼›</li><li>ä½¿ç”¨&nbsp;<code>@JCStressTest</code>&nbsp;+&nbsp;<code>@Outcome</code>&nbsp;æ ‡æ³¨é¢„æœŸç»“æœã€‚</li></ol><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@JCStressTest</span><span class="token annotation punctuation">@Outcome</span><span class="token punctuation">(</span>id <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">,</span> expect <span class="token operator">=</span> <span class="token class-name">Expect</span><span class="token punctuation">.</span><span class="token constant">ACCEPTABLE</span><span class="token punctuation">,</span> desc <span class="token operator">=</span> <span class="token string">"æ­£å¸¸ç»“æœ"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Outcome</span><span class="token punctuation">(</span>id <span class="token operator">=</span> <span class="token string">"0"</span><span class="token punctuation">,</span> expect <span class="token operator">=</span> <span class="token class-name">Expect</span><span class="token punctuation">.</span><span class="token constant">FORBIDDEN</span><span class="token punctuation">,</span> desc <span class="token operator">=</span> <span class="token string">"å‡ºç°ç«æ€"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@State</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArbiterTest</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> x<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Actor</span>    <span class="token keyword">void</span> <span class="token function">actor1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Actor</span>    <span class="token keyword">void</span> <span class="token function">actor2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Arbiter</span>    <span class="token keyword">void</span> <span class="token function">arbiter</span><span class="token punctuation">(</span><span class="token class-name">I_Result</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>        r<span class="token punctuation">.</span>r1 <span class="token operator">=</span> x<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="é£æ ¼äºŒç›´æ¥ç»“æœè®°å½•direct-result-reporting"><a class="markdownIt-Anchor" href="#é£æ ¼äºŒç›´æ¥ç»“æœè®°å½•direct-result-reporting"></a> é£æ ¼äºŒï¼šç›´æ¥ç»“æœè®°å½•ï¼ˆDirect Result Reportingï¼‰</h3><p>ç‰¹ç‚¹æ˜¯ <code>actor</code> æ–¹æ³•ç›´æ¥è®°å½•æµ‹è¯•ç»“æœå¹¶å†™å…¥ç»“æœå¯¹è±¡</p><ol><li>å®šä¹‰å…±äº«å˜é‡ï¼›</li><li><code>@Actor</code>&nbsp;æ–¹æ³•æ¥æ”¶ç»“æœå‚æ•°ï¼Œå¦‚&nbsp;<code>II_Result</code>ï¼›</li><li>è®°å½•è§‚å¯Ÿåˆ°çš„å€¼ï¼›</li><li>ä½¿ç”¨&nbsp;<code>@Outcome</code>&nbsp;å®šä¹‰æœŸæœ›ç»“æœã€‚</li></ol><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@JCStressTest</span><span class="token annotation punctuation">@Outcome</span><span class="token punctuation">(</span>id <span class="token operator">=</span> <span class="token string">"0, 1"</span><span class="token punctuation">,</span> expect <span class="token operator">=</span> <span class="token class-name">Expect</span><span class="token punctuation">.</span><span class="token constant">ACCEPTABLE</span><span class="token punctuation">,</span> desc <span class="token operator">=</span> <span class="token string">"çº¿ç¨‹ 2 çœ‹åˆ°äº†å†™å…¥"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Outcome</span><span class="token punctuation">(</span>id <span class="token operator">=</span> <span class="token string">"0, 0"</span><span class="token punctuation">,</span> expect <span class="token operator">=</span> <span class="token class-name">Expect</span><span class="token punctuation">.</span><span class="token constant">ACCEPTABLE</span><span class="token punctuation">,</span> desc <span class="token operator">=</span> <span class="token string">"çº¿ç¨‹ 2 æ²¡çœ‹åˆ°å†™å…¥"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@State</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DirectReportingTest</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> x<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Actor</span>    <span class="token keyword">void</span> <span class="token function">actor1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Actor</span>    <span class="token keyword">void</span> <span class="token function">actor2</span><span class="token punctuation">(</span><span class="token class-name">II_Result</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>        r<span class="token punctuation">.</span>r1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        r<span class="token punctuation">.</span>r2 <span class="token operator">=</span> x<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å¯ç”¨&nbsp;<code>@Description</code>&nbsp;æ·»åŠ ç®€è¦è¯´æ˜ï¼Œéœ€è¦é¿å…è¿‡é•¿å­—ç¬¦ä¸²ï¼Œå¦åˆ™å¯èƒ½ä¼šè§¦å‘&nbsp;<code>StringIndexOutOfBoundsException</code>ã€‚</p></blockquote><h3 id="é£æ ¼é€‰æ‹©"><a class="markdownIt-Anchor" href="#é£æ ¼é€‰æ‹©"></a> é£æ ¼é€‰æ‹©</h3><table><thead><tr><th>åœºæ™¯</th><th>æ¨èé£æ ¼</th></tr></thead><tbody><tr><td>éœ€è¦ç»Ÿä¸€è§‚å¯Ÿæœ€ç»ˆçŠ¶æ€</td><td>Arbiter é£æ ¼</td></tr><tr><td>Actor å¯å³æ—¶è®°å½•è§‚å¯Ÿç»“æœ</td><td>ç›´æ¥è®°å½•é£æ ¼</td></tr><tr><td>å…³æ³¨å¯è§æ€§æˆ–é‡æ’åºé—®é¢˜</td><td>ç›´æ¥è®°å½•é£æ ¼</td></tr></tbody></table><h2 id="çº¿ç¨‹å®‰å…¨æµ‹è¯•ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#çº¿ç¨‹å®‰å…¨æµ‹è¯•ç¤ºä¾‹"></a> çº¿ç¨‹å®‰å…¨æµ‹è¯•ç¤ºä¾‹</h2><p>ç¤ºä¾‹æµ‹è¯•è¯´æ˜ï¼š</p><ul><li>ä¸¤ä¸ª&nbsp;<code>@Actor</code>&nbsp;å¹¶å‘å¾€ç¼“å­˜ä¸­æ”¾å…¥ä¸¤ä¸ªä¸åŒ keyï¼ˆschema å’Œ tableï¼‰ï¼›</li><li><code>@Arbiter</code>&nbsp;éªŒè¯ç¼“å­˜ä¸­æ˜¯å¦å­˜åœ¨è¿™ä¸¤ä¸ªå®ä½“ï¼›</li><li>å®šä¹‰äº†ä¸‰ç§ç»“æœï¼š<ul><li><strong>2</strong>ï¼šä¸¤ä¸ªéƒ½å­˜åœ¨</li><li><strong>1</strong>ï¼šåªå­˜åœ¨ä¸€ä¸ª</li><li><strong>0</strong>ï¼šéƒ½ä¸å­˜åœ¨</li></ul></li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> xxx <span class="token punctuation">{</span>  <span class="token comment">// some entity to test.</span>    <span class="token annotation punctuation">@JCStressTest</span>  <span class="token annotation punctuation">@Outcome.Outcomes</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      <span class="token annotation punctuation">@Outcome</span><span class="token punctuation">(</span>id <span class="token operator">=</span> <span class="token string">"2"</span><span class="token punctuation">,</span> expect <span class="token operator">=</span> <span class="token class-name">Expect</span><span class="token punctuation">.</span><span class="token constant">ACCEPTABLE</span><span class="token punctuation">,</span> desc <span class="token operator">=</span> <span class="token string">"Both put() calls succeeded; both entries are visible in the cache."</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      <span class="token annotation punctuation">@Outcome</span><span class="token punctuation">(</span>id <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">,</span> expect <span class="token operator">=</span> <span class="token class-name">Expect</span><span class="token punctuation">.</span><span class="token constant">FORBIDDEN</span><span class="token punctuation">,</span> desc <span class="token operator">=</span> <span class="token string">"Only one entry is visible; potential visibility or atomicity issue."</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      <span class="token annotation punctuation">@Outcome</span><span class="token punctuation">(</span>id <span class="token operator">=</span> <span class="token string">"0"</span><span class="token punctuation">,</span> expect <span class="token operator">=</span> <span class="token class-name">Expect</span><span class="token punctuation">.</span><span class="token constant">FORBIDDEN</span><span class="token punctuation">,</span> desc <span class="token operator">=</span> <span class="token string">"Neither entry is visible; indicates a serious failure in write propagation or cache logic."</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token annotation punctuation">@Description</span><span class="token punctuation">(</span><span class="token string">"Concurrent put() on different keys. Both schema and table should be visible (result = 2). "</span> <span class="token operator">+</span> <span class="token string">"Lower results may indicate visibility or concurrency issues."</span><span class="token punctuation">)</span>  <span class="token annotation punctuation">@State</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">ConcurrentPutDifferentKeysTest</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">EntityCache</span> cache<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">ConcurrentPutDifferentKeysTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CaffeineEntityCache</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Actor</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">actor1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>schemaEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Actor</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">actor2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>tableEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Arbiter</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">arbiter</span><span class="token punctuation">(</span><span class="token class-name">I_Result</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>cache<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>schemaEntity<span class="token punctuation">.</span><span class="token function">nameIdentifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> schemaEntity<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> count<span class="token operator">++</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>cache<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>tableEntity<span class="token punctuation">.</span><span class="token function">nameIdentifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tableEntity<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> count<span class="token operator">++</span><span class="token punctuation">;</span>      r<span class="token punctuation">.</span>r1 <span class="token operator">=</span> count<span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>    <span class="token comment">// ... other test classes</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="jcstress-æµ‹è¯•ç”Ÿå‘½å‘¨æœŸ"><a class="markdownIt-Anchor" href="#jcstress-æµ‹è¯•ç”Ÿå‘½å‘¨æœŸ"></a> JCStress æµ‹è¯•ç”Ÿå‘½å‘¨æœŸ</h2><p>JCStress éµå¾ªä»¥ä¸‹æµ‹è¯•æ‰§è¡Œæµç¨‹ï¼š</p><ol><li><strong>çŠ¶æ€åˆå§‹åŒ–</strong>ï¼šæ¯æ¬¡æµ‹è¯•è¿­ä»£å‰é‡æ–°æ„é€ &nbsp;<code>@State</code>&nbsp;å¯¹è±¡ï¼Œç¡®ä¿éš”ç¦»æ€§ï¼›</li><li><strong>å¹¶å‘æ‰§è¡Œ</strong>ï¼šå¤šä¸ª&nbsp;<code>@Actor</code>&nbsp;æ–¹æ³•å¹¶å‘è¿è¡Œï¼Œæ¨¡æ‹ŸçœŸå®ç«äº‰ï¼›</li><li><strong>å†…å­˜å±éšœæ’å…¥</strong>ï¼šç¡®ä¿æ‰§è¡Œé¡ºåºåå†æ‰§è¡Œ&nbsp;<code>@Arbiter</code>ï¼›</li><li><strong>ç»“æœåˆ¤å®š</strong>ï¼šå°†æ¯æ¬¡è¿­ä»£çš„ç»“æœä¸å®šä¹‰çš„&nbsp;<code>@Outcome</code>&nbsp;æ¯”è¾ƒå½’ç±»ï¼›</li><li><strong>é«˜é¢‘è¿­ä»£</strong>ï¼šæ¯ä¸ªæµ‹è¯•é‡å¤è¿è¡Œç™¾ä¸‡æ¬¡ä»¥ä¸Šï¼Œä»¥æš´éœ²æä½æ¦‚ç‡çš„é”™è¯¯ã€‚</li></ol><h3 id="å¯ç”¨æ‰§è¡Œæ¨¡å¼"><a class="markdownIt-Anchor" href="#å¯ç”¨æ‰§è¡Œæ¨¡å¼"></a> å¯ç”¨æ‰§è¡Œæ¨¡å¼</h3><table><thead><tr><th>æ¨¡å¼</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>sanity</code></td><td>å¿«é€Ÿæ£€æŸ¥æµ‹è¯•æ˜¯å¦é…ç½®æ­£ç¡®ï¼ˆå‡ ç§’ï¼‰</td></tr><tr><td><code>quick</code></td><td>å¿«é€Ÿåé¦ˆï¼Œé€‚åˆå¼€å‘ä¸­ä½¿ç”¨ï¼ˆå‡ åç§’ï¼‰</td></tr><tr><td><code>default</code></td><td>å¹³è¡¡æ¨¡å¼ï¼Œæ¨èå¸¸è§„ä½¿ç”¨ï¼ˆå‡ åˆ†é’Ÿï¼‰</td></tr><tr><td><code>tough</code></td><td>å¼ºåŠ›æ¨¡å¼ï¼Œé€‚åˆ CI æµ‹è¯•æˆ–å‘å¸ƒå‰éªŒè¯ï¼ˆè¾ƒé•¿æ—¶é—´ï¼‰</td></tr></tbody></table><h2 id="é—®é¢˜ç±»å‹"><a class="markdownIt-Anchor" href="#é—®é¢˜ç±»å‹"></a> é—®é¢˜ç±»å‹</h2><p>JCStress ä¸»è¦å¸®åŠ©æ£€æµ‹å¦‚ä¸‹å¹¶å‘é—®é¢˜ï¼š</p><ul><li><strong>ç«æ€æ¡ä»¶ï¼ˆRace Conditionï¼‰</strong>ï¼šå¤šä¸ªçº¿ç¨‹æ— åŒæ­¥è®¿é—®å…±äº«å˜é‡ï¼›</li><li><strong>å¯è§æ€§é—®é¢˜</strong>ï¼šçº¿ç¨‹ä¿®æ”¹å¯¹å…¶ä»–çº¿ç¨‹ä¸å¯è§ï¼›</li><li><strong>åŸå­æ€§ç ´å</strong>ï¼šéåŸå­æ“ä½œè¢«éƒ¨åˆ†æ‰§è¡Œï¼›</li><li><strong>æ‰§è¡Œé¡ºåºé”™è¯¯</strong>ï¼šç”±äº CPU/JVM é‡æ’åºå¯¼è‡´çš„è¡Œä¸ºå¼‚å¸¸ã€‚</li></ul><h2 id="jcstress-ç¼–å†™å»ºè®®"><a class="markdownIt-Anchor" href="#jcstress-ç¼–å†™å»ºè®®"></a> Jcstress ç¼–å†™å»ºè®®</h2><ul><li>æ¯ä¸ªæµ‹è¯•èšç„¦ä¸€ä¸ªå¹¶å‘é—®é¢˜ï¼›</li><li>ä½¿ç”¨æ¸…æ™°çš„ç±»åä¸æ³¨é‡Šè§£é‡Šæ¯ä¸ªç»“æœï¼›</li><li>é¿å…ä½¿ç”¨éç¡®å®šæ€§è¡Œä¸ºï¼ˆå¦‚&nbsp;<code>Thread.sleep()</code>ï¼‰ï¼›</li><li>å¤šæ¬¡è¿è¡Œæµ‹è¯•ä»¥éªŒè¯ç¨³å®šæ€§ï¼›</li><li>å¯¹&nbsp;<strong>FORBIDDEN</strong>&nbsp;æˆ–&nbsp;<strong>INTERESTING</strong>&nbsp;çš„ç»“æœé‡ç‚¹å…³æ³¨å’Œä¿®å¤ã€‚</li></ul><h2 id="å‚è€ƒ"><a class="markdownIt-Anchor" href="#å‚è€ƒ"></a> å‚è€ƒ</h2><ul><li><a href="https://wiki.openjdk.java.net/display/CodeTools/jcstress">JCStress Official Documentation</a></li><li><a href="https://docs.oracle.com/javase/specs/jls/se8/html/jls-17.html#jls-17.4">Java Memory Model Specification</a></li><li><a href="http://gee.cs.oswego.edu/dl/jmm/cookbook.html">Doug Leaâ€™s JSR-133 Cookbook</a></li><li><a href="https://github.com/reyerizo/jcstress-gradle-plugin">jcstress-gradle-plugin</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Gravitino </tag>
            
            <tag> JCStress </tag>
            
            <tag> gradle-plugin </tag>
            
            <tag> concurrency-testing </tag>
            
            <tag> thread-safety </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gravitino Cache System</title>
      <link href="/2025/07/01/gravitino/2025-07-01-gravitino-cache-system/"/>
      <url>/2025/07/01/gravitino/2025-07-01-gravitino-cache-system/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a class="markdownIt-Anchor" href="#èƒŒæ™¯"></a> èƒŒæ™¯</h2><ol><li>åŠ è½½æˆ–åˆ›å»ºè¡¨ã€æ¨¡å‹ã€Fileset æ—¶ï¼Œé¢‘ç¹è®¿é—®æ•°æ®åº“ä»¥è·å–&nbsp;<code>metalake_id</code>ã€<code>catalog_id</code>ã€<code>schema_id</code>&nbsp;ç­‰å…ƒæ•°æ®æ ‡è¯†ç¬¦ï¼Œå¸¦æ¥æ˜¾è‘—çš„æ€§èƒ½å¼€é”€ï¼›</li><li>casbin åœ¨é‰´æƒæ—¶éœ€è¦æ ¹æ® ID è¿›è¡Œæƒé™åˆ¤æ–­ï¼Œè¿™éœ€è¦é¢‘ç¹è®¿é—®æ•°æ®åº“è·å– Entity çš„ IDï¼›</li><li>Role ä¿¡æ¯åŠ è½½æ¶‰åŠå¤§é‡å…ƒæ•°æ®å¯¹è±¡ï¼Œä¹Ÿéœ€é¢‘ç¹æŸ¥è¯¢æ•°æ®åº“ï¼Œè¿›ä¸€æ­¥åŠ å‰§æ€§èƒ½ç“¶é¢ˆï¼›</li><li>å¼•å…¥ç¼“å­˜æœºåˆ¶å¯æ˜¾è‘—é™ä½æ•°æ®åº“è®¿é—®é¢‘ç‡ï¼Œä»è€Œæå‡æ•´ä½“è®¿é—®æ€§èƒ½ã€‚</li></ol><h2 id="ç›®æ ‡"><a class="markdownIt-Anchor" href="#ç›®æ ‡"></a> ç›®æ ‡</h2><ol><li>æ”¯æŒæ ¹æ® <code>NameIdentifier</code> å¿«é€ŸæŸ¥æ‰¾ <code>Entity</code>ï¼›</li><li>æ”¯æŒå¤šç§å®ç°ï¼ŒåŒ…æ‹¬æœ¬åœ°å†…å­˜ç¼“å­˜ï¼ˆå¦‚ Caffeineï¼‰ä¸åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆå¦‚ Redisï¼‰ï¼›</li><li>æ’ä»¶åŒ–è®¾è®¡ï¼Œä¾¿äºæ‰©å±•ï¼›</li><li>åŒæ—¶æ”¯æŒ <code>EntityStore</code>ã€ <code>SupportsRelationOperations</code> å’Œ <code>SupportsTagOperations</code> å…¨éƒ¨æ“ä½œï¼›</li><li>ä¸ä¸åº•å±‚ Storage äº¤äº’ï¼›</li></ol><h2 id="æ€»ä½“è®¾è®¡"><a class="markdownIt-Anchor" href="#æ€»ä½“è®¾è®¡"></a> æ€»ä½“è®¾è®¡</h2><p><code>EntityCache</code> çš„å®ç°åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š</p><ol><li>ä¸º <code>EntityStore</code> å’Œ <code>SupportsRelationOperations</code> çš„å…¨éƒ¨æ“ä½œæ·»åŠ ç¼“å­˜ï¼›</li><li>åˆå¹¶ <code>SupportsTagOperations</code> åˆ° <code>SupportsRelationOperations</code>ï¼›</li></ol><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/20250530153818.png" alt="Gravitino ä»£ç å±‚æ¬¡"></p><p><code>EntityCache</code>&nbsp;æ˜¯ Store å±‚çš„ç¼“å­˜æ¨¡å—ï¼Œé‡‡ç”¨æ’ä»¶åŒ–è®¾è®¡ï¼Œå¯ä»¥æ”¯æŒæœ¬åœ°å†…å­˜ç¼“å­˜ï¼ˆå¦‚ Caffeineï¼‰ï¼Œä¹Ÿæ”¯æŒåˆ†å¸ƒå¼ç¼“å­˜ï¼ˆå¦‚ Redisï¼‰ï¼Œä¸»è¦ç”¨äºåŠ é€Ÿå…ƒæ•°æ®çš„è¯»å†™æ“ä½œã€‚</p><p>è®¾è®¡åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p><ul><li><strong>Cache Data</strong>ï¼šç”¨äºå­˜å‚¨&nbsp;<code>Entity</code>&nbsp;æœ¬èº«ï¼›</li><li><strong>Cache Index</strong>ï¼šç”¨äºè¾…åŠ©å‰ç¼€æŸ¥è¯¢ã€‚</li></ul><p>ç¼“å­˜æ•°æ®ï¼ˆCache Dataï¼‰</p><ul><li>æ”¯æŒ <code>NameIdentifier</code> + <code>EntityType</code> â†’ <code>Entity</code> çš„æ˜ å°„ï¼›</li><li>æ”¯æŒ <code>NameIdentifier</code> + <code>EntityType</code> + <code>RelationType</code> â†’ <code>Entity</code> åˆ—è¡¨çš„æ˜ å°„</li><li>ç¼“å­˜é¡¹æ”¯æŒå¯é…ç½®çš„è¿‡æœŸç­–ç•¥ï¼Œä¾¿äºçµæ´»æ§åˆ¶ç¼“å­˜ç”Ÿå‘½å‘¨æœŸã€‚</li></ul><p>ç¼“å­˜ç´¢å¼•ï¼ˆCache Indexï¼‰</p><ul><li>æ”¯æŒåŸºäºåç§°å‰ç¼€æ£€ç´¢å¯¹åº”çš„ Entity å®ä½“é›†åˆï¼›</li><li>æ”¯æŒå¤šç§ç¼“å­˜è¿‡æœŸç­–ç•¥ï¼Œå½“ CacheData ä¸­çš„ç¼“å­˜é¡¹å› ä¸ºç­–ç•¥è¿‡æœŸè¢«åˆ é™¤æ—¶ï¼Œé€šè¿‡ <code>remove listener</code> ä¿æŒ Cache Index åŒæ­¥åˆ é™¤ã€‚</li></ul><h2 id="æ¥å£å®šä¹‰ä¸å®ç°"><a class="markdownIt-Anchor" href="#æ¥å£å®šä¹‰ä¸å®ç°"></a> æ¥å£å®šä¹‰ä¸å®ç°</h2><h3 id="entitycache"><a class="markdownIt-Anchor" href="#entitycache"></a> EntityCache</h3><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/20250619171744.png" alt="Entity Cache æ¥å£"></p><p><code>EntityCache</code> çš„æ¥å£ç±»å›¾è®¾è®¡å¦‚ä¸Šï¼ŒEntityCache æ¥å£ç»§æ‰¿è‡ª <code>SupportsEntityStoreCache</code> å’Œ <code>SupportsRelationEntityCache</code> æ¥å£ï¼Œè¿™ä¹ˆè®¾è®¡çš„åŸå› æ˜¯ä¸ºäº†åŒºåˆ†é€‚é…çš„åº•å±‚æ¥å£ã€‚</p><p><code>SupportsEntityStoreCache</code> æ¥å£ç”¨äºåŒ…è£… <code>EntityStore</code> æ¥å£ï¼Œè´Ÿè´£ Entity çš„åº•å±‚æ“ä½œï¼Œå…¶å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">SupportsEntityStoreCache</span> <span class="token punctuation">{</span>  <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span> <span class="token keyword">extends</span> <span class="token class-name">Entity</span> <span class="token operator">&amp;</span> <span class="token class-name">HasIdentifier</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token function">getIfPresent</span><span class="token punctuation">(</span>      <span class="token class-name">NameIdentifier</span> ident<span class="token punctuation">,</span> <span class="token class-name">Entity<span class="token punctuation">.</span>EntityType</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">boolean</span> <span class="token function">invalidate</span><span class="token punctuation">(</span><span class="token class-name">NameIdentifier</span> ident<span class="token punctuation">,</span> <span class="token class-name">Entity<span class="token punctuation">.</span>EntityType</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">boolean</span> <span class="token function">contains</span><span class="token punctuation">(</span><span class="token class-name">NameIdentifier</span> ident<span class="token punctuation">,</span> <span class="token class-name">Entity<span class="token punctuation">.</span>EntityType</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span> <span class="token keyword">extends</span> <span class="token class-name">Entity</span> <span class="token operator">&amp;</span> <span class="token class-name">HasIdentifier</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">E</span> entity<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span> <span class="token keyword">extends</span> <span class="token class-name">Entity</span> <span class="token operator">&amp;</span> <span class="token class-name">HasIdentifier</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">invalidateOnKeyChange</span><span class="token punctuation">(</span><span class="token class-name">E</span> entity<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>getIfPresent</code>ï¼šç¼“å­˜ä¸­è¯»å–ï¼ˆä¸è§¦å‘åŠ è½½ï¼‰ï¼›</li><li><code>invalidate</code>ï¼šæ˜¾å¼æ¸…ç†ç¼“å­˜é¡¹ï¼›</li><li><code>invalidateOnKeyChange</code>ï¼šç”¨äºå¤„ç†å…³è”å®ä½“å˜æ›´å¯¼è‡´çš„è”åŠ¨æ¸…ç†ã€‚</li><li><code>contains</code>ï¼šæ£€æŸ¥ç‰¹å®šé”®æ˜¯å¦å‘½ä¸­ç¼“å­˜ï¼›</li><li><code>put</code>ï¼šå°†ä¸€ä¸ª Entity æ”¾å…¥ç¼“å­˜ï¼›</li></ul><p><code>SupportsRelationEntityCache</code> æ¥å£ç”¨äºé€‚é… <code>SupportsRelationOperations</code> æ¥å£çš„æ“ä½œï¼Œå…¶å…·ä½“å®šä¹‰å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">SupportsRelationEntityCache</span> <span class="token punctuation">{</span>  <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span> <span class="token keyword">extends</span> <span class="token class-name">Entity</span> <span class="token operator">&amp;</span> <span class="token class-name">HasIdentifier</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getIfPresent</span><span class="token punctuation">(</span>      <span class="token class-name">SupportsRelationOperations<span class="token punctuation">.</span>Type</span> relType<span class="token punctuation">,</span>      <span class="token class-name">NameIdentifier</span> nameIdentifier<span class="token punctuation">,</span>      <span class="token class-name">Entity<span class="token punctuation">.</span>EntityType</span> identType<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">boolean</span> <span class="token function">invalidate</span><span class="token punctuation">(</span>      <span class="token class-name">NameIdentifier</span> ident<span class="token punctuation">,</span> <span class="token class-name">Entity<span class="token punctuation">.</span>EntityType</span> type<span class="token punctuation">,</span> <span class="token class-name">SupportsRelationOperations<span class="token punctuation">.</span>Type</span> relType<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">boolean</span> <span class="token function">contains</span><span class="token punctuation">(</span>      <span class="token class-name">NameIdentifier</span> ident<span class="token punctuation">,</span> <span class="token class-name">Entity<span class="token punctuation">.</span>EntityType</span> type<span class="token punctuation">,</span> <span class="token class-name">SupportsRelationOperations<span class="token punctuation">.</span>Type</span> relType<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span> <span class="token keyword">extends</span> <span class="token class-name">Entity</span> <span class="token operator">&amp;</span> <span class="token class-name">HasIdentifier</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span>      <span class="token class-name">NameIdentifier</span> ident<span class="token punctuation">,</span>      <span class="token class-name">Entity<span class="token punctuation">.</span>EntityType</span> type<span class="token punctuation">,</span>      <span class="token class-name">SupportsRelationOperations<span class="token punctuation">.</span>Type</span> relType<span class="token punctuation">,</span>      <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> entities<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯¥æ¥å£å®šä¹‰çš„æ–¹æ³•åŒ <code>SupportsEntityStoreCache</code> æ¥å£ï¼Œå”¯ä¸€çš„åŒºåˆ«åœ¨äºå‚æ•°åˆ—è¡¨å¤šä¸€ä¸ª <code>SupportsRelationOperations.Type</code>ã€‚</p><p>EntityCache çš„å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">EntityCache</span> <span class="token keyword">extends</span> <span class="token class-name">SupportsEntityStoreCache</span><span class="token punctuation">,</span> <span class="token class-name">SupportsRelationEntityCache</span> <span class="token punctuation">{</span>  <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">long</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">withCacheLock</span><span class="token punctuation">(</span><span class="token class-name">ThrowingRunnable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> action<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">E</span><span class="token punctuation">;</span>  <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">E</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">withCacheLock</span><span class="token punctuation">(</span><span class="token class-name">ThrowingSupplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> action<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">E</span><span class="token punctuation">;</span>  <span class="token annotation punctuation">@FunctionalInterface</span>  <span class="token keyword">interface</span> <span class="token class-name">ThrowingSupplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">E</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>    <span class="token class-name">T</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">E</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token annotation punctuation">@FunctionalInterface</span>  <span class="token keyword">interface</span> <span class="token class-name">ThrowingRunnable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">E</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>clear</code>ï¼šæ¸…ç©ºç¼“å­˜ä¸­çš„æ‰€æœ‰æ¡ç›®ï¼›</li><li><code>size</code>ï¼šè¿”å›å½“å‰ç¼“å­˜ä¸­çš„æ¡ç›®æ•°é‡ï¼›</li><li><code>withCacheLock</code>ï¼šåœ¨åŠ é”çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œç”¨æˆ·è‡ªå®šä¹‰é€»è¾‘ï¼Œç¡®ä¿æ“ä½œçš„çº¿ç¨‹å®‰å…¨ï¼›</li></ul><p>åœ¨&nbsp;<code>EntityCache</code>&nbsp;ä¸­å¼•å…¥&nbsp;<code>withCacheLock</code>&nbsp;çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æä¾›ä¸€ä¸ªåŠ é”çš„æ“ä½œç¯å¢ƒï¼Œä»¥ä¿è¯<strong>ç¼“å­˜æ•´ä½“æ“ä½œçš„åŸå­æ€§å’Œä¸€è‡´æ€§</strong>ã€‚</p><p>ç¼“å­˜å†…éƒ¨åŒ…å«ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼š</p><ul><li><code>CacheIndex</code>ï¼šç”¨äºå‰ç¼€æˆ–å…³è”ç´¢å¼•æ£€ç´¢ï¼›</li><li><code>CacheData</code>ï¼šç”¨äºå®é™…çš„æ•°æ®å­˜å‚¨ã€‚</li></ul><p>Cache ä½œä¸ºä¸€ä¸ªæ•´ä½“éœ€è¦é€šè¿‡é”ä¿è¯å†…éƒ¨ CacheIndex å’Œ CacheData ä¸¤ä¸ªéƒ¨åˆ†çš„ä¸€è‡´æ€§ã€‚åœ¨æ‰§è¡Œæ¶‰åŠå¤šä¸ªæ­¥éª¤çš„å¤åˆæ“ä½œï¼ˆå¦‚æ›´æ–°ã€æ¸…ç†ã€åŠ è½½ï¼‰æ—¶ï¼Œéœ€è¦ä¿è¯è¿™ä¸¤ä¸ªéƒ¨åˆ†çš„æ•°æ®åœ¨ä»»æ„æ—¶åˆ»ä¿æŒä¸€è‡´ï¼Œå¦åˆ™å¯èƒ½å‡ºç°ç¼“å­˜è„è¯»æˆ–çŠ¶æ€ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p><p>å°¤å…¶åœ¨&nbsp;<strong>Store å±‚</strong>&nbsp;çš„å…¸å‹æ“ä½œåœºæ™¯ä¸­ï¼Œå¦‚&nbsp;<code>update</code>&nbsp;æ“ä½œï¼Œé€šå¸¸åŒ…æ‹¬ä»¥ä¸‹æµç¨‹ï¼š</p><ol><li><strong>æ¸…ç†ç¼“å­˜</strong>ï¼ˆé˜²æ­¢æ—§æ•°æ®è¢«è®¿é—®ï¼‰ï¼›</li><li><strong>æ›´æ–°åº•å±‚å­˜å‚¨ç³»ç»Ÿ</strong>ï¼ˆå¦‚æ•°æ®åº“æˆ– Catalogï¼‰ï¼›</li><li><strong>å°†æ›´æ–°åçš„å®ä½“é‡æ–°æ”¾å…¥ç¼“å­˜</strong>ã€‚</li></ol><p>ä¸ºäº†ä¿è¯è¿™ä¸‰ä¸ªæ­¥éª¤ä½œä¸ºä¸€ä¸ªæ•´ä½“æ‰§è¡Œæ—¶ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹æ‰“æ–­ï¼Œå¿…é¡»åœ¨æ•´ä¸ªæµç¨‹ä¸ŠåŠ é”ï¼Œè€Œä¸èƒ½ä»…ä¾èµ–&nbsp;<code>put</code>ã€<code>invalidate</code>&nbsp;ç­‰å•ä¸ªæ–¹æ³•å†…éƒ¨çš„é”æ§åˆ¶ã€‚</p><p>å› æ­¤ï¼Œ<code>withCacheLock</code>&nbsp;æä¾›äº†ä¸€ç§æ˜¾å¼çš„åŠ é”æœºåˆ¶ï¼Œä½¿å¾—è°ƒç”¨æ–¹å¯ä»¥åœ¨<strong>ä¸€ä¸ªåŠ é”çš„ä¸Šä¸‹æ–‡ä¸­è‡ªå®šä¹‰ä¸€ç»„æ“ä½œ</strong>ï¼Œç¡®ä¿å®ƒä»¬å…·å¤‡åŸå­æ€§å’Œçº¿ç¨‹å®‰å…¨æ€§ã€‚</p><p><code>ThrowingSupplier</code> æ¥å£æ˜¯å¯¹æ ‡å‡† Java&nbsp;<code>Supplier&lt;T&gt;</code>&nbsp;çš„æ‰©å±•ï¼Œæ”¯æŒåœ¨&nbsp;<code>get()</code>&nbsp;æ–¹æ³•ä¸­æŠ›å‡ºå—æ£€å¼‚å¸¸ï¼ˆ<code>checked exception</code>ï¼‰ã€‚å…¶è®¾è®¡ç›®çš„æ˜¯ç”¨äºåœ¨å¸¦è¿”å›å€¼çš„å»¶è¿Ÿæ‰§è¡Œé€»è¾‘ä¸­ï¼Œå…è®¸è°ƒç”¨æ–¹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¤„ç†å’Œä¼ æ’­å¼‚å¸¸ã€‚è¿™ä½¿å¾—åœ¨ Lambda è¡¨è¾¾å¼ä¸­å¤„ç†æ•°æ®åº“æˆ– IO æ“ä½œç­‰å¼‚å¸¸æºæ—¶ï¼Œæ›´çµæ´»ï¼ŒåŒæ—¶æå‡äº†&nbsp;<code>withCacheLock</code>&nbsp;æ–¹æ³•çš„é€šç”¨æ€§å’Œè¡¨è¾¾èƒ½åŠ›ã€‚</p><p><code>ThrowingRunnable</code> æ¥å£æ˜¯å¯¹æ ‡å‡† Java&nbsp;<code>Runnable</code>&nbsp;çš„æ‰©å±•ï¼Œæ”¯æŒåœ¨&nbsp;<code>run()</code>&nbsp;æ–¹æ³•ä¸­æŠ›å‡ºå—æ£€å¼‚å¸¸ã€‚å®ƒä¸»è¦ç”¨äºæ‰§è¡Œæ— è¿”å›å€¼ä½†å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„æ“ä½œé€»è¾‘ã€‚å…¶è®¾è®¡é€»è¾‘åŒ <code>ThrowingSupplier</code>ã€‚</p><p>è¿™ä¸¤ä¸ªæ¥å£ä½œä¸º&nbsp;<code>EntityCache</code>&nbsp;çš„åŠ é”æ‰§è¡Œæ¥å£å‚æ•°ï¼Œæä¾›äº†å¯¹ç¼“å­˜æ“ä½œåŸå­æ€§ä¿æŠ¤çš„åŒæ—¶ï¼Œä¹Ÿå…è®¸ä¸šåŠ¡é€»è¾‘è‡ªç”±å¤„ç†å—æ£€å¼‚å¸¸ã€‚</p><h3 id="é”®å€¼è®¾è®¡"><a class="markdownIt-Anchor" href="#é”®å€¼è®¾è®¡"></a> é”®å€¼è®¾è®¡</h3><h4 id="entitycachekey"><a class="markdownIt-Anchor" href="#entitycachekey"></a> EntityCacheKey</h4><p><code>EntityCacheKey</code>&nbsp;æ˜¯ç¼“å­˜ä¸­ç”¨äºå”¯ä¸€æ ‡è¯†å®ä½“æˆ–å®ä½“å…³ç³»çš„é”®å¯¹è±¡ï¼Œå…¶è®¾è®¡æ¥æºäºå¯¹&nbsp;<code>EntityCache</code>&nbsp;æ¥å£ä¸­ä¸¤ç±»æ“ä½œçš„æŠ½è±¡ï¼š<br>å¯¹äº&nbsp;<code>SupportsEntityStoreCache</code>&nbsp;æ¥å£ï¼Œå¯ä»¥å¦‚ä¸‹æ–¹å¼æ˜ å°„å”¯ä¸€çš„ Entity å¯¹è±¡ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">NameIdentifier</span> <span class="token operator">+</span> <span class="token class-name">Entity<span class="token punctuation">.</span>EntityType</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯¹äº&nbsp;<code>SupportsRelationEntityCache</code>&nbsp;æ¥å£ï¼Œå¯ä»¥å¦‚ä¸‹æ–¹å¼æ˜ å°„å”¯ä¸€çš„ä¸€ç»„ Entity å¯¹è±¡ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">NameIdentifier</span> <span class="token operator">+</span> <span class="token class-name">Entity<span class="token punctuation">.</span>EntityType</span> <span class="token operator">+</span> <span class="token class-name">SupportsRelationOperations<span class="token punctuation">.</span>Type</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å› æ­¤ï¼Œ<code>EntityCacheKey</code>&nbsp;åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªæ ¸å¿ƒå­—æ®µï¼š</p><ul><li><code>NameIdentifier identifier</code>ï¼šå®ä½“çš„å‘½åæ ‡è¯†ï¼›</li><li><code>Entity.EntityType type</code>ï¼šå®ä½“çš„ç±»å‹ï¼›</li><li><code>SupportsRelationOperations.Type relationType</code>ï¼šå…³ç³»ç±»å‹ï¼ˆå¯é€‰ï¼Œç”¨äºå…³ç³»ç¼“å­˜ï¼‰ã€‚</li></ul><p><code>EntityCacheKey</code>&nbsp;çš„&nbsp;<code>toString()</code>&nbsp;æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token class-name">String</span> stringExpr <span class="token operator">=</span> identifier<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> type<span class="token punctuation">.</span><span class="token function">getShortName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>relationType <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      stringExpr <span class="token operator">+=</span> <span class="token string">":"</span> <span class="token operator">+</span> relationType<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>      <span class="token keyword">return</span> stringExpr<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°é‡‡ç”¨&nbsp;<code>identifier</code>&nbsp;ä½œä¸ºå­—ç¬¦ä¸²å‰ç¼€ï¼Œå¹¶è¿½åŠ ç±»å‹ä¸å…³ç³»ä¿¡æ¯ï¼Œä»è€Œä¿è¯é”®çš„å”¯ä¸€æ€§å’Œå¯è¯»æ€§ã€‚åŒæ—¶å…·å¤‡è‰¯å¥½çš„å‰ç¼€ç»“æ„ï¼Œæœ‰åˆ©äºåŸºäºå‰ç¼€çš„ç´¢å¼•ä¸æ£€ç´¢æ“ä½œï¼ˆå¦‚åœ¨&nbsp;<code>ConcurrentRadixTree</code>&nbsp;ä¸­è¿›è¡Œå¿«é€ŸèŒƒå›´æŸ¥è¯¢ï¼‰ã€‚</p><h4 id="entitycachevalue"><a class="markdownIt-Anchor" href="#entitycachevalue"></a> EntityCacheValue</h4><p>æ ¹æ®ä¸Šè¿°è®¾è®¡ï¼Œç¼“å­˜ä¸­çš„ Value å¯ä»¥è¢«ç»Ÿä¸€æŠ½è±¡ä¸ºä¸€ç»„&nbsp;<code>Entity</code>&nbsp;å®ä¾‹ï¼ˆ<code>List&lt;Entity&gt;</code>ï¼‰ï¼Œä¸”æ¯ç»„è‡³å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ ã€‚æ— è®ºæ˜¯å•ä¸ªå®ä½“ç¼“å­˜ï¼ˆå¦‚ Catalogã€Tableï¼‰ï¼Œè¿˜æ˜¯å…³ç³»å‹ç¼“å­˜ï¼ˆå¦‚ Role â†’ Users çš„æ˜ å°„ï¼‰ï¼Œéƒ½å¯ç»Ÿä¸€è¡¨ç¤ºä¸ºä¸€ç»„ç›¸å…³è”çš„&nbsp;<code>Entity</code>&nbsp;å¯¹è±¡ã€‚è¿™ç§æŠ½è±¡æ–¹å¼ç®€åŒ–äº†ç¼“å­˜ç»“æ„çš„å¤„ç†ï¼Œä¾¿äºåœ¨å†…éƒ¨ç»Ÿä¸€ç®¡ç†ã€æ¸…ç†å’ŒåŠ è½½ç¼“å­˜é¡¹ã€‚</p><h3 id="cache-å®ç°"><a class="markdownIt-Anchor" href="#cache-å®ç°"></a> Cache å®ç°</h3><h4 id="baseentitycache"><a class="markdownIt-Anchor" href="#baseentitycache"></a> BaseEntityCache</h4><p><code>BaseEntityCache</code>&nbsp;æ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»ï¼Œç”¨äºå®ç°&nbsp;<code>EntityCache</code>&nbsp;æ¥å£çš„é€šç”¨é€»è¾‘ã€‚å®ƒä¸»è¦è´Ÿè´£ä¸€äº›ç¼“å­˜é€šç”¨é€»è¾‘çš„å°è£…å’Œå·¥å…·æ–¹æ³•ï¼Œå¹¶å°†æ ¸å¿ƒçš„ç¼“å­˜é©±é€å®ç°ï¼ˆå¦‚&nbsp;<code>invalidateExpiredItem</code>ï¼‰ç•™ç»™å­ç±»å®Œæˆã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">BaseEntityCache</span> <span class="token keyword">implements</span> <span class="token class-name">EntityCache</span> <span class="token punctuation">{</span> <span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">Config</span> cacheConfig<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ ¸å¿ƒå­—æ®µæ˜¯ <code>cacheConfig</code> ä¿å­˜ç¼“å­˜çš„é…ç½®å‚æ•°ï¼Œå¹¶é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥ï¼Œç¡®ä¿ä¸ä¼šä¸º nullï¼ˆä½¿ç”¨&nbsp;<code>Preconditions</code>&nbsp;æ ¡éªŒï¼‰ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œ<code>BaseEntityCache</code> è¿˜æä¾›äº†å¤šä¸ªé™æ€å·¥å…·æ–¹æ³•ä¾›å­ç±»å¤ç”¨</p><ul><li><code>getIdentFromEntity (Entity entity)</code>ï¼šå®‰å…¨åœ°ä» Entity ç±»å‹è·å–å…¶ NameIdentifierï¼›</li><li><code>validateEntityHasIdentifier (Entity entity)</code>ï¼šæ ¡éªŒ&nbsp;<code>Entity</code>&nbsp;æ˜¯å¦å®ç°äº†&nbsp;<code>HasIdentifier</code>&nbsp;æ¥å£ï¼›</li><li><code>convertEntities (List&lt;Entity&gt; entities)</code>ï¼šå°†åŸå§‹&nbsp;<code>Entity</code>&nbsp;åˆ—è¡¨å®‰å…¨è½¬æ¢ä¸ºæŒ‡å®šæ³›å‹ç±»å‹çš„å®ä½“åˆ—è¡¨ï¼›</li><li><code>convertEntity (Entity entity)</code>ï¼šä¸ä¸Šé¢æ–¹æ³•ç±»ä¼¼ï¼Œé’ˆå¯¹å•ä¸ªå®ä½“è¿›è¡Œæ³›å‹è½¬æ¢ã€‚</li></ul><p>æ­¤å¤–ï¼Œ<code>BaseEntityCache</code> è¿˜æä¾›äº† <code>invalidateExpiredItem (EntityCacheKey key)</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç”¨äºå¼‚æ­¥é©±é€æˆ–è¿‡æœŸæ¸…ç†é€»è¾‘ã€‚</p><h4 id="caffeineentitycache"><a class="markdownIt-Anchor" href="#caffeineentitycache"></a> CaffeineEntityCache</h4><p>CaffeineEntityCache å®ç°ç±»é‡‡ç”¨ Caffeine å®ç°ã€‚ä¸‹é¢æ˜¯ CacheData å’Œ CacheIndex çš„ç¤ºæ„å›¾ï¼š</p><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/yuque_diagram20250619-1.png" alt="CaffeineEntityCache"></p><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/yuque_diagram20250619-2.png" alt="CaffeineEntityCache Key"></p><ul><li>CacheDataï¼š<code>EntityCacheKey</code> â†’ <code>List&lt;Entity&gt;</code></li><li>CacheIndexï¼šPrefixTree&lt;String, EntityKey&gt;<br>ç´¢å¼•ç»“æ„é€‰å‹</li></ul><blockquote><p>GitHub:&nbsp;<a href="https://github.com/npgall/concurrent-trees">https://github.com/npgall/concurrent-trees</a></p></blockquote><p><code>ConcurrentRadixTree</code>ï¼ˆæ¥è‡ª concurrent-treesï¼‰</p><ul><li>çº¿ç¨‹å®‰å…¨ï¼Œæ”¯æŒå‰ç¼€æŸ¥è¯¢ã€æ¨¡ç³ŠåŒ¹é…ã€é«˜æ€§èƒ½è¯»å†™ã€‚</li><li>è¯»å–æ— é”ï¼Œæ›´æ–°ä»¥ patch æ–¹å¼åº”ç”¨ï¼Œé¿å…ä¸ä¸€è‡´çŠ¶æ€ã€‚</li><li>ä½¿ç”¨èŠ‚ç‚¹çº§é”ä»£æ›¿å…¨æ ‘é”ï¼Œæé«˜å¹¶å‘å†™å…¥èƒ½åŠ›ã€‚</li><li>ç©ºé—´æ•ˆç‡é«˜ï¼Œé‡‡ç”¨è·¯å¾„å‹ç¼©å‡å°‘èŠ‚ç‚¹æ•°é‡ï¼Œæå‡ç¼“å­˜å±€éƒ¨æ€§ã€‚</li></ul><p><code>PatriciaTrie</code>ï¼ˆæ¥è‡ª commons-collectionsï¼‰</p><ul><li>éçº¿ç¨‹å®‰å…¨ï¼Œå†™å…¥éœ€é”å…¨æ ‘ï¼Œå½±å“è¯»å†™æ€§èƒ½ã€‚</li><li>å¹¶å‘åœºæ™¯ä¸‹æ˜“æˆä¸ºç“¶é¢ˆã€‚</li></ul><p>ä¸&nbsp;<code>PatriciaTrie</code>&nbsp;ç›¸æ¯”ï¼Œ<code>ConcurrentRadixTree</code>&nbsp;å…·æœ‰ä»¥ä¸‹å…³é”®ä¼˜åŠ¿ï¼š</p><ol><li><strong>æ— é”ï¼è¯»å†™åˆ†ç¦»ï¼š</strong><code>ConcurrentRadixTree</code>&nbsp;åœ¨è¯»æ“ä½œæ–¹é¢å®ç°äº† â€œè¿‘ä¹æ— é”â€ çš„ç‰¹æ€§ã€‚è¯»çº¿ç¨‹æ— éœ€ç«äº‰é”ï¼Œå°±èƒ½å®‰å…¨åœ°éå†æ ‘ç»“æ„ã€‚å¯¹äºå†™æ“ä½œï¼Œå®ƒä¼šå°†æ›´æ”¹å†…å®¹æ‰“åŒ…æˆä¸€ä¸ª â€œè¡¥ä¸â€ï¼ˆpatchï¼‰ï¼Œå¹¶ä»¥åŸå­æ–¹å¼è¿›è¡Œåº”ç”¨ã€‚è¿™ç¡®ä¿äº†è¯»è€…è¦ä¹ˆçœ‹åˆ°è¡¥ä¸åº”ç”¨å‰çš„æ—§ç‰ˆæœ¬ï¼Œè¦ä¹ˆçœ‹åˆ°è¡¥ä¸åº”ç”¨åçš„æ–°ç‰ˆæœ¬ï¼Œå§‹ç»ˆèƒ½è·å¾—ä¸€è‡´çš„æ•°æ®è§†å›¾ã€‚è¿™ç§è®¾è®¡åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œèƒ½å¤Ÿæ˜¾è‘—å‡å°‘è¯»å†™å†²çªï¼Œæœ‰æ•ˆé™ä½æ“ä½œå»¶è¿Ÿã€‚</li><li><strong>ç»†ç²’åº¦å¹¶å‘æ§åˆ¶ï¼š</strong><code>ConcurrentRadixTree</code>&nbsp;å†…éƒ¨é‡‡ç”¨åˆ†æ®µæˆ–èŠ‚ç‚¹çº§åˆ«çš„é”æ¥æ§åˆ¶å†™å…¥æ“ä½œï¼Œé¿å…äº†åƒä½¿ç”¨&nbsp;<code>synchronized</code>&nbsp;å¯¹æ•´ä¸ªè¡¨åŠ é”é‚£æ ·å¯¼è‡´æ‰€æœ‰æ“ä½œè¢«é˜»å¡çš„æƒ…å†µã€‚åœ¨è¿›è¡Œå†™å…¥æ“ä½œæ—¶ï¼Œä»…å¯¹å—å½±å“çš„å­æ ‘æˆ–èŠ‚ç‚¹åŠ é”ï¼Œè€Œå…¶ä»–åˆ†æ”¯ä»å¯åŒæ—¶è¿›è¡Œè¯»å†™æ“ä½œï¼Œä»è€Œæé«˜äº†å¹¶å‘æ€§èƒ½ã€‚</li><li><strong>åŸç”Ÿå‰ç¼€ï¼é€šé…ç¬¦æŸ¥è¯¢ï¼š</strong><code>ConcurrentRadixTree</code>&nbsp;æ”¯æŒå¤šç§é«˜æ•ˆçš„æŸ¥è¯¢æ–¹å¼ï¼ŒåŒ…æ‹¬å‰ç¼€æŸ¥æ‰¾ã€ç²¾ç¡®æŸ¥æ‰¾ï¼Œè¿˜å…·å¤‡å…³é”®è¯æ‰«æåŠŸèƒ½ï¼ˆ<code>ConcurrentInvertedRadixTree</code>ï¼‰ã€‚è¿™äº›æŸ¥è¯¢æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O (m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> ï¼Œm ä¸ºæŸ¥è¯¢é•¿åº¦ï¼Œå€ŸåŠ©è·¯å¾„å‹ç¼©åçš„æ ‘ç»“æ„ï¼Œåœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­è®¿é—®çš„èŠ‚ç‚¹æ•°é‡æ›´å°‘ï¼ŒæŸ¥è¯¢é€Ÿåº¦å¯ä¸å“ˆå¸Œè¡¨ç›¸åª²ç¾ã€‚</li><li><strong>å†…å­˜ç´§å‡‘ï¼‹å¿«é€Ÿè·¯å¾„å‹ç¼©</strong>ï¼šç›¸è¾ƒäºæ™®é€šçš„ Trie æ ‘ï¼ŒRadix Tree èƒ½å¤Ÿå°†åªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹çš„é“¾è·¯è¿›è¡Œåˆå¹¶ï¼Œä»è€Œå‡å°‘æ ‘çš„æ·±åº¦å’ŒèŠ‚ç‚¹æ•°é‡ã€‚è¿™ç§ä¼˜åŒ–ä¸ä»…æé«˜äº†å†…å­˜åˆ©ç”¨ç‡ï¼Œè¿˜æå‡äº†ç¼“å­˜å‘½ä¸­ç‡ï¼Œä½¿æ•°æ®è®¿é—®æ›´åŠ é«˜æ•ˆã€‚</li></ol><p>get æ“ä½œ</p><p>get æ“ä½œæ¯”è¾ƒç®€å•ï¼Œå¦‚æœå‘½ä¸­ç¼“å­˜åˆ™è¿”å› <code>Optional&lt;T&gt;</code> å¦åˆ™è¿”å› <code>Optional. EMPTY</code>ï¼›</p><p>put æ“ä½œ</p><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/20250623-1.png" alt="Put æ“ä½œ"></p><p>invalidate æ“ä½œ</p><p>é¦–å…ˆé€šè¿‡å‰ç¼€æ ‘æ£€ç´¢å¾…åˆ é™¤å¯¹è±¡çš„&nbsp;<code>NameIdentifier</code>&nbsp;å’Œ IDï¼Œå†ä¾æ¬¡åˆ é™¤æ•°æ®ç¼“å­˜ä¸ç´¢å¼•ç¼“å­˜ï¼Œç¡®ä¿ä¸€è‡´æ€§ã€‚</p><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/InvalidateOP.png" alt="Invalidate æ“ä½œ"></p><h2 id="æµ‹è¯•"><a class="markdownIt-Anchor" href="#æµ‹è¯•"></a> æµ‹è¯•</h2><p>æµ‹è¯•ä½¿ç”¨çš„ Entity å®ä½“ï¼›</p><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/20250530155033.png" alt="æµ‹è¯•ä½¿ç”¨çš„ Entity"></p><h3 id="ut-æµ‹è¯•"><a class="markdownIt-Anchor" href="#ut-æµ‹è¯•"></a> UT æµ‹è¯•</h3><table><thead><tr><th><strong>Category</strong></th><th><strong>Test Case Description</strong></th><th><strong>Method (s)</strong></th></tr></thead><tbody><tr><td><strong>Basic Functionality</strong></td><td>Basic put/get/getIfPresent operations</td><td><code>testPutAndGet</code>, <code>testGetIfPresent</code></td></tr><tr><td></td><td>Same identifier with different entity types</td><td><code>testPutSameIdentifierEntities</code></td></tr><tr><td></td><td>Size counting</td><td><code>testSize</code></td></tr><tr><td></td><td>Clear the cache</td><td><code>testClear</code></td></tr><tr><td><strong>Invalidation</strong></td><td>Invalidate by METALAKE/CATALOG/SCHEMA/TABLE level</td><td><code>testInvalidateMetalake</code>, <code>testInvalidateCatalog</code>, <code>testInvalidateSchema</code>, <code>testInvalidateTable</code></td></tr><tr><td></td><td>Invalidate non-existent entity</td><td><code>testRemoveNonExistentEntity</code></td></tr><tr><td><strong>Relation Handling</strong></td><td>Put/Get/Invalidate entity relations</td><td>Covered in multiple tests (e.g., <code>testPutAndGet</code>, <code>testGetIfPresent</code>)</td></tr><tr><td><strong>Eviction Policies</strong></td><td>Expire by time</td><td><code>testExpireByTime</code></td></tr><tr><td></td><td>Expire by weight</td><td><code>testExpireByWeight</code></td></tr><tr><td></td><td>Exceed max weight immediately</td><td><code>testExpireByWeightExceedMaxWeight</code></td></tr><tr><td></td><td>Expire by size</td><td><code>testExpireBySize</code></td></tr><tr><td><strong>Weight Logic</strong></td><td>Correctness of entity weight calculation</td><td><code>testWeightCalculation</code></td></tr><tr><td><strong>Error &amp; Boundary</strong></td><td>Null argument checks</td><td><code>testGetIfPresentWithNull</code>, <code>testContainsWithNull</code>, <code>testInvalidateWithNull</code>, <code>testPutWithNull</code></td></tr></tbody></table><h3 id="å¤šçº¿ç¨‹ä¸€è‡´æ€§æµ‹è¯•"><a class="markdownIt-Anchor" href="#å¤šçº¿ç¨‹ä¸€è‡´æ€§æµ‹è¯•"></a> å¤šçº¿ç¨‹ä¸€è‡´æ€§æµ‹è¯•</h3><p>æµ‹è¯•é‡‡ç”¨ JCStress æ¡†æ¶ï¼Œä¸»è¦ç›®çš„æ˜¯éªŒè¯&nbsp;<code>CaffeineEntityCache</code>&nbsp;åœ¨å¤šçº¿ç¨‹é«˜å¹¶å‘åœºæ™¯ä¸‹çš„å¯è§æ€§å’Œä¸€è‡´æ€§ã€‚ç›¸æ¯”ä¼ ç»Ÿçš„å•çº¿ç¨‹æˆ– JUnit-based å¤šçº¿ç¨‹æµ‹è¯•ï¼ŒJCStress æ›´é€‚åˆæŒ–æ˜åœ¨ JMMï¼ˆJava Memory Modelï¼‰å±‚çº§ä¸Šçš„ç«æ€é—®é¢˜ã€‚</p><table><thead><tr><th>Test Case</th><th>Scenario</th><th>Expected Outcome (s)</th><th>Unexpected Outcome (s)</th><th>Description</th></tr></thead><tbody><tr><td>PutWithGetIfPresentCoherenceTest</td><td>put vs getIfPresent</td><td>ENTITY</td><td>NULL</td><td>getIfPresent should always see the entity after put.</td></tr><tr><td>PutWithContainCoherenceTest</td><td>put vs contains</td><td>ENTITY</td><td>NULL</td><td>contains should return true after repeated put.</td></tr><tr><td>PutWithInvalidateCoherenceTest</td><td>put vs invalidate</td><td>ENTITY</td><td>NULL</td><td>Race: either put or invalidate wins, both acceptable.</td></tr><tr><td>PutWithClearCoherenceTest</td><td>put vs clear</td><td>ENTITY</td><td>NULL</td><td>Race: either put or clear wins, both acceptable.</td></tr><tr><td>ConcurrentPutDifferentKeysTest</td><td>concurrent put (different keys)</td><td>2</td><td>1 or 0</td><td>Both entities should be visible; lower count indicates visibility issue.</td></tr><tr><td>ConcurrentPutDifferentKeysWithRelationTest</td><td>concurrent put (diff rel keys)</td><td>2</td><td>1 or 0</td><td>Both relation entries should be visible.</td></tr><tr><td>ConcurrentPutSameKeyTest</td><td>concurrent put (same key)</td><td>1</td><td>0</td><td>Value should remain visible after concurrent put.</td></tr><tr><td>ConcurrentPutSameKeyWithRelationTest</td><td>concurrent put (same key with rel)</td><td>1</td><td>0</td><td>Relation value should remain visible.</td></tr><tr><td>InvalidateWithGetCoherenceTest</td><td>invalidate vs getIfPresent</td><td>ENTITY</td><td>NULL</td><td>Race: get may or may not see the entity.</td></tr><tr><td>ConcurrentInvalidateSameKeyCoherenceTest</td><td>invalidate x2 (same key)</td><td>SUCCESS</td><td>FAILURE</td><td>Idempotent invalidate should remove key safely.</td></tr><tr><td>ConcurrentInvalidateRelatedKeyCoherenceTest</td><td>invalidate x2 (related keys)</td><td>SUCCESS</td><td>FAILURE</td><td>Both keys should be removed safely.</td></tr><tr><td>ClearWithInvalidateCoherenceTest</td><td>clear vs invalidate</td><td>SUCCESS</td><td>FAILURE</td><td>All keys should be removed; no residue expected.</td></tr></tbody></table><p>æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š<br><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/20250619232746.png" alt="JCStress æµ‹è¯•ç»“æœ"></p><h3 id="æ€§èƒ½æµ‹è¯•"><a class="markdownIt-Anchor" href="#æ€§èƒ½æµ‹è¯•"></a> æ€§èƒ½æµ‹è¯•</h3><p>Cache çš„æ€§èƒ½æµ‹è¯•é‡‡ç”¨ JMH æ¡†æ¶ï¼ŒJMHï¼ˆJava Microbenchmark Harnessï¼‰æ˜¯ç”± OpenJDK å›¢é˜Ÿå¼€å‘çš„ä¸€ä¸ªåŸºå‡†æµ‹è¯•æ¡†æ¶ï¼Œç”¨äºæ„å»ºã€è¿è¡Œå’Œåˆ†æç²¾ç¡®çš„ Java å¾®åŸºå‡†æµ‹è¯•ã€‚å®ƒä¸“ä¸ºæµ‹é‡ç»†ç²’åº¦æ“ä½œçš„æ€§èƒ½è€Œè®¾è®¡ï¼Œä¾‹å¦‚æ–¹æ³•è°ƒç”¨ã€ç¼“å­˜è®¿é—®æˆ–å¯¹è±¡åˆ†é…ç­‰ï¼Œè¿™äº›æ“ä½œçš„æ€§èƒ½æµ‹é‡å¯¹ç²¾åº¦è¦æ±‚æé«˜ï¼Œæ¯«ç§’çº§çš„ç²¾åº¦å·²æ— æ³•æ»¡è¶³éœ€æ±‚ã€‚</p><p>æµ‹è¯•ä½¿ç”¨çš„é…ç½®å¦‚ä¸‹ï¼š</p><ul><li>CPU: Apple M2 Pro</li><li>Memory: 16 GB</li><li>OS: macOS Ventura 15.5</li><li>JVM: openjdk version â€œ17.0.15â€</li><li>JMH Version: 1.37</li><li>Benchmark Config:<ul><li><code>@BenchmarkMode</code>: Throughput &amp; AverageTime</li><li><code>@State</code>: Scope.Thread</li><li><code>@Fork</code>: 1</li><li><code>@Warmup</code>: 5 iterations</li><li><code>@Measurement</code>: 10 iterations</li></ul></li></ul><pre class="line-numbers language-text" data-language="text"><code class="language-text">Benchmark                                                   (totalCnt)   Mode  Cnt         Score         Error  UnitsEntityCacheClearBenchmark.benchmarkClear                            10  thrpt   10    536704.823 Â±   36351.106  ops/sEntityCacheClearBenchmark.benchmarkClear                           100  thrpt   10     89391.338 Â±    4692.738  ops/sEntityCacheClearBenchmark.benchmarkClear                          1000  thrpt   10      8406.573 Â±     738.173  ops/sEntityCacheContainsBenchmark.benchmarkContains                      10  thrpt   10  19008727.286 Â± 1172892.696  ops/sEntityCacheContainsBenchmark.benchmarkContains                     100  thrpt   10  19129605.626 Â±  928728.148  ops/sEntityCacheContainsBenchmark.benchmarkContains                    1000  thrpt   10  17954917.808 Â±  916939.288  ops/sEntityCacheContainsBenchmark.benchmarkContainsWithRelation          10  thrpt   10   9454829.072 Â±  403482.020  ops/sEntityCacheContainsBenchmark.benchmarkContainsWithRelation         100  thrpt   10   5910924.166 Â±  234228.471  ops/sEntityCacheContainsBenchmark.benchmarkContainsWithRelation        1000  thrpt   10   1021172.939 Â±  188152.980  ops/sEntityCacheGetBenchmark.benchmarkGet                                10  thrpt   10  17646662.661 Â± 1850512.796  ops/sEntityCacheGetBenchmark.benchmarkGet                               100  thrpt   10  17906401.139 Â±  905521.957  ops/sEntityCacheGetBenchmark.benchmarkGet                              1000  thrpt   10  17882451.612 Â± 1013749.411  ops/sEntityCacheGetBenchmark.benchmarkGetWithRelations                   10  thrpt   10   7949607.041 Â±  323537.818  ops/sEntityCacheGetBenchmark.benchmarkGetWithRelations                  100  thrpt   10   4939219.694 Â±   54283.320  ops/sEntityCacheGetBenchmark.benchmarkGetWithRelations                 1000  thrpt   10   1060788.506 Â±   22922.363  ops/sEntityCacheInvalidateBenchmark.benchmarkInvalidate                  10  thrpt   10    184227.751 Â±    6303.043  ops/sEntityCacheInvalidateBenchmark.benchmarkInvalidate                 100  thrpt   10     19663.536 Â±     684.142  ops/sEntityCacheInvalidateBenchmark.benchmarkInvalidate                1000  thrpt   10      1651.429 Â±     213.587  ops/sEntityCachePutBenchmark.benchmarkPut                                10  thrpt   10    222207.294 Â±   10992.713  ops/sEntityCachePutBenchmark.benchmarkPut                               100  thrpt   10     20128.455 Â±     434.551  ops/sEntityCachePutBenchmark.benchmarkPut                              1000  thrpt   10      1902.510 Â±      75.715  ops/sEntityCachePutBenchmark.benchmarkPutWithRelation                    10  thrpt   10    335683.335 Â±   34641.231  ops/sEntityCachePutBenchmark.benchmarkPutWithRelation                   100  thrpt   10     26415.590 Â±    1511.666  ops/sEntityCachePutBenchmark.benchmarkPutWithRelation                  1000  thrpt   10      2345.904 Â±      89.693  ops/sEntityCacheSizeBenchmark.entityCacheSize                            10  thrpt   10   9416189.995 Â± 1018247.698  ops/sEntityCacheSizeBenchmark.entityCacheSize                           100  thrpt   10    944383.407 Â±   35235.930  ops/sEntityCacheSizeBenchmark.entityCacheSize                          1000  thrpt   10     79938.016 Â±    2466.431  ops/sEntityCacheClearBenchmark.benchmarkClear                            10   avgt   10        â‰ˆ 10â»âµ                 s/opEntityCacheClearBenchmark.benchmarkClear                           100   avgt   10        â‰ˆ 10â»â´                 s/opEntityCacheClearBenchmark.benchmarkClear                          1000   avgt   10        â‰ˆ 10â»Â³                 s/opEntityCacheContainsBenchmark.benchmarkContains                      10   avgt   10        â‰ˆ 10â»â·                 s/opEntityCacheContainsBenchmark.benchmarkContains                     100   avgt   10        â‰ˆ 10â»â·                 s/opEntityCacheContainsBenchmark.benchmarkContains                    1000   avgt   10        â‰ˆ 10â»â·                 s/opEntityCacheContainsBenchmark.benchmarkContainsWithRelation          10   avgt   10        â‰ˆ 10â»â¶                 s/opEntityCacheContainsBenchmark.benchmarkContainsWithRelation         100   avgt   10        â‰ˆ 10â»â¶                 s/opEntityCacheContainsBenchmark.benchmarkContainsWithRelation        1000   avgt   10        â‰ˆ 10â»âµ                 s/opEntityCacheGetBenchmark.benchmarkGet                                10   avgt   10        â‰ˆ 10â»â·                 s/opEntityCacheGetBenchmark.benchmarkGet                               100   avgt   10        â‰ˆ 10â»â·                 s/opEntityCacheGetBenchmark.benchmarkGet                              1000   avgt   10        â‰ˆ 10â»â·                 s/opEntityCacheGetBenchmark.benchmarkGetWithRelations                   10   avgt   10        â‰ˆ 10â»â¶                 s/opEntityCacheGetBenchmark.benchmarkGetWithRelations                  100   avgt   10        â‰ˆ 10â»â¶                 s/opEntityCacheGetBenchmark.benchmarkGetWithRelations                 1000   avgt   10        â‰ˆ 10â»âµ                 s/opEntityCacheInvalidateBenchmark.benchmarkInvalidate                  10   avgt   10        â‰ˆ 10â»âµ                 s/opEntityCacheInvalidateBenchmark.benchmarkInvalidate                 100   avgt   10        â‰ˆ 10â»â´                 s/opEntityCacheInvalidateBenchmark.benchmarkInvalidate                1000   avgt   10         0.002 Â±       0.001   s/opEntityCachePutBenchmark.benchmarkPut                                10   avgt   10        â‰ˆ 10â»âµ                 s/opEntityCachePutBenchmark.benchmarkPut                               100   avgt   10        â‰ˆ 10â»â´                 s/opEntityCachePutBenchmark.benchmarkPut                              1000   avgt   10         0.002 Â±       0.001   s/opEntityCachePutBenchmark.benchmarkPutWithRelation                    10   avgt   10        â‰ˆ 10â»âµ                 s/opEntityCachePutBenchmark.benchmarkPutWithRelation                   100   avgt   10        â‰ˆ 10â»â´                 s/opEntityCachePutBenchmark.benchmarkPutWithRelation                  1000   avgt   10         0.002 Â±       0.001   s/opEntityCacheSizeBenchmark.entityCacheSize                            10   avgt   10        â‰ˆ 10â»â¶                 s/opEntityCacheSizeBenchmark.entityCacheSize                           100   avgt   10        â‰ˆ 10â»âµ                 s/opEntityCacheSizeBenchmark.entityCacheSize                          1000   avgt   10        â‰ˆ 10â»â´                 s/op<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ“ä½œå¤æ‚åº¦æ€»ç»“å¦‚ä¸‹ï¼š</p><table><thead><tr><th>æ“ä½œç±»å‹</th><th>æ—¶é—´å¤æ‚åº¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>contains</code></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td><td>å¸¸é‡æ—¶é—´çš„é”®æŸ¥æ‰¾</td></tr><tr><td><code>get</code></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td><td>åŸºäºé”®çš„ç›´æ¥è¯»å–æ“ä½œ</td></tr><tr><td><code>getWithRel</code></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>K</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(K)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mclose">)</span></span></span></span></td><td>ç¼“å­˜æŸ¥æ‰¾ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> ï¼Œä½†åˆ—è¡¨è½¬æ¢è¿‡ç¨‹å¸¦æ¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>K</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(K)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mclose">)</span></span></span></span> çš„çº¿æ€§å¼€é”€</td></tr><tr><td><code>put</code></td><td>æ¯æ¡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> â†’ æ€»ä½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></td><td>ä¸æ”¯æŒæ‰¹é‡å†™å…¥ï¼Œéœ€éå†æ’å…¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> æ¡è®°å½•</td></tr><tr><td><code>putWithRel</code></td><td>æ¯æ¡å…³ç³» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> â†’ æ€»ä½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></td><td>æ¯ä¸ªå…³è”åˆ—è¡¨å•ç‹¬å†™å…¥</td></tr><tr><td><code>invalidate</code></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></td><td>é€æ¡æˆ–æŒ‰ç»„æ¸…é™¤ç¼“å­˜é¡¹</td></tr><tr><td><code>clear</code></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></td><td>å¯¹æ‰€æœ‰ç¼“å­˜é¡¹è¿›è¡Œçº¿æ€§éå†æ¸…é™¤</td></tr><tr><td><code>size()</code></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></td><td>éœ€æ‰«ææ‰€æœ‰ç¼“å­˜é¡¹ä»¥ç²¾ç¡®è®¡ç®—å¤§å°</td></tr></tbody></table><p>å°½ç®¡&nbsp;<code>getWithRel()</code>&nbsp;æ“ä½œæœ¬èº«é€šè¿‡é”®æŸ¥æ‰¾ç¼“å­˜æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> ï¼Œä½†å…¶ä¸»è¦å¼€é”€åœ¨äºå°†ç¼“å­˜ä¸­çš„&nbsp;<code>List&lt;Entity&gt;</code>&nbsp;è½¬æ¢ä¸ºç‰¹å®šç±»å‹çš„&nbsp;<code>List&lt;E&gt;</code>ã€‚</p><p>è¿™ä¸ªè½¬æ¢è¿‡ç¨‹åŒ…æ‹¬ï¼š</p><ul><li>éå†ç¼“å­˜åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼›</li><li>å¯¹æ¯ä¸ª&nbsp;<code>Entity</code>&nbsp;è¿›è¡Œç±»å‹æ ¡éªŒå’Œå¼ºåˆ¶ç±»å‹è½¬æ¢ä¸ºé¢„æœŸçš„æ³›å‹ç±»å‹&nbsp;<code>E</code>ã€‚</li></ul><p>å› æ­¤ï¼Œè¯¥æ“ä½œçš„æ€»ä½“æ—¶é—´å¤æ‚åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>K</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(K)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mclose">)</span></span></span></span> ï¼Œå…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> æ˜¯å•ä¸ªç¼“å­˜é”®ä¸‹å…³è”å®ä½“çš„æ•°é‡ã€‚éšç€å…³è”å®ä½“æ•°é‡çš„å¢åŠ ï¼Œè¿™ä¸€æˆæœ¬ä¹Ÿå°†çº¿æ€§å¢é•¿ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ®ç»„ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Gravitino </tag>
            
            <tag> big-data </tag>
            
            <tag> metadata </tag>
            
            <tag> open-source </tag>
            
            <tag> cache </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2025-07-01  å°è®°</title>
      <link href="/2025/07/01/diarly/2025-07-01-diary/"/>
      <url>/2025/07/01/diarly/2025-07-01-diary/</url>
      
        <content type="html"><![CDATA[<h2 id="äººç”Ÿæ„Ÿæ‚Ÿ"><a class="markdownIt-Anchor" href="#äººç”Ÿæ„Ÿæ‚Ÿ"></a> äººç”Ÿæ„Ÿæ‚Ÿ</h2><p>ç»™ 2025 å¹´çš„è‡ªå·±ç«‹å‡ ä¸ªäººç”Ÿçš„å°ç›®æ ‡</p><ol><li>æˆä¸ºä¸€ä¸ªæ›´å¥åº·çš„äººï¼šå°†ä½“é‡æ§åˆ¶åœ¨ 82kg å·¦å³ï¼Œä½“è„‚ç‡é™è‡³ 20% ä»¥ä¸‹ï¼Œå…»æˆé•¿æœŸå¯æŒç»­çš„é¥®é£Ÿä¹ æƒ¯ä¸è¿åŠ¨è§„å¾‹ï¼Œå»ºç«‹ç¨³å®šçš„å¥åº·ç”Ÿæ´»æ–¹å¼ï¼›</li><li>æˆä¸ºä¸€ä¸ªæœ‰æ·±åº¦çš„æ€è€ƒè€…ï¼šä¿æŒå¥½å¥‡å¿ƒï¼ŒæŒç»­é˜…è¯»ã€æ€è€ƒä¸åæ€ï¼Œä¿æŒè¾“å‡ºï¼Œæ­å»ºè‡ªå·±çš„æ’­å®¢ç³»ç»Ÿï¼›</li><li>æˆä¸ºä¸€ä¸ªæœ‰å½±å“åŠ›çš„äººï¼šç§¯æå‚ä¸å…¬å…±äº‹åŠ¡ï¼Œè´¡çŒ®äºçŸ¥è¯†åˆ†äº«ä¸å¼€æºç¤¾åŒºï¼Œæå‡ä¸ªäººå½±å“åŠ›ä¸ç¤¾ä¼šå‚ä¸æ„Ÿï¼›</li><li>æˆä¸ºä¸€ä¸ªæ›´æœ‰èƒ½åŠ›çš„äººï¼šä¸æ–­ç²¾è¿›å¤šå…ƒæŠ€èƒ½ï¼ŒåŒ…æ‹¬ä½“è‚²ã€è¯­è¨€ã€è´¢åŠ¡ä¸é¡¹ç›®ç®¡ç†ç­‰ï¼Œæå‡åº”å¯¹å¤æ‚é—®é¢˜çš„ç»¼åˆèƒ½åŠ›ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> æ—¥è®°éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿæ´» </tag>
            
            <tag> 2025ç›®æ ‡ </tag>
            
            <tag> æ·±åº¦æ€è€ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gravitino Event System</title>
      <link href="/2025/06/19/gravitino/2025-06-19-gravitino-eventsystem/"/>
      <url>/2025/06/19/gravitino/2025-06-19-gravitino-eventsystem/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a class="markdownIt-Anchor" href="#èƒŒæ™¯"></a> èƒŒæ™¯</h2><p>ä¸ºæå‡&nbsp;<strong>Gravitino çš„æ‰©å±•æ€§</strong>ï¼Œå¼•å…¥äº†<strong>å¯æ’æ‹”çš„äº‹ä»¶ç›‘å¬ç³»ç»Ÿ</strong>ï¼Œå…è®¸ç”¨æˆ·åœ¨ Gravitino çš„æ“ä½œåæŒ‚è½½è‡ªå®šä¹‰é€»è¾‘ã€‚å…¸å‹ä½¿ç”¨åœºæ™¯åŒ…æ‹¬ï¼š</p><ul><li>æ—¥å¿—å®¡è®¡ï¼›</li><li>å‘å…¶ä»– Catalog è¿›è¡ŒåŒå†™ï¼›</li></ul><h2 id="è®¾è®¡ç›®æ ‡"><a class="markdownIt-Anchor" href="#è®¾è®¡ç›®æ ‡"></a> è®¾è®¡ç›®æ ‡</h2><ul><li>æ”¯æŒåœ¨&nbsp;<strong>Gravitino æœåŠ¡</strong>&nbsp;ä¸&nbsp;<strong>Iceberg REST Catalog æœåŠ¡</strong>&nbsp;ä¸­ç»Ÿä¸€æ¥å…¥äº‹ä»¶ç›‘å¬æœºåˆ¶</li><li>æ”¯æŒå¯æ’æ‹”æ’ä»¶ä½“ç³»ï¼Œæ–¹ä¾¿ç¬¬ä¸‰æ–¹è‡ªå®šä¹‰äº‹ä»¶å¤„ç†é€»è¾‘</li></ul><p>ä¸æ”¯æŒ</p><ul><li><strong>å¼ºä¸€è‡´æ€§çš„æƒé™æ§åˆ¶</strong>ï¼ˆå¦‚ç²¾ç»†åŒ–æˆæƒï¼‰ä¸ä½œä¸ºç›®æ ‡</li><li><strong>äº‹ä»¶ç›‘å¬å™¨å†…éƒ¨å¼‚å¸¸å¤„ç†</strong>ï¼ˆå¦‚çº¿ç¨‹é˜»å¡ã€æŒ‚èµ·ï¼‰äº¤ç”±è°ƒç”¨æ–¹è‡ªè¡Œç®¡ç†</li><li><strong>æƒé™æ ¡éªŒ</strong>åœ¨ HTTP Handler å±‚å®Œæˆï¼Œä¸ç”±äº‹ä»¶æœºåˆ¶æ‰¿æ‹…</li><li>è¯¥æœºåˆ¶<strong>ä¸ç”¨äº Gravitino å†…éƒ¨æ¨¡å—ä¹‹é—´çš„é€šä¿¡</strong></li></ul><h2 id="å…·ä½“è®¾è®¡"><a class="markdownIt-Anchor" href="#å…·ä½“è®¾è®¡"></a> å…·ä½“è®¾è®¡</h2><p>æä¾› hook ç‚¹ï¼Œåœ¨ Gravitino æ“ä½œå®Œæˆåè§¦å‘äº‹ä»¶ã€‚äº‹ä»¶å¯ä»¥åŒæ­¥æˆ–å¼‚æ­¥å¤„ç†ã€‚</p><h3 id="ç”¨æˆ·è§†è§’"><a class="markdownIt-Anchor" href="#ç”¨æˆ·è§†è§’"></a> ç”¨æˆ·è§†è§’</h3><h4 id="é…ç½®æ–¹å¼"><a class="markdownIt-Anchor" href="#é…ç½®æ–¹å¼"></a> é…ç½®æ–¹å¼</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># é…ç½®ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨</span><span class="token assign-left variable">gravitino.eventListener.names</span><span class="token operator">=</span>audit<span class="token comment"># é…ç½®å¤šä¸ªäº‹ä»¶ç›‘å¬å™¨</span><span class="token assign-left variable">gravitino.eventListener.names</span><span class="token operator">=</span>audit,test<span class="token comment"># ç›‘å¬å™¨å®ç°ç±»</span>gravitino.eventListener.<span class="token punctuation">{</span>name<span class="token punctuation">}</span>.class<span class="token operator">=</span>xxxx<span class="token comment"># ç”¨æˆ·è‡ªå®šä¹‰å±æ€§</span>gravitino.eventListener.<span class="token punctuation">{</span>name<span class="token punctuation">}</span>.<span class="token punctuation">{</span>key<span class="token punctuation">}</span><span class="token comment"># é…ç½®å¼‚æ­¥é˜Ÿåˆ—å¤§å°</span>gravitino.eventListener.<span class="token punctuation">{</span>name<span class="token punctuation">}</span>.queueCapacity<span class="token operator">=</span><span class="token number">1000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="æ¥å£å®šä¹‰"><a class="markdownIt-Anchor" href="#æ¥å£å®šä¹‰"></a> æ¥å£å®šä¹‰</h4><p>æ ¸å¿ƒæ¥å£ï¼š<code>EventListenerPlugin</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">EventListenerPlugin</span> <span class="token punctuation">{</span>  <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> properties<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">void</span> <span class="token function">onPostEvent</span><span class="token punctuation">(</span><span class="token class-name">Event</span> event<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ¥æ”¶äº‹ä»¶</span>  <span class="token keyword">default</span> <span class="token keyword">boolean</span> <span class="token function">isAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token keyword">default</span> <span class="token keyword">boolean</span> <span class="token function">isSharedQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>äº‹ä»¶èµ„æºç±»å‹ï¼š<code>EventResourceType</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">EventResourceType</span> <span class="token punctuation">{</span>  <span class="token constant">METALAKE</span><span class="token punctuation">,</span> <span class="token constant">CATALOG</span><span class="token punctuation">,</span> <span class="token constant">RELATION</span><span class="token punctuation">,</span> <span class="token constant">FILESET</span><span class="token punctuation">,</span> <span class="token constant">ICEBERG_REST</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="å®ç°è§†è§’"><a class="markdownIt-Anchor" href="#å®ç°è§†è§’"></a> å®ç°è§†è§’</h3><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/20250530130828.png" alt="Implement"></p><h4 id="æ ¸å¿ƒç»„ä»¶"><a class="markdownIt-Anchor" href="#æ ¸å¿ƒç»„ä»¶"></a> æ ¸å¿ƒç»„ä»¶</h4><ul><li><strong>EventListenerManager</strong>ï¼šè´Ÿè´£åŠ è½½æ‰€æœ‰äº‹ä»¶ç›‘å¬æ’ä»¶ï¼Œå¹¶æ ¹æ®ä¸åŒæ“ä½œç±»å‹åˆ›å»ºå¯¹åº”çš„&nbsp;<code>EventBus</code>ã€‚</li><li><strong>EventBus</strong>ï¼šç®¡ç†ä¸€ç»„åŠŸèƒ½ä¸€è‡´çš„äº‹ä»¶ç›‘å¬å™¨ï¼ŒæŒ‰ç…§é¡ºåºå°†äº‹ä»¶åˆ†å‘ç»™æ¯ä¸ªç›‘å¬å™¨ã€‚æ”¯æŒåŒæ­¥ä¸å¼‚æ­¥ç›‘å¬å™¨ï¼Œå¼‚æ­¥å¤„ç†ç”±&nbsp;<code>AsyncQueueListener</code>&nbsp;ç®¡ç†ã€‚</li><li><strong>AsyncQueueListener</strong>ï¼šé€šè¿‡é˜Ÿåˆ—æœºåˆ¶å¼‚æ­¥æ¶ˆè´¹äº‹ä»¶ã€‚ä¸åŒç›‘å¬å™¨å¯é€šè¿‡é…ç½®é˜Ÿåˆ—åå…±äº«æ¶ˆè´¹çº¿ç¨‹ï¼Œå®ç°äº‹ä»¶çš„ä¸²è¡Œæˆ–å¹¶è¡Œå¤„ç†ã€‚</li></ul><h4 id="ç”Ÿå‘½å‘¨æœŸä¸æµç¨‹"><a class="markdownIt-Anchor" href="#ç”Ÿå‘½å‘¨æœŸä¸æµç¨‹"></a> ç”Ÿå‘½å‘¨æœŸä¸æµç¨‹</h4><ol><li>å…¨å±€å”¯ä¸€çš„&nbsp;<code>EventListenerManager</code></li><li>åŠ è½½ç›‘å¬å™¨æ’ä»¶</li><li>åˆ›å»ºå¯¹åº”çš„&nbsp;<code>AsyncQueueListener</code>&nbsp;å®ä¾‹</li><li>ä¸ºæ¯ç§ HTTP æ“ä½œæ„å»ºå¹¶æ³¨å†Œ&nbsp;<code>EventBus</code>&nbsp;å®ä¾‹ï¼Œç»‘å®šç›‘å¬å™¨é›†åˆ</li></ol><h4 id="è®¾è®¡è€ƒé‡"><a class="markdownIt-Anchor" href="#è®¾è®¡è€ƒé‡"></a> è®¾è®¡è€ƒé‡</h4><p>æ¥å£ç²’åº¦</p><p>æ–¹æ¡ˆä¸€ï¼šç»Ÿä¸€å¤„ç†äº‹ä»¶</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AuditLogEventListenerPlugin</span> <span class="token keyword">implements</span> <span class="token class-name">EventListenerPlugin</span> <span class="token punctuation">{</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onPostEvent</span><span class="token punctuation">(</span><span class="token class-name">Event</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// ä» event ä¸­æå–å®¡è®¡ä¿¡æ¯å¹¶å†™å…¥æ—¥å¿—</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>ä¼˜åŠ¿</strong>ï¼šé€‚åˆé€šç”¨é€»è¾‘ï¼Œæ’ä»¶é€»è¾‘é›†ä¸­ï¼›</li><li><strong>åŠ£åŠ¿</strong>ï¼šå¯¹æ¯ä¸ªäº‹ä»¶éƒ½éœ€è¦è§£æå­—æ®µï¼Œä¸å¤Ÿæ˜ç¡®</li></ul><p>æ–¹æ¡ˆäºŒï¼šç»†åˆ†å›è°ƒæ¥å£</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AuditLogEventListenerPlugin</span> <span class="token keyword">implements</span> <span class="token class-name">RelationalEventListener</span> <span class="token punctuation">{</span>  <span class="token keyword">void</span> <span class="token function">onTableCreate</span><span class="token punctuation">(</span><span class="token class-name">NameIdentifier</span> id<span class="token punctuation">,</span> <span class="token class-name">OperationResult</span> result<span class="token punctuation">,</span> <span class="token class-name">Table</span> table<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// å†™å®¡è®¡æ—¥å¿—</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>ä¼˜åŠ¿</strong>ï¼šæ›´ç›´è§‚æ¸…æ™°</li><li><strong>åŠ£åŠ¿</strong>ï¼šæ¯ä¸ªäº‹ä»¶éƒ½éœ€è¦å†™ç‹¬ç«‹æ–¹æ³•ï¼Œä»£ç é‡å¤</li></ul><table><thead><tr><th>æ¨¡å¼</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>åŒæ­¥</td><td>ä¸ä¸¢äº‹ä»¶</td><td>é˜»å¡ä¸»æµç¨‹</td></tr><tr><td>å¼‚æ­¥</td><td>ä¸é˜»å¡ä¸»æµç¨‹</td><td>å¯èƒ½ä¸¢äº‹ä»¶</td></tr></tbody></table><p>åŒæ—¶æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥ï¼Œç”±æ’ä»¶æœ¬èº«å†³å®š</p><p>æ˜¯å¦æ”¯æŒç±»åŠ è½½éš”ç¦»</p><p><strong>æ”¯æŒæ›´å¥½</strong>ï¼Œå¦åˆ™æ‰€æœ‰æ’ä»¶åªèƒ½æ”¾åœ¨ Gravitino çš„ classpath ä¸­ï¼Œå¯èƒ½å†²çªã€‚</p><h3 id="dispatcher-è§†è§’"><a class="markdownIt-Anchor" href="#dispatcher-è§†è§’"></a> Dispatcher è§†è§’</h3><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/20250530130843.png" alt="Dispatcher"></p><p>Gravitino çš„ Catalog å®ç°é‡‡ç”¨äº†ç»å…¸çš„<strong>è£…é¥°å™¨æ¨¡å¼ï¼ˆDecorator Patternï¼‰</strong>ã€‚åœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰ç»„ä»¶å‡å®ç°ç›¸åŒçš„æ¥å£ï¼ˆæˆ–ç»§æ‰¿ç»Ÿä¸€çš„æŠ½è±¡ç±»ï¼‰ï¼Œé€šè¿‡<strong>åŒ…è£…å·²æœ‰å¯¹è±¡</strong>çš„æ–¹å¼ï¼Œåœ¨ä¸ä¿®æ”¹å…¶åŸæœ‰é€»è¾‘çš„å‰æä¸‹ï¼Œå¢å¼ºå…¶åŠŸèƒ½ã€‚</p><p>ä»¥&nbsp;<code>ModelEventDispatcher</code>&nbsp;ä¸ºä¾‹ï¼Œå®ƒå¹¶ä¸ç›´æ¥å¤„ç†å…·ä½“çš„ Catalog æ“ä½œï¼Œè€Œæ˜¯<strong>åŒ…è£…ä¸€ä¸ªå®é™…çš„ Dispatcher å®ä¾‹</strong>ã€‚æ ¸å¿ƒèŒè´£å¦‚ä¸‹ï¼š</p><ul><li>å°†æ“ä½œå§”æ‰˜ç»™è¢«åŒ…è£…çš„åº•å±‚ Dispatcherï¼›</li><li>åœ¨å§”æ‰˜æ‰§è¡Œå‰åæ’å…¥è‡ªå®šä¹‰é€»è¾‘ï¼Œå¦‚è§¦å‘äº‹ä»¶ç³»ç»Ÿã€å‘å¸ƒäº‹ä»¶ç­‰ã€‚</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ModelEventDispatcher</span> <span class="token keyword">implements</span> <span class="token class-name">ModelDispatcher</span> <span class="token punctuation">{</span>  <span class="token comment">// æ„é€ çš„æ—¶å€™ä¼ é€’ EventBus å®ä¾‹ä»¥åŠ ModelDispatcher å®ç°ç±»</span>  <span class="token keyword">public</span> <span class="token class-name">ModelEventDispatcher</span><span class="token punctuation">(</span><span class="token class-name">EventBus</span> eventBus<span class="token punctuation">,</span> <span class="token class-name">ModelDispatcher</span> dispatcher<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>eventBus <span class="token operator">=</span> eventBus<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>dispatcher <span class="token operator">=</span> dispatcher<span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token comment">// ä½¿ç”¨ eventBus.dispatchEvent å‘é€äº‹ä»¶ -&gt; eventBus.dispatchPostEvent -&gt; è§¦å‘æ¯ä¸ª Plugin çš„ onPostEvent è¿›è¡Œå¤„ç†</span>  <span class="token annotation punctuation">@Override</span>  <span class="token keyword">public</span> <span class="token class-name">Model</span> <span class="token function">registerModel</span><span class="token punctuation">(</span><span class="token class-name">NameIdentifier</span> ident<span class="token punctuation">,</span> <span class="token class-name">String</span> comment<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> properties<span class="token punctuation">)</span>  <span class="token keyword">throws</span> <span class="token class-name">NoSuchSchemaException</span><span class="token punctuation">,</span> <span class="token class-name">ModelAlreadyExistsException</span> <span class="token punctuation">{</span>    <span class="token class-name">String</span> user <span class="token operator">=</span> <span class="token class-name">PrincipalUtils</span><span class="token punctuation">.</span><span class="token function">getCurrentUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">ModelInfo</span> registerRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelInfo</span><span class="token punctuation">(</span>ident<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> properties<span class="token punctuation">,</span> comment<span class="token punctuation">)</span><span class="token punctuation">;</span>    eventBus<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegisterModelPreEvent</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> ident<span class="token punctuation">,</span> registerRequest<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>      <span class="token class-name">Model</span> model <span class="token operator">=</span> dispatcher<span class="token punctuation">.</span><span class="token function">registerModel</span><span class="token punctuation">(</span>ident<span class="token punctuation">,</span> comment<span class="token punctuation">,</span> properties<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token class-name">ModelInfo</span> registeredModel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelInfo</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>      eventBus<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegisterModelEvent</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> ident<span class="token punctuation">,</span> registeredModel<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> model<span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>      eventBus<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegisterModelFailureEvent</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> ident<span class="token punctuation">,</span> e<span class="token punctuation">,</span> registerRequest<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">throw</span> e<span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ä»£ç å®ç°"><a class="markdownIt-Anchor" href="#ä»£ç å®ç°"></a> ä»£ç å®ç°</h2><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/20250530130927.png" alt="EventBus"></p><h2 id="ç›‘å¬å™¨"><a class="markdownIt-Anchor" href="#ç›‘å¬å™¨"></a> ç›‘å¬å™¨</h2><p>ç›‘å¬å™¨çš„æ¥å£æ˜¯ <code>EventListenerPlugin</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@DeveloperApi</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">EventListenerPlugin</span> <span class="token punctuation">{</span> <span class="token keyword">enum</span> <span class="token class-name">Mode</span> <span class="token punctuation">{</span>    <span class="token constant">SYNC</span><span class="token punctuation">,</span>    <span class="token constant">ASYNC_ISOLATED</span><span class="token punctuation">,</span>    <span class="token constant">ASYNC_SHARED</span>  <span class="token punctuation">}</span>   <span class="token comment">// åˆå§‹åŒ–æ–¹æ³•ï¼Œåˆå§‹åŒ–æ’ä»¶ï¼Œç”¨äºåŠ è½½é…ç½®ã€è¿æ¥èµ„æºç­‰</span> <span class="token comment">// å’ŒæœåŠ¡å™¨ä¸€èµ·å¯åŠ¨ï¼Œå¦‚æœæ’ä»¶å¯åŠ¨å¤±è´¥ï¼Œåˆ™ä¼šå¯¼è‡´æœåŠ¡å™¨å¯åŠ¨å¤±è´¥</span>  <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> properties<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">;</span>    <span class="token comment">// æ’ä»¶å¯åŠ¨é˜¶æ®µï¼Œè¡¨ç¤ºæ’ä»¶å‡†å¤‡å¥½å¼€å§‹å¤„ç†äº‹ä»¶</span>  <span class="token comment">// å¯åŠ¨å¤±è´¥ï¼Œä¾ç„¶ä¼šå¯¼è‡´æœåŠ¡å™¨å¯åŠ¨å¤±è´¥</span>  <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">;</span>    <span class="token comment">// åœæ­¢è¯¥æ’ä»¶ï¼Œå¼‚å¸¸ä¸ä¼šå½±å“ä¸»æµç¨‹ï¼Œä½†å»ºè®®æ¸…ç†èµ„æºä»¥é˜²æ³„æ¼</span>  <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">;</span>    <span class="token comment">// å¤„ç†æ“ä½œæ‰§è¡Œå‰çš„äº‹ä»¶ï¼ˆå¦‚æ ¡éªŒã€æ‹’ç»ç­‰ï¼‰</span>  <span class="token comment">// å¦‚æœæŠ›å‡º ForbiddenException ä¸”æ¨¡å¼ä¸º SYNCï¼Œä¸»æ“ä½œå°†è¢«è·³è¿‡</span> <span class="token comment">// åœ¨ ASYNC æ¨¡å¼ä¸‹æŠ›å‡ºå¼‚å¸¸æ— æ•ˆï¼Œåªè®°å½•æ—¥å¿—</span> <span class="token comment">// å…è®¸ä¿®æ”¹äº‹ä»¶ä¸­çš„èµ„æºï¼ˆå¦‚åŠ¨æ€ä¿®æ”¹å‚æ•°ï¼‰</span>  <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">onPreEvent</span><span class="token punctuation">(</span><span class="token class-name">PreEvent</span> preEvent<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ForbiddenException</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>   <span class="token comment">// å¤„ç†æ“ä½œå®Œæˆåçš„äº‹ä»¶ï¼ˆå¦‚åˆ›å»ºè¡¨åè§¦å‘ï¼‰</span> <span class="token comment">// é»˜è®¤å®ç°ä¸ºç©ºï¼Œåªè¯»äº‹ä»¶ï¼Œä¸èƒ½æ”¹å˜èµ„æº</span> <span class="token comment">// å¯åŒæ­¥æˆ–å¼‚æ­¥æ‰§è¡Œï¼ˆç”± mode() å†³å®šï¼‰</span>  <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">onPostEvent</span><span class="token punctuation">(</span><span class="token class-name">Event</span> postEvent<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">RuntimeException</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token comment">// è¯¥ç›‘å¬å™¨çš„äº‹ä»¶å¤„ç†æ¨¡å¼</span>  <span class="token comment">// é»˜è®¤ä½¿ç”¨åŒæ­¥</span>  <span class="token keyword">default</span> <span class="token class-name">Mode</span> <span class="token function">mode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token class-name">Mode</span><span class="token punctuation">.</span><span class="token constant">SYNC</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>æ¨¡å¼</th><th>ç‰¹ç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><code>SYNC</code></td><td>åŒæ­¥æ‰§è¡Œï¼Œé˜»å¡ä¸»çº¿ç¨‹</td><td>æ‹’ç»è¯·æ±‚ã€å†™å®¡è®¡ã€ä¿®æ”¹äº‹ä»¶èµ„æº</td></tr><tr><td><code>ASYNC_ISOLATED</code></td><td>å¼‚æ­¥æ‰§è¡Œï¼Œæ¯ä¸ªç›‘å¬å™¨ç‹¬ç«‹é˜Ÿåˆ—</td><td>å„ç›‘å¬å™¨èµ„æºéš”ç¦»ï¼Œå¤„ç†è¾ƒå¤æ‚</td></tr><tr><td><code>ASYNC_SHARED</code></td><td>å¼‚æ­¥æ‰§è¡Œï¼Œç›‘å¬å™¨å…±äº«é˜Ÿåˆ—</td><td>å¤šç›‘å¬å™¨å…±äº«çº¿ç¨‹ï¼Œèµ„æºé«˜æ•ˆ</td></tr></tbody></table><h3 id="eventbus"><a class="markdownIt-Anchor" href="#eventbus"></a> EventBus</h3><p>æ ¸å¿ƒå­—æ®µ</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// å­˜å‚¨æ‰€æœ‰æ³¨å†Œçš„äº‹ä»¶ç›‘å¬å™¨å®ä¾‹</span><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">EventListenerPlugin</span><span class="token punctuation">&gt;</span></span> eventListeners<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ ¸å¿ƒæ–¹æ³•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EventBus</span> <span class="token punctuation">{</span>  <span class="token comment">// å‘é€ PreEvent æˆ–è€… Event</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dispatchEvent</span><span class="token punctuation">(</span><span class="token class-name">BaseEvent</span> baseEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>baseEvent <span class="token keyword">instanceof</span> <span class="token class-name">PreEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token function">dispatchPreEvent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">PreEvent</span><span class="token punctuation">)</span> baseEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>baseEvent <span class="token keyword">instanceof</span> <span class="token class-name">Event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token function">dispatchPostEvent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Event</span><span class="token punctuation">)</span> baseEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"Unknown event type:"</span> <span class="token operator">+</span> baseEvent<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token comment">// å‘é€ PostEvent</span>  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">dispatchPostEvent</span><span class="token punctuation">(</span><span class="token class-name">Event</span> postEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>    eventListeners<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>eventListener <span class="token operator">-&gt;</span> eventListener<span class="token punctuation">.</span><span class="token function">onPostEvent</span><span class="token punctuation">(</span>postEvent<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token comment">// å‘é€ PreEvent</span>  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">dispatchPreEvent</span><span class="token punctuation">(</span><span class="token class-name">PreEvent</span> preEvent<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ForbiddenException</span> <span class="token punctuation">{</span>    eventListeners<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>eventListener <span class="token operator">-&gt;</span> eventListener<span class="token punctuation">.</span><span class="token function">onPreEvent</span><span class="token punctuation">(</span>preEvent<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="eventlistenermanager"><a class="markdownIt-Anchor" href="#eventlistenermanager"></a> EventListenerManager</h3><p>æ ¹æ®é…ç½®åŠ è½½ç›‘å¬å™¨ â†’ åŒ…è£…å¤„ç†ï¼ˆæŒ‰æ‰§è¡Œæ¨¡å¼ï¼‰ â†’ æ„å»ºå¯ç”¨çš„ç›‘å¬å™¨åˆ—è¡¨ â†’ åˆ›å»º&nbsp;<code>EventBus</code>&nbsp;ç”¨äºäº‹ä»¶åˆ†å‘ã€‚</p><p>å…³é”®å­—æ®µ:</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// å¼‚æ­¥é˜Ÿåˆ—å¤§å°</span><span class="token keyword">private</span> <span class="token keyword">int</span> queueCapacity<span class="token punctuation">;</span><span class="token comment">// join è¶…æ—¶ç­‰å¾…æ—¶é—´</span><span class="token keyword">private</span> <span class="token keyword">int</span> dispatcherJoinSeconds<span class="token punctuation">;</span><span class="token comment">// æ‰€æœ‰å¤„ç†å®Œç»„è£…é€»è¾‘åçš„ç›‘å¬å™¨åˆ—è¡¨</span><span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">EventListenerPlugin</span><span class="token punctuation">&gt;</span></span> eventListeners<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…³é”®æ–¹æ³•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EventListenerManager</span> <span class="token punctuation">{</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token class-name">EventListenerConfig</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventListenerConfig</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// é»˜è®¤é˜Ÿåˆ—å¤§å° 3000ï¼Œè¶…è¿‡é˜Ÿåˆ—å¤§å°åˆ™äº‹ä»¶ä¼šè¢«æŠ›å¼ƒ</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>queueCapacity <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">EventListenerConfig</span><span class="token punctuation">.</span><span class="token constant">QUEUE_CAPACITY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// join è¶…æ—¶äº‹ä»¶ 3 ç§’</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>dispatcherJoinSeconds <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">EventListenerConfig</span><span class="token punctuation">.</span><span class="token constant">DISPATCHER_JOIN_SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 1. è§£æé…ç½® â†’ æ‰¾å‡ºæ‰€æœ‰ç›‘å¬å™¨åå­—ï¼ˆä¾‹å¦‚ auditã€metricsï¼‰</span>  <span class="token comment">// 2. åŠ è½½å¹¶å®ä¾‹åŒ–æ¯ä¸ªç›‘å¬å™¨ç±»ï¼Œé€šè¿‡åå°„çš„æ–¹å¼æ„å»ºå®ç°ç±»å¯¹è±¡å¹¶è°ƒç”¨ init æ–¹æ³•</span>  <span class="token comment">// 3. åŒ…è£…ä¸º EventListenerWrapper / AsyncQueueListener</span>  <span class="token comment">// 4. æ ¹æ®æ˜¯å¦æ˜¯ shared queue è¿›è¡Œåˆ†ç»„ç»„è£…</span>  <span class="token punctuation">}</span>  <span class="token comment">//  å¯åŠ¨æ‰€æœ‰çš„æ’ä»¶</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    eventListeners<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>listener <span class="token operator">-&gt;</span> listener<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment">// åœæ­¢æ‰€æœ‰çš„æ’ä»¶</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    eventListeners<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>listener <span class="token operator">-&gt;</span> listener<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment">// æ ¹æ®æ’ä»¶æ¨¡å¼ï¼ˆModeï¼‰æ„å»ºä¸åŒåŒ…è£…çš„æ’ä»¶å®ä¾‹  </span>  <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">EventListenerPlugin</span><span class="token punctuation">&gt;</span></span> <span class="token function">assembleEventListeners</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">EventListenerPlugin</span><span class="token punctuation">&gt;</span></span> userEventListeners<span class="token punctuation">)</span>    <span class="token comment">// ä½¿ç”¨é…ç½®çš„ class å­—æ®µè·å–ç±»åå¹¶å®ä¾‹åŒ–</span>  <span class="token comment">// è°ƒç”¨ init(config) åˆå§‹åŒ–</span> <span class="token comment">// å¦‚æœå¤±è´¥ï¼Œä¼šè®°å½•æ—¥å¿—å¹¶æŠ›å‡ºå¼‚å¸¸é˜»æ­¢å¯åŠ¨</span>  <span class="token keyword">private</span> <span class="token class-name">EventListenerPlugin</span> <span class="token function">loadUserEventListenerPlugin</span><span class="token punctuation">(</span><span class="token class-name">String</span> listenerName<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> config<span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>æ¨¡å¼</th><th>åŒ…è£…æ–¹å¼</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td><code>SYNC</code></td><td><code>EventListenerPluginWrapper</code></td><td>åŒæ­¥æ‰§è¡Œï¼Œå¯è®°å½• metricsã€å¤„ç†å¼‚å¸¸ç­‰ï¼ˆé»˜è®¤æ¨¡å¼ï¼‰</td></tr><tr><td><code>ASYNC_ISOLATED</code></td><td>å•ç‹¬çš„&nbsp;<code>AsyncQueueListener</code></td><td>æ¯ä¸ªæ’ä»¶ç‹¬ç«‹çº¿ç¨‹/é˜Ÿåˆ—</td></tr><tr><td><code>ASYNC_SHARED</code></td><td>æ±‡æ€»åç»Ÿä¸€æ”¾å…¥&nbsp;<code>AsyncQueueListener ("default")</code></td><td>å¤šä¸ªæ’ä»¶å…±äº«çº¿ç¨‹/é˜Ÿåˆ—ï¼ŒèŠ‚çœèµ„æº</td></tr></tbody></table><p>æ³¨æ„äº‹é¡¹</p><ul><li>æ‰€æœ‰å…±äº«æ¨¡å¼æ’ä»¶ä¼šé›†ä¸­èµ·æ¥ï¼Œåœ¨æœ€åç»Ÿä¸€åˆ›å»ºä¸€ä¸ª&nbsp;<code>AsyncQueueListener ("default")</code></li><li>æ‰€æœ‰åŒ…è£…åçš„æ’ä»¶éƒ½å®ç°&nbsp;<code>EventListenerPlugin</code>ï¼Œå› æ­¤å¯ç»Ÿä¸€äº¤ç»™&nbsp;<code>EventBus</code>&nbsp;ä½¿ç”¨</li></ul><h3 id="eventlistenerpluginwrapper"><a class="markdownIt-Anchor" href="#eventlistenerpluginwrapper"></a> EventListenerPluginWrapper</h3><p><code>EventListenerManager</code>&nbsp;åœ¨ç®¡ç†æ’ä»¶æ—¶ï¼Œåˆ›å»ºçš„éƒ½æ˜¯&nbsp;<code>EventListenerPluginWrapper</code>&nbsp;å®ä¾‹ï¼Œè¯¥ç±»å°è£…äº†è¯¸å¦‚å¼‚å¸¸å¤„ç†ç­‰å…¬å…±é€»è¾‘ã€‚å…¶&nbsp;<code>onPreEvent</code>&nbsp;åŒ…è£…æ–¹æ³•æ ¹æ® Mode å®šä¹‰äº†ä¸åŒçš„è¡Œä¸ºï¼šä¾‹å¦‚åœ¨ SYNC æ¨¡å¼ä¸‹ï¼Œå¦‚æœ PreEvent æŠ›å‡º&nbsp;<code>ForbiddenException</code>&nbsp;å¼‚å¸¸ï¼Œåˆ™ä¼šç«‹å³ä¸­æ–­æ“ä½œå¹¶æŠ›å‡ºè¯¥å¼‚å¸¸ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onPreEvent</span><span class="token punctuation">(</span><span class="token class-name">PreEvent</span> preEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">try</span> <span class="token punctuation">{</span>   userEventListener<span class="token punctuation">.</span><span class="token function">onPreEvent</span><span class="token punctuation">(</span>preEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ForbiddenException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Mode</span><span class="token punctuation">.</span><span class="token constant">SYNC</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token function">mode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token constant">LOG</span><span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>       <span class="token string">"Event listener {} process pre event {} throws ForbiddenException, will skip the "</span>       <span class="token operator">+</span> <span class="token string">"operation."</span><span class="token punctuation">,</span>       listenerName<span class="token punctuation">,</span>       preEvent<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       e<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">throw</span> e<span class="token punctuation">;</span>   <span class="token punctuation">}</span>   <span class="token function">printExceptionInEventProcess</span><span class="token punctuation">(</span>listenerName<span class="token punctuation">,</span> preEvent<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token function">printExceptionInEventProcess</span><span class="token punctuation">(</span>listenerName<span class="token punctuation">,</span> preEvent<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="event"><a class="markdownIt-Anchor" href="#event"></a> Event</h3><h4 id="preevent"><a class="markdownIt-Anchor" href="#preevent"></a> PreEvent</h4><p><code>PreEvent</code> è¡¨ç¤ºæ“ä½œè¯·æ±‚çš„å‰ç½®äº‹ä»¶ã€‚åœ¨æ“ä½œæ­£å¼æ‰§è¡Œå‰ï¼Œè¯¥äº‹ä»¶å…è®¸ç”¨æˆ·æ’å…¥è‡ªå®šä¹‰æ‹¦æˆªé€»è¾‘ï¼›åœ¨ä½¿ç”¨<strong>åŒæ­¥</strong>æ’ä»¶æ—¶ï¼Œå¦‚æœæŠ›å‡º&nbsp;<code>ForbiddenException</code>ï¼Œåˆ™ä¼šä¸­æ­¢å½“å‰æ“ä½œã€‚</p><h4 id="postevent"><a class="markdownIt-Anchor" href="#postevent"></a> PostEvent</h4><p><code>PostEvent</code> è¡¨ç¤ºæ“ä½œæˆåŠŸå®Œæˆåçš„äº‹ä»¶ã€‚å¦‚æœæ“ä½œæ‰§è¡Œå¤±è´¥ï¼Œåˆ™ä¼šç”Ÿæˆä¸€ä¸ª&nbsp;<code>FailureEvent</code>ï¼Œè¯¥äº‹ä»¶å½’ç±»ä¸º PostEventã€‚PostEvent ä¸€ç»ç”Ÿæˆï¼Œç”¨æˆ·æ— æ³•ä¿®æ”¹æˆ–æ‹¦æˆªè¯¥äº‹ä»¶ã€‚</p><h4 id="failureevent"><a class="markdownIt-Anchor" href="#failureevent"></a> FailureEvent</h4><p>FailureEvent ç”¨äºè¡¨ç¤ºæ“ä½œæ‰§è¡Œå¤±è´¥çš„æƒ…å†µã€‚å®ƒè®°å½•äº†å¯¼è‡´é”™è¯¯çš„åŸå› ä»¥åŠå…¶ä»–ç›¸å…³ä¿¡æ¯ï¼Œä»¥ä¾¿åç»­è¿›è¡Œé”™è¯¯åˆ†æä¸å¤„ç†ã€‚</p><h3 id="dummyeventlistener"><a class="markdownIt-Anchor" href="#dummyeventlistener"></a> DummyEventListener</h3><p>è¯¥ç±»ç”¨äºæµ‹è¯•ï¼Œæ˜¯&nbsp;<code>EventListenerPlugin</code>&nbsp;æ¥å£çš„ä¸€ç§å®ç°ã€‚å®ƒåˆ†åˆ«ä½¿ç”¨ä¸¤ä¸ª&nbsp;<code>LinkedList</code>&nbsp;æ¥å­˜å‚¨&nbsp;<code>PostEvent</code>&nbsp;å’Œ&nbsp;<code>PreEvent</code>&nbsp;äº‹ä»¶ã€‚ä¹‹æ‰€ä»¥é‡‡ç”¨&nbsp;<code>LinkedList</code>ï¼Œæ˜¯å› ä¸ºéœ€è¦ä½¿ç”¨&nbsp;<code>removeLast ()</code>&nbsp;æ–¹æ³•å¼¹å‡ºé˜Ÿåˆ—æœ«å°¾çš„äº‹ä»¶ï¼Œè€Œè¯¥ä½ç½®å­˜å‚¨äº†æœ€æ–°äº§ç”Ÿçš„äº‹ä»¶ã€‚é€šè¿‡æä¾›&nbsp;<code>popPostEvent</code>&nbsp;å’Œ&nbsp;<code>popPreEvent</code>&nbsp;æ–¹æ³•ï¼Œæµ‹è¯•ä»£ç èƒ½å¤Ÿå–å‡ºæœ€æ–°äº‹ä»¶è¿›è¡ŒéªŒè¯ã€‚</p><blockquote><p>é€šå¸¸è¿™ç§ â€œDummyâ€ æˆ–è€… â€œMockâ€ å®ç°ç”¨äºæµ‹è¯•åœºæ™¯ä¸­ï¼Œæ¨¡æ‹Ÿäº‹ä»¶ç›‘å¬å™¨çš„è¡Œä¸ºï¼Œæˆ–ä½œä¸ºç®€å•çš„å ä½å®ç°ï¼Œç”¨äºéªŒè¯äº‹ä»¶å‘å¸ƒå’Œæ¶ˆè´¹é€»è¾‘ã€‚</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Event</span> <span class="token function">popPostEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token class-name">Assertions</span><span class="token punctuation">.</span><span class="token function">assertTrue</span><span class="token punctuation">(</span>postEvents<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"No events to pop"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> postEvents<span class="token punctuation">.</span><span class="token function">removeLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token class-name">PreEvent</span> <span class="token function">popPreEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token class-name">Assertions</span><span class="token punctuation">.</span><span class="token function">assertTrue</span><span class="token punctuation">(</span>preEvents<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"No events to pop"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> preEvents<span class="token punctuation">.</span><span class="token function">removeLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŒæ—¶æä¾›äº†ä¸€ä¸ªå¼‚æ­¥å®ç° <code>DummyAsyncEventListener</code> ï¼Œè¿™ä¸ªç±»ä½¿ç”¨ <code>tryGetPreEvents</code> å’Œ <code>tryGetPostEvents</code> æ–¹æ³•æ¥å¼‚æ­¥è·å–äº‹ä»¶ã€‚</p><ol><li>æœ€å¤šç­‰å¾… 20 ç§’ï¼›</li><li>è½®è®­é—´éš” 10 æ¯«ç§’ï¼›</li></ol><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PreEvent</span><span class="token punctuation">&gt;</span></span> <span class="token function">tryGetPreEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token class-name">Awaitility</span><span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token punctuation">.</span><span class="token function">atMost</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span>      <span class="token punctuation">.</span><span class="token function">pollInterval</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">)</span>      <span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">getPreEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token function">getPreEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Event</span><span class="token punctuation">&gt;</span></span> <span class="token function">tryGetPostEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token class-name">Awaitility</span><span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token punctuation">.</span><span class="token function">atMost</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span>      <span class="token punctuation">.</span><span class="token function">pollInterval</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">)</span>      <span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">getPostEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token function">getPostEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="asyncqueuelistener"><a class="markdownIt-Anchor" href="#asyncqueuelistener"></a> AsyncQueueListener</h3><p><code>AsyncQueueListener</code>&nbsp;å®ç°äº†&nbsp;<code>EventListenerPlugin</code>&nbsp;æ¥å£ï¼Œç”¨äºå¼‚æ­¥åœ°æ¥æ”¶å¹¶åˆ†å‘äº‹ä»¶ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨ä¸€ä¸ªé˜»å¡é˜Ÿåˆ—ï¼ˆ<code>BlockingQueue&lt;BaseEvent&gt;</code>ï¼‰ç¼“å­˜äº‹ä»¶ï¼Œå†ç”±ä¸€ä¸ªä¸“é—¨çš„çº¿ç¨‹ï¼ˆ<code>asyncProcessor</code>ï¼‰ä¸åœåœ°ä»é˜Ÿåˆ—ä¸­å–å‡ºäº‹ä»¶ï¼Œå¹¶æŠŠè¿™äº›äº‹ä»¶åˆ†å‘ç»™æ‰€æœ‰çœŸå®çš„ç›‘å¬å™¨ã€‚è¿™ç§æ–¹å¼çš„å¥½å¤„åœ¨äºèƒ½å¤Ÿè§£è€¦äº‹ä»¶çš„äº§ç”Ÿå’Œäº‹ä»¶çš„å¤„ç†ï¼Œå®ç°å¼‚æ­¥åˆ†å‘ï¼Œæå‡ç³»ç»Ÿçš„å“åº”èƒ½åŠ›ã€‚</p><p>å…³é”®å­—æ®µ</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// åŸå­æ ‡å¿—ï¼Œè¡¨ç¤ºå¼‚æ­¥ç›‘å¬å™¨æ˜¯å¦å·²ç»åœæ­¢ã€‚</span><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">AtomicBoolean</span> stoppedï¼š<span class="token comment">// ç”¨äºè®°å½•é˜Ÿåˆ—å› æ»¡æˆ–è€…å…¶ä»–åŸå› è€Œä¸¢å¼ƒçš„äº‹ä»¶æ•°é‡ã€‚</span><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">AtomicLong</span> dropEventCounters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicLong</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">AtomicLong</span> lastDropEventCounters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicLong</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æœ€åä¸€æ¬¡äº‹ä»¶è®°å½•çš„äº‹ä»¶ï¼Œä½¿ç”¨ Instant å¯¹è±¡</span><span class="token keyword">private</span> <span class="token class-name">Instant</span> lastRecordDropEventTime<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>processEvents</code> æ–¹æ³•ç”¨äºå¤„ç†äº‹ä»¶ï¼Œå®ƒçš„æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š</p><ul><li>è¯¥æ–¹æ³•ä½äºæ— é™å¾ªç¯ä¸­ï¼Œä½¿ç”¨&nbsp;<code>queue. take ()</code>&nbsp;é˜»å¡ç­‰å¾…é˜Ÿåˆ—ä¸­æœ‰äº‹ä»¶å¯ä»¥å¤„ç†ã€‚</li><li>åˆ¤æ–­å–å‡ºçš„äº‹ä»¶æ˜¯ PreEvent æˆ– PostEventï¼Œå¹¶åˆ†åˆ«è°ƒç”¨æ‰€æœ‰ç›‘å¬å™¨å¯¹åº”çš„&nbsp;<code>onPreEvent</code>&nbsp;æˆ–&nbsp;<code>onPostEvent</code>&nbsp;æ–¹æ³•ã€‚</li><li>åœ¨å¤„ç†è¿‡ç¨‹ä¸­æ•è·&nbsp;<code>InterruptedException</code>ï¼ˆçº¿ç¨‹è¢«ä¸­æ–­æ—¶é€€å‡ºå¾ªç¯ï¼‰ä»¥åŠå…¶ä»–å¼‚å¸¸ï¼Œå¹¶è®°å½•æ—¥å¿—ä¿¡æ¯ã€‚</li></ul><h2 id="æ”¹è¿›"><a class="markdownIt-Anchor" href="#æ”¹è¿›"></a> æ”¹è¿›</h2><h3 id="event-å®ç°å¢å¼º"><a class="markdownIt-Anchor" href="#event-å®ç°å¢å¼º"></a> Event å®ç°å¢å¼º</h3><p>ä½¿ç”¨ <code>instanceOf</code> è¿›è¡Œåˆ†æ”¯åˆ¤æ–­è¿™ç§å®ç°éå¸¸çš„ç³Ÿç³•ï¼Œå…·ä½“æ¥è¯´</p><ul><li>å½“å‰å®ç°å¯¹æ”¯æŒçš„äº‹ä»¶ç±»å‹è¿›è¡Œç¡¬ç¼–ç ã€‚æ¯å½“æ·»åŠ ä¸€ä¸ªæ–°çš„äº‹ä»¶ç±»å‹ï¼ˆä¾‹å¦‚ï¼ŒFailureEventã€AuditEventï¼‰æ—¶ï¼Œéƒ½å¿…é¡»ä¿®æ”¹ <code>dispatchEvent</code> æ–¹æ³•ã€‚</li><li>å¦‚æœäº‹ä»¶ç±»å‹çš„æ•°é‡åœ¨æœªæ¥å¢åŠ æˆ–å˜å¾—æ›´ç»†ç²’åº¦ï¼Œå¾ˆå®¹æ˜“é”™è¿‡å¤„ç†æŸäº›åˆ†æ”¯;</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dispatchEvent</span><span class="token punctuation">(</span><span class="token class-name">BaseEvent</span> baseEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>baseEvent <span class="token keyword">instanceof</span> <span class="token class-name">PreEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token function">dispatchPreEvent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">PreEvent</span><span class="token punctuation">)</span> baseEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>baseEvent <span class="token keyword">instanceof</span> <span class="token class-name">Event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token function">dispatchPostEvent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Event</span><span class="token punctuation">)</span> baseEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"Unknown event type:"</span> <span class="token operator">+</span> baseEvent<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€ä¸ªæ›´å¥½çš„å®ç°åº”å…·å¤‡å¦‚ä¸‹ç‰¹ç‚¹</p><ul><li>ç±»å‹å®‰å…¨ï¼šæ¶ˆé™¤ <code>instanceof</code> æ£€æŸ¥ï¼Œæ‰€æœ‰çš„é—®é¢˜éƒ½ä¼šåœ¨ç¼–è¯‘æœŸæš´éœ²ï¼›</li><li>è§£è€¦ï¼šäº‹ä»¶åªè´Ÿè´£è°ƒç”¨ <code>accept</code> æ–¹æ³•ï¼Œä¸å…³å¿ƒç›‘å¬å™¨çš„å®ç°ï¼›</li><li>å¼ºå°è£…ï¼šé€šè¿‡é™åˆ¶å¯¹è®¿é—®è€…æ–¹æ³•çš„ç›´æ¥è®¿é—®ï¼Œé˜²æ­¢å¤–éƒ¨è¯¯ç”¨ï¼›</li><li>æ‰©å±•æ€§ï¼šæ·»åŠ æ–°çš„äº‹ä»¶ç±»å‹åªéœ€è¦åˆ›å»ºæ–°çš„ç±»å’Œ <code>visitXXX ()</code> æ–¹æ³•ï¼Œè€Œæ— éœ€ä¿®æ”¹åˆ†å‘é€»è¾‘ï¼›</li></ul><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/20250530130950.png" alt="EventDispatcherç±»å›¾"></p><p>ä¸ºäº†é™åˆ¶å¤–éƒ¨å¯¹è®¿é—®è€…æ–¹æ³•çš„ç›´æ¥è®¿é—®ï¼Œå› æ­¤ä½¿ç”¨ä¸€ä¸ªå†…éƒ¨é™æ€ç±»æ¥å®ç° <code>EventDispatcher</code> æ¥å£ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">InternalVisitor</span> <span class="token keyword">implements</span> <span class="token class-name">EventDispatcher</span> <span class="token punctuation">{</span>    <span class="token comment">/** {@inheritDoc} */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dispatchPreEvent</span><span class="token punctuation">(</span><span class="token class-name">PreEvent</span> event<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ForbiddenException</span> <span class="token punctuation">{</span>      eventListeners<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>eventListener <span class="token operator">-&gt;</span> eventListener<span class="token punctuation">.</span><span class="token function">onPreEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/** {@inheritDoc} */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dispatchPostEvent</span><span class="token punctuation">(</span><span class="token class-name">Event</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>      eventListeners<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>eventListener <span class="token operator">-&gt;</span> eventListener<span class="token punctuation">.</span><span class="token function">onPostEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»è¿‡æ”¹é€ ï¼ŒEventBus çš„ <code>dispatchEvent</code> æ–¹æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dispatchEvent</span><span class="token punctuation">(</span><span class="token class-name">BaseEvent</span> baseEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>    baseEvent<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>internalVisitor<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ®ç»„ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Gravitino </tag>
            
            <tag> å…ƒæ•°æ® </tag>
            
            <tag> ç»Ÿä¸€å…ƒæ•°æ® </tag>
            
            <tag> AI Infra </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RESTful æ¶æ„</title>
      <link href="/2025/03/24/computer/2025-03-24-restful-api/"/>
      <url>/2025/03/24/computer/2025-03-24-restful-api/</url>
      
        <content type="html"><![CDATA[<h2 id="å®šä¹‰"><a class="markdownIt-Anchor" href="#å®šä¹‰"></a> å®šä¹‰</h2><p>REST (Representational State Transfer)ï¼Œä¸­æ–‡æ„æ€æ˜¯ï¼šè¡¨è¿°æ€§çŠ¶æ€è½¬ç§»ã€‚å³ä¸€ç»„æ¶æ„çº¦æŸæ¡ä»¶å’ŒåŸåˆ™ï¼Œå¦‚æœä¸€ä¸ªæ¶æ„ç¬¦åˆ REST çš„çº¦æŸæ¡ä»¶å’ŒåŸåˆ™ï¼Œæˆ‘ä»¬å°±ç§°å®ƒä¸º RESTful æ¶æ„ã€‚</p><ol><li>åœ¨ REST ä¸­ï¼Œä¸€åˆ‡çš„å†…å®¹éƒ½è¢«è®¤ä¸ºæ˜¯ä¸€ç§èµ„æº</li><li>æ¯ä¸ªèµ„æºéƒ½ç”± URI å”¯ä¸€æ ‡è¯†</li><li>ä½¿ç”¨ç»Ÿä¸€çš„æ¥å£å¤„ç†èµ„æºè¯·æ±‚ï¼ˆPOST/GET/PUT/DELETE/HEADï¼‰</li><li>æ— çŠ¶æ€ï¼ˆæ¯æ¬¡è¯·æ±‚ä¹‹å‰æ˜¯æ— å…³è”ï¼Œæ²¡æœ‰ session ï¼‰</li></ol><p>REST å¯ä»¥ç†è§£ä¸º Client å’Œ Server ä¹‹é—´çš„ä¸€ç§äº¤äº’æ–¹å¼ï¼Œå³ Client å‘å‡º HTTP è¯·æ±‚ï¼ŒServer ç«¯çš„èµ„æºå‘ç”ŸçŠ¶æ€è½¬ç§»ï¼Œä¾‹å¦‚æ›´æ–°ã€åˆ é™¤ç­‰ã€‚è€Œ RESTful API åˆ™å¯ä»¥ç†è§£ä¸º Server ç«¯æä¾›å…·æœ‰ REST é£æ ¼çš„æ¥å£ã€‚</p><p>ç¬¦åˆ REST è§„èŒƒçš„æœåŠ¡ä¸åº”è¯¥ä¿å­˜å®¢æˆ·ç«¯çŠ¶æ€ä¹Ÿä¸ä¼šä¿å­˜åº”ç”¨çš„çŠ¶æ€ã€‚</p><h3 id="èµ„æºå’Œ-uri"><a class="markdownIt-Anchor" href="#èµ„æºå’Œ-uri"></a> èµ„æºå’Œ URI</h3><ol><li>ä½¿ç”¨&nbsp;<code>/</code>&nbsp;æ¥è¡¨ç¤ºèµ„æºçš„å±‚çº§å…³ç³»</li><li>ä½¿ç”¨&nbsp;<code>?</code>&nbsp;ç”¨æ¥è¿‡æ»¤èµ„æº</li><li>ä½¿ç”¨&nbsp;<code>_</code>&nbsp;æˆ–è€…&nbsp;<code>-</code>&nbsp;è®© URI çš„å¯è¯»æ€§æ›´å¥½</li><li><code>,</code>&nbsp;æˆ–&nbsp;<code>;</code>&nbsp;å¯ä»¥ç”¨æ¥è¡¨ç¤ºåŒçº§èµ„æºçš„å…³ç³»</li></ol><h3 id="ç»Ÿä¸€èµ„æºæ¥å£"><a class="markdownIt-Anchor" href="#ç»Ÿä¸€èµ„æºæ¥å£"></a> ç»Ÿä¸€èµ„æºæ¥å£</h3><table><thead><tr><th>è¯·æ±‚æ–¹æ³•</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td>è·å–æŸä¸ªèµ„æºã€‚å¹‚ç­‰ï¼ˆå–å¤šå°‘æ¬¡ç»“æœéƒ½æ²¡æœ‰å˜åŒ–ï¼‰</td></tr><tr><td>POST</td><td>åˆ›å»ºä¸€ä¸ªæ–°çš„èµ„æº</td></tr><tr><td>PUT</td><td>æ›¿æ¢æŸä¸ªå·²æœ‰çš„èµ„æºï¼ˆæ›´æ–°æ“ä½œï¼‰ ï¼Œå¹‚ç­‰ï¼ˆæ›´æ–°å¤šæ¬¡åªä¿å­˜ä¸€ä¸ªç»“æœï¼‰</td></tr><tr><td>DELETE</td><td>åˆ é™¤æŸä¸ªèµ„æº</td></tr><tr><td>HEAD</td><td>ä¸»è¦ç”¨äºç¡®è®¤ URL çš„æœ‰æ•ˆæ€§ä»¥åŠèµ„æºæ›´æ–°çš„æ—¥æœŸæ—¶é—´ç­‰</td></tr><tr><td>PATCH</td><td>æ–°å¼•å…¥çš„ï¼Œå¯¹ PUT æ–¹æ³•çš„è¡¥å……ï¼Œç”¨æ¥å¯¹å·²çŸ¥èµ„æºè¿›è¡Œå±€éƒ¨æ›´æ–°</td></tr></tbody></table><h3 id="èµ„æºè¡¨è¿°"><a class="markdownIt-Anchor" href="#èµ„æºè¡¨è¿°"></a> èµ„æºè¡¨è¿°</h3><p>å®¢æˆ·ç«¯é€šè¿‡ HTTP æ–¹æ³•å¯ä»¥è·å–èµ„æºï¼Œç¡®åˆ‡çš„æ¥è¯´ï¼Œå®¢æˆ·ç«¯è·å–çš„åªæ˜¯èµ„æºçš„è¡¨è¿°è€Œå·²ï¼Œä¼ è¾“çš„ä¸æ˜¯èµ„æºæœ¬èº«ã€‚èµ„æºçš„è¡¨è¿°åŒ…æ‹¬æ•°æ®å’Œæè¿°æ•°æ®çš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚ï¼ŒHTTP å¤´ â€œContent-Typeâ€ å°±æ˜¯è¿™æ ·ä¸€ä¸ªå…ƒæ•°æ®å±æ€§ã€‚å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ <code>Accept</code> å¤´è¯·æ±‚ä¸€ç§ç‰¹å®šæ ¼å¼çš„è¡¨è¿°ï¼ŒæœåŠ¡ç«¯åˆ™é€šè¿‡ <code>Content-Type</code> å‘Šè¯‰å®¢æˆ·ç«¯èµ„æºçš„è¡¨è¿°å½¢å¼ã€‚</p><h2 id="å®è·µ"><a class="markdownIt-Anchor" href="#å®è·µ"></a> å®è·µ</h2><ol><li>å°† API éƒ¨ç½²åœ¨ä¸“ç”¨åŸŸåä¹‹ä¸‹ï¼›</li><li>å°† API çš„ç‰ˆæœ¬å·æ”¾å…¥ URLï¼›</li><li>åœ¨ RESTful æ¶æ„ä¸­ï¼Œæ¯ä¸ªç½‘å€ä»£è¡¨ä¸€ç§èµ„æºï¼ˆresourceï¼‰ï¼Œæ‰€ä»¥ç½‘å€ä¸­ä¸èƒ½æœ‰åŠ¨è¯ï¼Œåªèƒ½æœ‰åè¯ï¼Œè€Œä¸”æ‰€ç”¨çš„åè¯å¾€å¾€ä¸æ•°æ®åº“çš„è¡¨æ ¼åå¯¹åº”ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ•°æ®åº“ä¸­çš„è¡¨éƒ½æ˜¯åŒç§è®°å½•çš„ â€é›†åˆâ€ï¼ˆcollectionï¼‰ï¼Œæ‰€ä»¥ API ä¸­çš„åè¯ä¹Ÿåº”è¯¥ä½¿ç”¨å¤æ•°ã€‚</li><li>å¦‚æœè®°å½•æ•°é‡å¾ˆå¤šï¼ŒæœåŠ¡å™¨ä¸å¯èƒ½éƒ½å°†å®ƒä»¬è¿”å›ç»™ç”¨æˆ·ã€‚API åº”è¯¥æä¾›å‚æ•°ï¼Œè¿‡æ»¤è¿”å›ç»“æœ</li><li>æœåŠ¡å™¨å‘ç”¨æˆ·è¿”å›çš„çŠ¶æ€ç å’Œæç¤ºä¿¡æ¯</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://api.douban.com/v2/book/:id <span class="token punctuation">(</span>è·å–å›¾ä¹¦ä¿¡æ¯<span class="token punctuation">)</span>http://api.douban.com/v2/movie/subject/:id <span class="token punctuation">(</span>ç”µå½±æ¡ç›®ä¿¡æ¯<span class="token punctuation">)</span>http://api.douban.com/v2/music/:id <span class="token punctuation">(</span>è·å–éŸ³ä¹ä¿¡æ¯<span class="token punctuation">)</span>http://api.douban.com/v2/event/:id <span class="token punctuation">(</span>è·å–åŒåŸæ´»åŠ¨<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºæŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—æœºåŸºç¡€ </tag>
            
            <tag> RESTæ¶æ„ </tag>
            
            <tag> HTTPåè®® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‚æ•°è¡¨ç¤ºæ–¹æ³•åŠè¯­æ³•çº¦å®š</title>
      <link href="/2025/03/24/computer/2025-03-24-arguments-signature/"/>
      <url>/2025/03/24/computer/2025-03-24-arguments-signature/</url>
      
        <content type="html"><![CDATA[<h2 id="è¡¨ç¤ºæ–¹æ³•"><a class="markdownIt-Anchor" href="#è¡¨ç¤ºæ–¹æ³•"></a> è¡¨ç¤ºæ–¹æ³•</h2><ol><li><code>[ ]</code>ï¼š è¡¨ç¤º<strong>å¯é€‰å‚æ•°</strong>ï¼Œä½¿ç”¨æ—¶å¯ä»¥çœç•¥</li><li><code>&lt; &gt;</code>ï¼š è¡¨ç¤º<strong>å¿…é€‰å‚æ•°</strong>ï¼Œå¿…é¡»æä¾›å…·ä½“å€¼</li><li><code>{ }</code>ï¼š è¡¨ç¤º<strong>é€‰æ‹©æ€§å‚æ•°</strong>ï¼Œéœ€ä»ä¸­é€‰æ‹©ä¸€ä¸ªé€‰é¡¹ï¼Œé€šå¸¸ä¸&nbsp;<code>|</code>&nbsp;ä¸€èµ·ä½¿ç”¨</li><li><code>( )</code>ï¼š è¡¨ç¤º<strong>é»˜è®¤å‚æ•°</strong>å€¼</li><li><code>|</code>ï¼š è¡¨ç¤º<strong>äº’æ–¥é€‰é¡¹</strong>ï¼Œåªèƒ½é€‰æ‹©å…¶ä¸­ä¸€ä¸ª</li><li><code>â€¦</code>ï¼š è¡¨ç¤º<strong>å¯é‡å¤çš„å‰é¡¹</strong>ï¼Œå…è®¸å¤šæ¬¡ä½¿ç”¨å‰é¢çš„å‚æ•°</li><li><code>--</code>ï¼š é€šå¸¸è¡¨ç¤º<strong>é•¿é€‰é¡¹åç§°</strong>ï¼ˆå¦‚&nbsp;<code>--help</code>ï¼‰</li><li><code>-</code>ï¼šé€šå¸¸è¡¨ç¤º<strong>çŸ­é€‰é¡¹</strong>ï¼ˆå¦‚&nbsp;<code>-h</code>ï¼‰</li></ol><h2 id="ç‰¹æ®Šè¡¨ç¤ºæ–¹æ³•"><a class="markdownIt-Anchor" href="#ç‰¹æ®Šè¡¨ç¤ºæ–¹æ³•"></a> ç‰¹æ®Šè¡¨ç¤ºæ–¹æ³•</h2><ul><li><strong>ç²—ä½“</strong>ï¼š è¡¨ç¤ºå¿…é¡»æŒ‰åŸæ ·é”®å…¥çš„å‘½ä»¤æˆ–å…³é”®å­—ï¼›</li><li><strong>å ä½ç¬¦</strong>ï¼š<code>$VAR</code> æˆ–è€… <code>%VAR%</code> è¡¨ç¤ºç¯å¢ƒå˜é‡æˆ–è€…éœ€è¦æ›¿æ¢çš„å€¼ã€‚</li></ul><h2 id="ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#ç¤ºä¾‹"></a> ç¤ºä¾‹</h2><h3 id="å‘½ä»¤è¡Œå·¥å…·-cli"><a class="markdownIt-Anchor" href="#å‘½ä»¤è¡Œå·¥å…·-cli"></a> å‘½ä»¤è¡Œå·¥å…· (CLI)</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Linux/Unix man é¡µé¢é£æ ¼</span><span class="token builtin class-name">command</span> <span class="token punctuation">[</span>-a<span class="token punctuation">]</span> <span class="token punctuation">[</span>-b value<span class="token punctuation">]</span> file<span class="token punctuation">..</span>.<span class="token comment"># å¤šå±‚åµŒå¥—è¡¨ç¤º</span><span class="token function">git</span> checkout <span class="token punctuation">[</span>-q<span class="token punctuation">]</span> <span class="token punctuation">[</span>-f<span class="token punctuation">]</span> <span class="token punctuation">[</span>-m<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>branch<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token function">git</span> checkout <span class="token punctuation">[</span>-q<span class="token punctuation">]</span> <span class="token punctuation">[</span>-f<span class="token punctuation">]</span> <span class="token punctuation">[</span>-m<span class="token punctuation">]</span> <span class="token parameter variable">--detach</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>branch<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token function">git</span> checkout <span class="token punctuation">[</span>-q<span class="token punctuation">]</span> <span class="token punctuation">[</span>-f<span class="token punctuation">]</span> <span class="token punctuation">[</span>-m<span class="token punctuation">]</span> <span class="token punctuation">[</span>--detach<span class="token punctuation">]</span> <span class="token operator">&lt;</span>commit<span class="token operator">&gt;</span><span class="token comment"># GNU é£æ ¼</span>program <span class="token punctuation">[</span>OPTION<span class="token punctuation">]</span><span class="token punctuation">..</span>. <span class="token punctuation">[</span>FILE<span class="token punctuation">]</span><span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="sql-ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#sql-ç¤ºä¾‹"></a> SQL ç¤ºä¾‹</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">case</span> <span class="token operator">&lt;</span>col<span class="token operator">&gt;</span>  <span class="token keyword">when</span> <span class="token operator">&lt;</span>v<span class="token operator">&gt;</span> <span class="token keyword">then</span> <span class="token operator">&lt;</span>answer<span class="token operator">&gt;</span><span class="token punctuation">,</span>  <span class="token punctuation">[</span><span class="token keyword">when</span> <span class="token operator">&lt;</span>v<span class="token operator">&gt;</span> <span class="token keyword">then</span> <span class="token operator">&lt;</span>answer<span class="token operator">&gt;</span><span class="token punctuation">,</span><span class="token punctuation">]</span>  <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>  <span class="token punctuation">[</span><span class="token keyword">else</span> {answer}<span class="token punctuation">]</span><span class="token keyword">END</span> <span class="token punctuation">[</span><span class="token keyword">as</span> alis<span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="git-ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#git-ç¤ºä¾‹"></a> Git ç¤ºä¾‹</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> remote <span class="token function">add</span> <span class="token punctuation">[</span>-t <span class="token operator">&lt;</span>branch<span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>-m <span class="token operator">&lt;</span>master<span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>-f<span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token punctuation">[</span>no-<span class="token punctuation">]</span>tags<span class="token punctuation">]</span> <span class="token punctuation">[</span>--mirror<span class="token operator">=</span><span class="token operator">&lt;</span>fetch<span class="token operator">|</span>push<span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>url<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºæŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—æœºåŸºç¡€ </tag>
            
            <tag> æŠ€æœ¯æ–‡æ¡£å†™ä½œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2025-03-20 å°è®°</title>
      <link href="/2025/03/20/diarly/2025-03-20-diary/"/>
      <url>/2025/03/20/diarly/2025-03-20-diary/</url>
      
        <content type="html"><![CDATA[<h2 id="2025-03-20-å°è®°"><a class="markdownIt-Anchor" href="#2025-03-20-å°è®°"></a> 2025-03-20 å°è®°</h2><ul><li>å¿ƒæƒ…: ğŸŸ¡</li><li>å¤©æ°”: â˜€ï¸</li></ul><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/20250321102250.png" alt="ç¹æ˜Ÿå…"></p><p>ä¸ç‹—ç‹—ä¸€åŒå‰å¾€ä¸‰å…ƒæ¡¥é™„è¿‘çš„VTDå©šç¤¼è‰ºæœ¯ä¸­å¿ƒå‚è§‚ã€‚è¯¥ä¸­å¿ƒè®¾æœ‰ä¸¤ä¸ªå®´ä¼šå…ï¼šä¸€ä¸ªé‡‡ç”¨é‡‘è‰²ç³»æ‰“é€ çš„å®«å»·é£æ ¼å…ï¼ˆç¹æ˜Ÿå…ï¼‰ï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯ä»¥ç²‰è‰²ä¸ºä¸»çš„å¯çˆ±é£æ ¼å…ï¼ˆæ˜Ÿå®‡å…ï¼‰ã€‚ç»è¿‡è€ƒå¯Ÿï¼Œæˆ‘è®¤ä¸ºè¿™å®¶åœºåœ°å¹¶æ— ç‰¹åˆ«å‡ºè‰²ä¹‹å¤„ï¼Œåè€Œå­˜åœ¨å‡ ä¸ªæ˜æ˜¾çš„ä¸è¶³ï¼š</p><ol><li>æ²¡æœ‰å›­åŒºï¼šå…¥å£ç›´æ¥é¢å‘ç¹å¿™é©¬è·¯ï¼Œç»™äººæ‚ä¹±çš„ç¬¬ä¸€å°è±¡ï¼›</li><li>é€‰æ‹©æœ‰é™ï¼šç›®å‰ä»…æœ‰ä¸¤ä¸ªå…å¯ä¾›ä½¿ç”¨ï¼Œå¦å¤–ä¸¤ä¸ªå®´ä¼šå…å°šå¤„äºé¢„å”®é˜¶æ®µï¼›</li><li>è£…é¥°ç®€é™‹ï¼šä¸»å¤§å…è™½ç„¶å®½æ•ä½†è£…é¥°å…ƒç´ åŒ®ä¹ï¼Œæ•´ä½“æ°›å›´å†·æ¸…ï¼›</li><li>ä»·æ ¼åé«˜ï¼šä¸å…¶ä»–åŒç±»åœºæ‰€ï¼ˆå¦‚æ ¼ä¹åˆ©é›…ã€èŠ±å«ä¸½èˆã€ç¹æ™¯è‰ºæœ¯ä¸­å¿ƒï¼‰ç›¸æ¯”ï¼Œæ”¶è´¹æ›´é«˜å´æœªèƒ½æä¾›ç›¸åº”å“è´¨çš„é¤é¥®æœåŠ¡ï¼›</li><li>é”€å”®æœåŠ¡æ¬ ä½³ï¼šé”€å”®äººå‘˜ä¸ä»…è¿Ÿåˆ°ï¼Œä¸”æ€åº¦ç¼ºä¹è¯šæ„ï¼›</li><li>åœºåœ°æ”¹é€ ç—•è¿¹æ˜æ˜¾ï¼šåœºåœ°å¹¶éåŸç”Ÿå©šå®´è®¾è®¡ï¼Œå¾ˆå®¹æ˜“å¯Ÿè§‰åˆ°è¿™é‡Œä¹‹å‰æ˜¯å·¥å‚æ”¹å»ºè€Œæˆã€‚</li></ol><p>ç»¼åˆä»·æ ¼ä¸æœåŠ¡å› ç´ è€ƒé‡ï¼Œæˆ‘ä¸ä¼šå°†æ­¤å¤„åˆ—å…¥å¤‡é€‰åå•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ—¥è®°éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> diary </tag>
            
            <tag> ç”Ÿæ´» </tag>
            
            <tag> å¤‡å©šæ—¥è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºšæ´²ç–¾ç—…é—®é¢˜</title>
      <link href="/2025/03/19/qu-wen/2025-03-19-asian-illness/"/>
      <url>/2025/03/19/qu-wen/2025-03-19-asian-illness/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a class="markdownIt-Anchor" href="#æ¦‚è¿°"></a> æ¦‚è¿°</h2><p>ä¸¤ä¸ªç»æµå­¦å®¶å¡æ‹‰æ›¼å’Œç‰¹æ²ƒæ–¯åŸºäº 1981 å¹´è¿›è¡Œäº†äºšæ´²ç–¾ç—…é—®é¢˜ï¼Œæœ‰ä¸€ç§ç–¾ç—…å¦‚æœä¸è¿›è¡Œæ²»ç–—ï¼Œæ¯å¤©æ­» 600 äººï¼Œç°æœ‰ä¸¤ç§ç–—æ³•ï¼š</p><ul><li>ç–—æ³• Aï¼š600 äººä¸­ 200 äººç”Ÿè¿˜ï¼›1</li><li>ç–—æ³• Bï¼šæœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>3</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> çš„æ¦‚ç‡ 600 äººéƒ½å­˜æ´»ï¼Œæœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>2</mn><mn>3</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{2}{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> çš„æ¦‚ç‡æ— äººç”Ÿè¿˜ï¼›</li></ul><p>åšå¦‚ä¸‹å®éªŒï¼š</p><ul><li>å®éªŒ 1ï¼šè·Ÿè¢«å®éªŒä¸ªä½“å°†ç–—æ³• A å’Œ B åŸå°ä¸åŠ¨çš„è¯´å‡ºæ¥ï¼›</li><li>å®éªŒ 2ï¼šé’ˆå¯¹ç–—æ³• A å’Œ Bï¼Œé‡æ–°æ›´æ”¹å™è¿°<ul><li>Aï¼šä¼šæœ‰ 400 äººæ­»å»ï¼›</li><li>Bï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>3</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> çš„æ¦‚ç‡æ— äººæ­»å»ï¼Œæœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>2</mn><mn>3</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{2}{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> çš„æ¦‚ç‡æ— äººç”Ÿè¿˜ï¼›</li></ul></li></ul><p>å®éªŒç»“æœå¦‚ä¸‹ï¼š</p><ul><li>å®éªŒ 1 æœ‰ 152 äººå‚ä¸ï¼Œ<strong>72%çš„äººé€‰æ‹©ç–—æ³• A</strong>ï¼Œ28%çš„äººé€‰æ‹©ç–—æ³• Bï¼›</li><li>å®éªŒ 2 æœ‰ 155 äººå‚ä¸ï¼Œ22%çš„äººé€‰æ‹©ç–—æ³• Aï¼Œ<strong>78%çš„äººé€‰æ‹©ç–—æ³• B</strong>ï¼›</li></ul><p>å®éªŒç»“æœè¯æ˜ï¼š</p><ul><li>åœ¨æœ‰æ”¶ç›Šçš„æƒ…å†µä¸‹äººä»¬æ˜¯<strong>é£é™©åŒæ¶</strong>çš„ï¼›</li><li>åœ¨ç¡®å®šæŸå¤±çš„æƒ…å†µä¸‹äººä»¬æ˜¯<strong>é£é™©åå¥½</strong>çš„ï¼›</li></ul><h2 id="æ¡†æ¶æ•ˆåº”"><a class="markdownIt-Anchor" href="#æ¡†æ¶æ•ˆåº”"></a> æ¡†æ¶æ•ˆåº”</h2><ol><li>é£é™©é€‰æ‹©æ¡†æ¶<ul><li>åœ¨æœ‰æ”¶ç›Šçš„æƒ…å†µä¸‹äººä»¬æ˜¯<strong>é£é™©åŒæ¶</strong>çš„ï¼›</li><li>åœ¨ç¡®å®šæŸå¤±çš„æƒ…å†µä¸‹äººä»¬æ˜¯<strong>é£é™©åå¥½</strong>çš„ï¼›</li></ul></li><li>ç‰¹æ€§æ¡†æ¶ï¼šäººä»¬å¿ƒä¸­å­˜åœ¨ç§¯ææ¡†æ¶å’Œæ¶ˆææ¡†æ¶ï¼Œå¦‚æœé—®é¢˜ä»¥ç§¯æçš„æ–¹å¼æè¿°çš„æ—¶å€™å°±ä¼šå¼€å¿ƒï¼Œåä¹‹äº¦ç„¶ï¼›</li><li>ç›®çš„æ€§æ¡†æ¶ï¼šä¸ºäº†è¾¾æˆæŸç§ç›®çš„ï¼Œ<strong>å¯¹åŒä¸€ä¸ªé—®é¢˜ä½¿ç”¨ä¸åŒçš„æè¿°äº§ç”Ÿçš„æ•ˆæœæ˜¯ä¸åŒçš„</strong>ï¼›</li></ol><h2 id="ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#ç¤ºä¾‹"></a> ç¤ºä¾‹</h2><table><thead><tr><th></th><th>ç§¯æ</th><th>æ¶ˆæ</th></tr></thead><tbody><tr><td>å–è‚‰</td><td>75%ç˜¦è‚‰</td><td>25%è‚¥è‚‰</td></tr><tr><td>æ‰‹æœ¯</td><td>90%å­˜æ´»ç‡</td><td>10%æ­»äº¡ç‡</td></tr><tr><td>ç®—å‘½</td><td>ä½ æ¯”è¾ƒé•¿å¯¿å•Š</td><td>å®¶äººæ¯”ä½ æ—©æ­»</td></tr><tr><td>åŠ æ²¹</td><td>5.6 å…ƒ/å‡ï¼Œç°é‡‘ç»“è´¦ä¼˜æƒ  0.6 å…ƒã€‚</td><td>5 å…ƒ/å‡ï¼Œä½¿ç”¨ä¿¡ç”¨å¡+0.6 å…ƒ</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> è¶£é—» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¦‚ç‡ </tag>
            
            <tag> Summary </tag>
            
            <tag> psychology </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2025-03-18 å°è®°</title>
      <link href="/2025/03/18/diarly/2025-03-18-diary/"/>
      <url>/2025/03/18/diarly/2025-03-18-diary/</url>
      
        <content type="html"><![CDATA[<h2 id="2025-03-18-å°è®°"><a class="markdownIt-Anchor" href="#2025-03-18-å°è®°"></a> 2025-03-18 å°è®°</h2><ul><li>å¿ƒæƒ…: ğŸŸ¢</li><li>å¤©æ°”: â˜€ï¸</li></ul><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/20250319160753.png" alt="ç’Ÿ*ç©ºé—´"></p><p>ä»Šæ—¥ä¸å°ç‹—å‚è§‚äº†ä¼˜æ‚¦ç¹æ™¯çš„ç’Ÿ*ç©ºé—´å®´ä¼šå…ï¼Œæ•´ä½“å°è±¡ä¸­è§„ä¸­çŸ©ã€‚è¯¥åœºåœ°ç¡®æœ‰å‡ å¤„äº®ç‚¹ï¼š</p><ol><li>ç©ºé—´æ ¼å±€å®½æ•ï¼Œå®´ä¼šå…è¿åŒæˆ·å¤–è‰åªæ€»é¢ç§¯è¾¾2000å¹³æ–¹ç±³ï¼›</li><li>é«˜åº¦è‡ªç”±åº¦ï¼Œå®¤å†…å®´ä¼šå…åŠæˆ·å¤–è‰åªå‡æ”¯æŒä¸ªæ€§åŒ–DIYå¸ƒç½®ï¼›</li><li>é¤æ¡ŒèŠ±è‰ºè®¾è®¡é›…è‡´ç²¾ç¾ï¼Œè§†è§‰æ•ˆæœå‡ºä¼—ã€‚</li></ol><p>ç„¶è€Œï¼Œåœºåœ°ä¹Ÿå­˜åœ¨ä¸€äº›æ˜æ˜¾ä¸è¶³ï¼š</p><ol><li>åœºé¦†å‰é“è·¯çŠ¶å†µæå·®ï¼Œå½±å“æ•´ä½“åˆ°è®¿ä½“éªŒï¼›</li><li>å›­åŒºç¯å¢ƒæ¬ ä½³ï¼Œå‘¨è¾¹å•†å®¶ç±»å‹æ··æ‚ï¼Œç¼ºä¹é«˜ç«¯æ°›å›´ï¼›</li><li>åœ°ç†ä½ç½®è¾ƒä¸ºåè¿œï¼ˆä½äºè‰æˆ¿åœ°åŒºï¼‰ï¼Œäº¤é€šä¾¿åˆ©æ€§ä¸è¶³ï¼›</li><li>åœºåœ°å‘¨è¾¹ä¸€å…¬é‡ŒèŒƒå›´å†…è®¾æœ‰å¤§å‹ç«è‘¬åœºï¼Œä»é£æ°´è§’åº¦è€ƒé‡ç•¥æ˜¾ä¸å¦¥ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> æ—¥è®°éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> diary </tag>
            
            <tag> ç”Ÿæ´» </tag>
            
            <tag> å¤‡å©šæ—¥è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ´›å¸Œæé™</title>
      <link href="/2025/03/18/qu-wen/2025-03-18-roche-limit/"/>
      <url>/2025/03/18/qu-wen/2025-03-18-roche-limit/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a class="markdownIt-Anchor" href="#æ¦‚è¿°"></a> æ¦‚è¿°</h2><p>ä¼ ç»Ÿæƒ¯æ€§å‚è€ƒç³»ï¼šä¼ ç»Ÿè§‚ç‚¹è®¤ä¸º<strong>é™æ­¢æˆ–è€…åŒ€é€Ÿç›´çº¿è¿åŠ¨</strong>çš„å‚è€ƒç³»æˆ–è€…<strong>ç‰›é¡¿ç¬¬ä¸€å®šå¾‹æˆç«‹</strong>çš„å‚è€ƒç³»ã€‚<br>å¹¿ä¹‰æƒ¯æ€§ç³»ï¼šåœ¨ä¸€ä¸ªå¼•åŠ›åœºä¸­åšè‡ªç”±è¿åŠ¨ä¸”ä¸æ—‹è½¬çš„å‚è€ƒç³»æ˜¯æƒ¯æ€§å‚è€ƒç³»ã€‚<br>æƒ¯æ€§åŠ›ï¼šé€Ÿå‚è€ƒç³»ä¸­åº”ç”¨ç‰›é¡¿å®šå¾‹æ‰€äº§ç”Ÿçš„ä¸€ä¸ªè™šæ‹ŸåŠ›ï¼ŒæŒ‡çš„æ˜¯ç‰©ä½“æ‰€å—çš„è™šæ‹ŸåŠ›ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><p>åœ¨ä¸€ä¸ªåŠ é€Ÿè¿åŠ¨çš„ç«è½¦ä¸Šçš„äººã€‚</p><ul><li>åœ°é¢å‚è€ƒç³»ï¼šè½¦åœæ­¢åˆ™äººåœæ­¢ï¼›</li><li>ç«è½¦å‚è€ƒç³»ï¼šå­˜åœ¨æƒ¯æ€§åŠ›ï¼Œå¤§å° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mi>m</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">F=ma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">a</span></span></span></span> ï¼Œæ–¹å‘å’Œç«è½¦æ–¹å‘ç›¸åï¼›</li></ul><h2 id="æ½®æ±åŠ›"><a class="markdownIt-Anchor" href="#æ½®æ±åŠ›"></a> æ½®æ±åŠ›</h2><p>æ½®æ±åŠ›æ˜¯ç”±äºä¸€ä¸ªå¤©ä½“ï¼ˆå¦‚æœˆçƒæˆ–å¤ªé˜³ï¼‰å¯¹å¦ä¸€ä¸ªå¤©ä½“ï¼ˆå¦‚åœ°çƒï¼‰ä¸åŒéƒ¨ä½çš„å¼•åŠ›å·®å¼‚è€Œäº§ç”Ÿçš„åŠ›ã€‚è¿™ç§åŠ›å¯¼è‡´äº†æµ·æ´‹æ½®æ±ç­‰ç°è±¡ã€‚<br><strong>åœºæ™¯</strong></p><p>åœ°çƒè¢«æœ¨æ˜Ÿå¸å¼•ï¼Œæè¿°åœ¨åœ°çƒä¸Šçš„ä¸ªäººå—åŠ›ï¼›<br><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/%E6%B4%9B%E5%B8%8C%E6%9E%81%E9%99%90_image_1.png" alt="å—åŠ›åˆ†æ"></p><p>ä¸€ä¸ªäººçš„å—åŠ›ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mtext>åœ°çƒä¸‡æœ‰å¼•åŠ›</mtext><mo>+</mo><mtext>æœ¨æ˜Ÿä¸‡æœ‰å¼•åŠ›</mtext><mo>+</mo><mtext>æƒ¯æ€§åŠ›</mtext></mrow><annotation encoding="application/x-tex">F=åœ°çƒä¸‡æœ‰å¼•åŠ›+æœ¨æ˜Ÿä¸‡æœ‰å¼•åŠ›+æƒ¯æ€§åŠ›</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord cjk_fallback">åœ°</span><span class="mord cjk_fallback">çƒ</span><span class="mord cjk_fallback">ä¸‡</span><span class="mord cjk_fallback">æœ‰</span><span class="mord cjk_fallback">å¼•</span><span class="mord cjk_fallback">åŠ›</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord cjk_fallback">æœ¨</span><span class="mord cjk_fallback">æ˜Ÿ</span><span class="mord cjk_fallback">ä¸‡</span><span class="mord cjk_fallback">æœ‰</span><span class="mord cjk_fallback">å¼•</span><span class="mord cjk_fallback">åŠ›</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">æƒ¯</span><span class="mord cjk_fallback">æ€§</span><span class="mord cjk_fallback">åŠ›</span></span></span></span> ï¼›<br>æ½®æ±åŠ›å¤§å°ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mtext>æœ¨æ˜Ÿä¸‡æœ‰å¼•åŠ›</mtext><mo>+</mo><mtext>æƒ¯æ€§åŠ›</mtext></mrow><annotation encoding="application/x-tex">F=æœ¨æ˜Ÿä¸‡æœ‰å¼•åŠ›+æƒ¯æ€§åŠ›</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord cjk_fallback">æœ¨</span><span class="mord cjk_fallback">æ˜Ÿ</span><span class="mord cjk_fallback">ä¸‡</span><span class="mord cjk_fallback">æœ‰</span><span class="mord cjk_fallback">å¼•</span><span class="mord cjk_fallback">åŠ›</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">æƒ¯</span><span class="mord cjk_fallback">æ€§</span><span class="mord cjk_fallback">åŠ›</span></span></span></span> ï¼›</p><ul><li>People1ï¼šæœ¨æ˜Ÿå¼•åŠ›&gt;æƒ¯æ€§åŠ›ï¼›</li><li>People2ï¼šæœ¨æ˜Ÿå¼•åŠ›&lt;æƒ¯æ€§åŠ›ï¼›</li></ul><h2 id="æ´›å¸Œæé™"><a class="markdownIt-Anchor" href="#æ´›å¸Œæé™"></a> æ´›å¸Œæé™</h2><p>æ´›å¸Œæé™ï¼š<strong>å½“å°å¤©ä½“æ‰€å—åˆ°çš„æ½®æ±åŠ›=è‡ªèº«çš„å¼•åŠ›æ—¶ï¼Œä¹‹é—´çš„è·ç¦»ç§°ä¹‹ä¸ºæ´›æºªæé™</strong>ã€‚</p><p>åˆšä½“æ´›å¸Œæé™è®¡ç®—å…¬å¼ï¼Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ï</mi><mi>M</mi></msub></mrow><annotation encoding="application/x-tex">\rho_{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">Ï</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä»£è¡¨å¤§å¤©ä½“å¯†åº¦ï¼› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ï</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\rho_{m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">Ï</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä»£è¡¨å°å¤©ä½“å¯†åº¦ï¼› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>M</mi></msub></mrow><annotation encoding="application/x-tex">R_{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä»£è¡¨å¤§å¤©ä½“åŠå¾„ã€‚</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1.26</mn><mo>Ã—</mo><mroot><mfrac><msub><mi>Ï</mi><mi>M</mi></msub><msub><mi>Ï</mi><mi>m</mi></msub></mfrac><mn>3</mn></mroot><mo>Ã—</mo><msub><mi>R</mi><mi>M</mi></msub></mrow><annotation encoding="application/x-tex">r=1.26 \times \sqrt[3]{\frac{\rho_{M}}{\rho_{m}} } \times R_{M}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">2</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.44em;vertical-align:-0.9925650000000004em;"></span><span class="mord sqrt"><span class="root"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5951419999999995em;"><span style="top:-2.7729219999999994em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size6 size1 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4474349999999996em;"><span class="svg-align" style="top:-4.4em;"><span class="pstrut" style="height:4.4em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">Ï</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">Ï</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.407435em;"><span class="pstrut" style="height:4.4em;"></span><span class="hide-tail" style="min-width:1.02em;height:2.48em;"><svg width="400em" height="2.48em" viewBox="0 0 400000 2592" preserveAspectRatio="xMinYMin slice"><path d="M424,2478c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081l0 -0c4,-6.7,10,-10,18,-10 H400000v40H1014.6s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185c-2,6,-10,9,-24,9c-8,0,-12,-0.7,-12,-2z M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9925650000000004em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>æµä½“æ´›å¸Œæé™è®¡ç®—å…¬å¼ï¼Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ï</mi><mi>M</mi></msub></mrow><annotation encoding="application/x-tex">\rho_{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">Ï</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä»£è¡¨å¤§å¤©ä½“å¯†åº¦ï¼› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ï</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\rho_{m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">Ï</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä»£è¡¨å°å¤©ä½“å¯†åº¦ï¼› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>M</mi></msub></mrow><annotation encoding="application/x-tex">R_{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä»£è¡¨å¤§å¤©ä½“åŠå¾„ã€‚</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>r</mi><mo>=</mo><mn>2.44</mn><mo>Ã—</mo><mroot><mfrac><msub><mi>Ï</mi><mi>M</mi></msub><msub><mi>Ï</mi><mi>m</mi></msub></mfrac><mn>3</mn></mroot><mo>Ã—</mo><msub><mi>R</mi><mi>M</mi></msub></mrow><annotation encoding="application/x-tex">r=2.44 \times \sqrt[3]{\frac{\rho_{M}}{\rho_{m}} } \times R_{M}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mord">.</span><span class="mord">4</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.44em;vertical-align:-0.9925650000000004em;"></span><span class="mord sqrt"><span class="root"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5951419999999995em;"><span style="top:-2.7729219999999994em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size6 size1 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4474349999999996em;"><span class="svg-align" style="top:-4.4em;"><span class="pstrut" style="height:4.4em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">Ï</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">Ï</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.407435em;"><span class="pstrut" style="height:4.4em;"></span><span class="hide-tail" style="min-width:1.02em;height:2.48em;"><svg width="400em" height="2.48em" viewBox="0 0 400000 2592" preserveAspectRatio="xMinYMin slice"><path d="M424,2478c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081l0 -0c4,-6.7,10,-10,18,-10 H400000v40H1014.6s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185c-2,6,-10,9,-24,9c-8,0,-12,-0.7,-12,-2z M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9925650000000004em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><h2 id="åº”ç”¨"><a class="markdownIt-Anchor" href="#åº”ç”¨"></a> åº”ç”¨</h2><h3 id="åœŸæ˜Ÿå…‰ç¯"><a class="markdownIt-Anchor" href="#åœŸæ˜Ÿå…‰ç¯"></a> åœŸæ˜Ÿå…‰ç¯</h3><p>åœŸæ˜Ÿå…‰ç¯ï¼šç§‘å­¦å®¶è®¤ä¸ºä¸€é¢—å½—æ˜Ÿè¢«åœŸæ˜Ÿæ½®æ±åŠ›æ’•ç¢äº†ï¼Œå½¢æˆäº†å…‰ç¯ã€‚</p><h3 id="è‹æ¢…å…‹åˆ—ç»´-9-å·"><a class="markdownIt-Anchor" href="#è‹æ¢…å…‹åˆ—ç»´-9-å·"></a> è‹æ¢…å…‹åˆ—ç»´ 9 å·</h3><p>è‹æ¢…å…‹åˆ—ç»´ 9 å·äº 1992 å¹´è¢«æœ¨æ˜Ÿæ½®æ±åŠ›æ’•ç¢ï¼Œ1994 å¹´ä¸æœ¨æ˜Ÿç›¸æ’ã€‚</p><h3 id="æµæµªåœ°çƒ"><a class="markdownIt-Anchor" href="#æµæµªåœ°çƒ"></a> æµæµªåœ°çƒ</h3><p>å‡è®¾åœ°çƒæ˜¯ä¸€ä¸ªåˆšä½“ï¼Œé‚£ä¹ˆä»–çš„æ´›å¸Œæé™æ˜¯<strong>5.6WKM</strong>ï¼Œæ¯”æœ¨æ˜Ÿçš„åŠå¾„<strong>7.15WKM</strong> è¦å°ï¼Œè¿™è¯´æ˜åœ°çƒå¿…é¡»è¿›å…¥æœ¨æ˜Ÿæ‰ä¼šè¢«æ½®æ±åŠ›æ’•ç¢ã€‚å‡å®šåœ°çƒæ˜¯ä¸€ä¸ªæµä½“ï¼Œé‚£ä¹ˆå®ƒçš„æ´›å¸Œæé™æ˜¯<strong>10.9WKM</strong>ã€‚ç”±äºåœ°çƒæ—¢ä¸æ˜¯æµä½“ä¹Ÿä¸æ˜¯åˆšä½“ï¼Œæ‰€ä»¥ä»–å’Œæœ¨æ˜Ÿçš„æ´›å¸Œæé™åº”è¯¥åœ¨<strong>5.6WKM</strong>å’Œ<strong>10.9WKM</strong>ä¹‹é—´ã€‚</p><blockquote><p>Moss ç»™å‡ºçš„æ´›å¸Œæé™å…¶å®æ˜¯å¤ªé˜³å’Œæœ¨æ˜Ÿçš„ï¼ˆ<strong>89WKM</strong>å’Œ<strong>171WKM</strong>ï¼‰ï¼Œè€Œä¸æ˜¯åœ°çƒå’Œæœ¨æ˜Ÿçš„ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> è¶£é—» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Summary </tag>
            
            <tag> Astronomy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å•åˆ©å’Œå¤åˆ©</title>
      <link href="/2025/03/17/qu-wen/2025-03-17-compound-interest/"/>
      <url>/2025/03/17/qu-wen/2025-03-17-compound-interest/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¬§æ‹‰æ•°"><a class="markdownIt-Anchor" href="#æ¬§æ‹‰æ•°"></a> æ¬§æ‹‰æ•°</h2><p>æ¬§æ‹‰æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">e</mi></mrow><annotation encoding="application/x-tex">\mathrm{e}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathrm">e</span></span></span></span></span> ï¼šä¸æ˜¯æ¬§æ‹‰ç¬¬ä¸€ä¸ªæå‡ºï¼Œæ¬§æ‹‰åªæ˜¯ç¬¬ä¸€ä¸ªä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">e</mi></mrow><annotation encoding="application/x-tex">\mathrm{e}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathrm">e</span></span></span></span></span> æ¥è¡¨ç¤ºè‡ªç„¶å¯¹æ•°çš„äººï¼›</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">e</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msup><mo stretchy="false">)</mo><mi>n</mi></msup><mo separator="true">,</mo><mi>n</mi><mo>â†’</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">\mathrm{e}=(1+\frac{1}{n})^{n},n\rightarrow \infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathrm">e</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord">âˆ</span></span></span></span></span></p><h2 id="å¤åˆ©"><a class="markdownIt-Anchor" href="#å¤åˆ©"></a> å¤åˆ©</h2><p>ä¸¾ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼Œå‡å®šåä¹‰åˆ©ç‡ 10%ï¼ŒåŠå¹´ä¸€å¤åˆ©ï¼Œå³åŠå¹´åä¹‰åˆ©ç‡ 5%ï¼Œæœ¬é‡‘ 100 å…ƒï¼Œåˆ™ï¼š</p><ul><li>ä¸ŠåŠå¹´ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mo>Ã—</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mn>0.05</mn><mo stretchy="false">)</mo><mo>=</mo><mn>105</mn></mrow><annotation encoding="application/x-tex">100 \times (1+0.05) = 105</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">5</span></span></span></span></li><li>ä¸‹åŠå¹´ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>105</mn><mo>Ã—</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mn>0.05</mn><mo stretchy="false">)</mo><mo>=</mo><mn>110.25</mn></mrow><annotation encoding="application/x-tex">105 \times(1+0.05) = 110.25</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord">5</span></span></span></span></li></ul><p>å¦‚æœæ²¡æœ‰å¤åˆ©ï¼Œåˆ™ä¸€å¹´æ”¶ç›Šä¸º 110ï¼Œå¦‚æœæœ‰å¤åˆ©çš„æƒ…å†µä¸‹ï¼Œå®é™…åˆ©ç‡ä¸º 10.25%ã€‚å¦‚æœå¤åˆ©æ— é™ç»†åˆ†ï¼Œé‚£ä¹ˆä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿå‡å®š n æœŸçš„æƒ…å†µä¸‹ï¼Œè®¡ç®—å…¬å¼å˜ä¸ºï¼š</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mi>V</mi><mo>=</mo><mi>P</mi><mi>V</mi><mo>Ã—</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mfrac><mi>r</mi><mi>n</mi></mfrac><msup><mo stretchy="false">)</mo><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">FV = PV \times(1+\frac{r}{n})^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></p><p>r è¡¨ç¤ºåä¹‰åˆ©ç‡ï¼›n è¡¨ç¤ºæœŸæ•°ï¼›PV è¡¨ç¤ºæœ¬é‡‘ï¼›FV è¡¨ç¤ºæ”¶ç›Šã€‚å½“æ— é™å¤åˆ©å‘ç”Ÿæ—¶ï¼Œæ•´ä¸ªå…¬å¼å˜ä¸ºï¼š</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mi>V</mi><mo>=</mo><mi>P</mi><mi>V</mi><mo>Ã—</mo><msup><mi mathvariant="normal">e</mi><mi>r</mi></msup><mo separator="true">,</mo><mi>n</mi><mo>â†’</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">FV = PV \times \mathrm{e}^r,n\rightarrow \infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9088319999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">e</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord">âˆ</span></span></span></span></span></p><p>æ­¤æ—¶å¦‚æœåä¹‰åˆ©ç‡æ˜¯ 10%ï¼Œæœ¬é‡‘ 100ï¼Œåˆ™ FV=110.517ï¼›å¦‚æœåä¹‰åˆ©ç‡æå‡åˆ° 100%ï¼Œåˆ™ FV=271.8ã€‚</p><h2 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h2><ol><li>å¤åˆ©æœ‰ä»–çš„æé™ï¼Œæé™å°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="normal">e</mi><mi>r</mi></msup></mrow><annotation encoding="application/x-tex">\mathrm{e}^r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">e</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span></span></span></span> ï¼›</li><li>å¤åˆ©çš„ç»“æœä»…å’Œåä¹‰åˆ©ç‡æœ‰å…³ç³»ï¼Œå’Œå…¶ä»–å› ç´ éƒ½æ²¡æœ‰å…³ç³»ï¼›</li></ol>]]></content>
      
      
      <categories>
          
          <category> è¶£é—» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Summary </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ‹è¯•é¡µé¢</title>
      <link href="/2025/03/17/2025-03-17-page-test/"/>
      <url>/2025/03/17/2025-03-17-page-test/</url>
      
        <content type="html"><![CDATA[<h2 id="äºŒçº§æ ‡é¢˜"><a class="markdownIt-Anchor" href="#äºŒçº§æ ‡é¢˜"></a> äºŒçº§æ ‡é¢˜</h2><h3 id="ä¸‰çº§æ ‡é¢˜"><a class="markdownIt-Anchor" href="#ä¸‰çº§æ ‡é¢˜"></a> ä¸‰çº§æ ‡é¢˜</h3><h4 id="å››çº§æ ‡é¢˜"><a class="markdownIt-Anchor" href="#å››çº§æ ‡é¢˜"></a> å››çº§æ ‡é¢˜</h4><h5 id="äº”çº§æ ‡é¢˜"><a class="markdownIt-Anchor" href="#äº”çº§æ ‡é¢˜"></a> äº”çº§æ ‡é¢˜</h5><h6 id="å…­çº§æ ‡é¢˜"><a class="markdownIt-Anchor" href="#å…­çº§æ ‡é¢˜"></a> å…­çº§æ ‡é¢˜</h6><h2 id="æ®µè½"><a class="markdownIt-Anchor" href="#æ®µè½"></a> æ®µè½</h2><p>I think Iâ€™ll use it to format all of my documents from now on.First line with the HTML tag after.</p><p>And the next line.</p><p>Apache Derby æ˜¯ç”± Apache Software Foundation å¼€å‘çš„å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ()ã€‚æ˜¯ä¸€ä¸ªå®Œå…¨ç”¨ java ç¼–å†™çš„æ•°æ®åº“ï¼ŒDerby æ˜¯ä¸€ä¸ª Open source çš„äº§å“ï¼ŒåŸºäº Apache License 2.0åˆ†å‘ã€‚</p><p>Apache Derby éå¸¸å°å·§ï¼Œæ ¸å¿ƒéƒ¨åˆ† derby. jar åªæœ‰ 2Mï¼Œæ‰€ä»¥æ—¢å¯ä»¥åšä¸ºå•ç‹¬çš„æ•°æ®åº“æœåŠ¡å™¨ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å†…åµŒåœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ã€‚</p><h2 id="æœ‰åºåˆ—è¡¨"><a class="markdownIt-Anchor" href="#æœ‰åºåˆ—è¡¨"></a> æœ‰åºåˆ—è¡¨</h2><ol><li>1</li><li>2</li><li>3</li><li>4</li></ol><h2 id="æ— åºåˆ—è¡¨"><a class="markdownIt-Anchor" href="#æ— åºåˆ—è¡¨"></a> æ— åºåˆ—è¡¨</h2><ul><li>1</li><li>2</li><li>3</li><li>4</li></ul><h2 id="ä»»åŠ¡åˆ—è¡¨"><a class="markdownIt-Anchor" href="#ä»»åŠ¡åˆ—è¡¨"></a> ä»»åŠ¡åˆ—è¡¨</h2><ul><li>[ ] Eat</li><li>[x] Code<ul><li>[x] HTML</li><li>[x] CSS</li><li>[x] JavaScript</li></ul></li><li>[ ] Sleep</li></ul><h2 id="ä»£ç "><a class="markdownIt-Anchor" href="#ä»£ç "></a> ä»£ç </h2><h3 id="ä»£ç å—"><a class="markdownIt-Anchor" href="#ä»£ç å—"></a> ä»£ç å—</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token keyword">extends</span> <span class="token class-name">Object</span><span class="token punctuation">{</span> <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span><span class="token punctuation">(</span> id <span class="token keyword">BIGINT</span><span class="token punctuation">,</span> name STRING<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¡Œå†…ä»£ç "><a class="markdownIt-Anchor" href="#è¡Œå†…ä»£ç "></a> è¡Œå†…ä»£ç </h3><p><code>import numpy as np</code><br><code>sb.append("a");</code><br><code>select * from tbl;</code></p><h2 id="å­—ä½“å˜åŒ–"><a class="markdownIt-Anchor" href="#å­—ä½“å˜åŒ–"></a> å­—ä½“å˜åŒ–</h2><p>åŠ ç²—ï¼š<strong>åŠ ç²—</strong><br>æ–œä½“ï¼š<em>æ–œä½“</em><br>é«˜äº®ï¼š<mark>é«˜äº®</mark><br>åˆ é™¤çº¿ï¼š<s>åˆ é™¤çº¿</s><br>ä¸‹åˆ’çº¿ï¼š<u>ä¸‹åˆ’çº¿</u><br>æ–œä½“åŠ ç²—ï¼š<em><strong>æ–œä½“åŠ ç²—</strong></em></p><h2 id="è¡¨æ ¼"><a class="markdownIt-Anchor" href="#è¡¨æ ¼"></a> è¡¨æ ¼</h2><table><thead><tr><th style="text-align:left">left</th><th style="text-align:center">center</th><th style="text-align:right">right</th></tr></thead><tbody><tr><td style="text-align:left">aaaa</td><td style="text-align:center">bbbbbb</td><td style="text-align:right">ccccc</td></tr><tr><td style="text-align:left">a</td><td style="text-align:center">b</td><td style="text-align:right">c</td></tr></tbody></table><p>æ·»åŠ é“¾æ¥çš„è¡¨æ ¼</p><table><thead><tr><th>name</th><th>age</th><th>blog</th></tr></thead><tbody><tr><td><em>LearnShare</em></td><td>12</td><td><a href="http://xianbai.me">LearnShare</a></td></tr><tr><td><strong>Mike</strong></td><td>32</td><td><a href="http://mike.me">Mike</a></td></tr></tbody></table><h2 id="åˆ†å‰²çº¿"><a class="markdownIt-Anchor" href="#åˆ†å‰²çº¿"></a> åˆ†å‰²çº¿</h2><hr><h2 id="é“¾æ¥"><a class="markdownIt-Anchor" href="#é“¾æ¥"></a> é“¾æ¥</h2><p>å¤–éƒ¨é“¾æ¥ï¼š<a href="https://www.google.com/">Google</a><br>å†…éƒ¨é“¾æ¥ï¼š[[çº¢æ™¯å¤©]]<br>å—é“¾æ¥ï¼š[[#æ— åºåˆ—è¡¨]]<br>ç½‘ç«™é“¾æ¥ï¼š <a href="https://markdown.com.cn">https://markdown.com.cn</a><br>åŠ ç²—æ ¼å¼é“¾æ¥ï¼šI love supporting the <strong><a href="https://eff.org">EFF</a></strong>.<br>æ–œä½“æ ¼å¼é“¾æ¥ï¼šThis is the <em><a href="https://www.markdownguide.org">Markdown Guide</a></em>.<br>ä»£ç æ ¼å¼é“¾æ¥ï¼šSee the section on <a href="#code"><code>code</code></a>.</p><h2 id="html"><a class="markdownIt-Anchor" href="#html"></a> HTML</h2><p>æŒ‰é”®ï¼š<kbd>Ctrl</kbd>+<kbd>c</kbd></p>]]></content>
      
      
      <categories>
          
          <category> PKM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‚¸é‡‘èŠ±</title>
      <link href="/2025/03/17/qu-wen/2025-03-17-chinese-poker/"/>
      <url>/2025/03/17/qu-wen/2025-03-17-chinese-poker/</url>
      
        <content type="html"><![CDATA[<h2 id="ç‚¸é‡‘èŠ±è§„åˆ™"><a class="markdownIt-Anchor" href="#ç‚¸é‡‘èŠ±è§„åˆ™"></a> ç‚¸é‡‘èŠ±è§„åˆ™</h2><p>æ¸¸æˆå‚ä¸äººæ•° 2-6 äººï¼Œä½¿ç”¨ä¸€å‰¯å»æ‰åˆ°å¤§å°ç‹çš„æ‰‘å…‹ç‰Œï¼Œå…± 52 å¼ ç‰Œã€‚æ¯”ç‰Œæ—¶åŒæ–¹ä¸èƒ½çœ‹åˆ°äº’ç›¸çš„ç‰Œï¼Œèƒœè€…ç»§ç»­æ¸¸æˆç›´è‡³ç»“æŸæœ¬å±€ï¼Œè´Ÿè€…æŸå¤±æœ¬å‰¯ç‰Œçš„æ“ä½œæƒï¼Œåªåœ¨æ¯å±€ç‰Œç»“æŸæ—¶å¯è§ã€‚æ¯”ç‰Œæ—¶å¦‚å‡ºç°åŒæ–¹ç‰Œå‹åŠå¤§å°ç›¸åŒçš„æƒ…å†µï¼Œä¸»åŠ¨æ¯”ç‰Œè€…ä¸ºè´Ÿè€…ã€‚æ¯å±€ç»“æŸæ—¶ï¼Œæ‰€æœ‰ç©å®¶åªèƒ½çœ‹è§è‡ªå·±æ¯”è¿‡æˆ–è·Ÿè‡ªå·±æ¯”è¿‡çš„ç©å®¶çš„æ‰‹ç‰Œã€‚</p><p>è±¹å­&gt;åŒèŠ±é¡º&gt;åŒèŠ±&gt;é¡ºå­&gt;ä¸€å¯¹&gt;æ•£ç‰Œ</p><blockquote><p>ç‰Œå‹å¤§å°å’ŒæŠ½åˆ°çš„æ¦‚ç‡ä¸€å®šæˆåæ¯”å—ï¼Ÿ</p></blockquote><h2 id="æ¦‚ç‡"><a class="markdownIt-Anchor" href="#æ¦‚ç‡"></a> æ¦‚ç‡</h2><ul><li>æ€»å…±çš„ç‰Œå‹æ•°é‡ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>C</mi><mn>52</mn><mn>3</mn></msubsup><mo>=</mo><mfrac><mrow><mn>52</mn><mo>Ã—</mo><mn>51</mn><mo>Ã—</mo><mn>50</mn></mrow><mrow><mn>1</mn><mo>Ã—</mo><mn>2</mn><mo>Ã—</mo><mn>3</mn></mrow></mfrac><mo>=</mo><mn>22100</mn></mrow><annotation encoding="application/x-tex">C_{52}^{3} = \frac{52 \times 51 \times 50}{1 \times 2 \times 3} = 22100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0622159999999998em;vertical-align:-0.24810799999999997em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2484389999999999em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mtight">2</span><span class="mbin mtight">Ã—</span><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">2</span><span class="mbin mtight">Ã—</span><span class="mord mtight">5</span><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mtight">5</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">2</span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span></span></span></span></li><li>è±¹å­ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>13</mn><mo>Ã—</mo><mn>4</mn><mo>=</mo><mn>52</mn></mrow><annotation encoding="application/x-tex">13 \times 4=52</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">2</span></span></span></span></li><li>åŒèŠ±é¡ºï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>Ã—</mo><mn>12</mn><mo>=</mo><mn>48</mn></mrow><annotation encoding="application/x-tex">4\times 12=48</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">8</span></span></span></span></li><li>åŒèŠ±ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>Ã—</mo><msubsup><mi>C</mi><mn>13</mn><mn>3</mn></msubsup><mo>âˆ’</mo><mn>48</mn><mo>=</mo><mn>1096</mn></mrow><annotation encoding="application/x-tex">4\times C_{13}^{3} - 48=1096</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0622159999999998em;vertical-align:-0.24810799999999997em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">9</span><span class="mord">6</span></span></span></span></li><li>é¡ºå­ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>12</mn><mo>Ã—</mo><mn>4</mn><mo>Ã—</mo><mn>4</mn><mo>Ã—</mo><mn>4</mn><mo>âˆ’</mo><mn>48</mn><mo>=</mo><mn>720</mn></mrow><annotation encoding="application/x-tex">12 \times 4\times 4 \times 4 - 48 = 720</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span><span class="mord">2</span><span class="mord">0</span></span></span></span></li><li>å¯¹å­ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>13</mn><mo>Ã—</mo><msubsup><mi>C</mi><mn>4</mn><mn>2</mn></msubsup><mo>âˆ—</mo><mn>48</mn><mo>=</mo><mn>3744</mn></mrow><annotation encoding="application/x-tex">13 \times C_{4}^{2} * 48 = 3744</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0622159999999998em;vertical-align:-0.24810799999999997em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">7</span><span class="mord">4</span><span class="mord">4</span></span></span></span></li><li>æ•£ç‰Œï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>22100</mn><mo>âˆ’</mo><mn>52</mn><mo>âˆ’</mo><mn>48</mn><mo>âˆ’</mo><mn>1096</mn><mo>âˆ’</mo><mn>720</mn><mo>âˆ’</mo><mn>3744</mn><mo>=</mo><mn>16440</mn></mrow><annotation encoding="application/x-tex">22100-52-48-1096-720-3744=16440</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mord">2</span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">5</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">9</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">7</span><span class="mord">2</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">7</span><span class="mord">4</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mord">4</span><span class="mord">4</span><span class="mord">0</span></span></span></span></li></ul><p>å¦‚æœæŒ‰ç…§æ¦‚ç‡ï¼šåŒèŠ±é¡º&gt;è±¹å­&gt;é¡ºå­&gt;åŒèŠ±&gt;å¯¹å­&gt;æ•£ç‰Œ</p><table><thead><tr><th></th><th style="text-align:center">è±¹å­</th><th style="text-align:center">åŒèŠ±é¡º</th><th style="text-align:center">åŒèŠ±</th><th style="text-align:center">é¡ºå­</th><th style="text-align:center">ä¸€å¯¹</th></tr></thead><tbody><tr><td>p</td><td style="text-align:center">0.24%</td><td style="text-align:center">0.22%</td><td style="text-align:center">5.0%</td><td style="text-align:center">3.3%</td><td style="text-align:center">16.9%</td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>p</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.326216em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></td><td style="text-align:center">425</td><td style="text-align:center">460</td><td style="text-align:center">20</td><td style="text-align:center">31</td><td style="text-align:center">6</td></tr></tbody></table><h2 id="è·Ÿäººæ•°çš„å…³ç³»"><a class="markdownIt-Anchor" href="#è·Ÿäººæ•°çš„å…³ç³»"></a> è·Ÿäººæ•°çš„å…³ç³»</h2><p>å¦‚æœæ˜¯ä¸€ä¸ªäººç©æ¸¸æˆï¼Œé‚£ä¹ˆä»–çš„æ¦‚ç‡å°±æ˜¯ä¸Šé¢åˆ†æçš„ï¼Œä½†æ˜¯å¤šäººæ¸¸æˆçš„æƒ…å†µä¸‹æ˜¯å¦ä¼šå¯¹æ•´ä½“æœ‰ä»»ä½•å½±å“å‘¢ï¼Ÿ</p><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/%E7%82%B8%E9%87%91%E8%8A%B1_image_1.png" alt="æ¦‚ç‡"></p><p><img src="https://typora-img-chart.oss-cn-beijing.aliyuncs.com/%E7%82%B8%E9%87%91%E8%8A%B1_image_2.png" alt="é‡‘èŠ±æ¦‚ç‡"></p><h2 id="ç»“è®º"><a class="markdownIt-Anchor" href="#ç»“è®º"></a> ç»“è®º</h2><ol><li>æ— è®ºå¤šå°‘äººç©æ¸¸æˆï¼Œé¡ºå­çš„æ¦‚ç‡ä½äºé‡‘èŠ±ï¼ŒåŒèŠ±é¡ºçš„æ¦‚ç‡ä½äºè±¹å­ï¼›</li><li>ç‚¸é‡‘èŠ±æ¸¸æˆä¸æ˜¯ç‰Œå‹è¶Šå¤§è¶Šéš¾æŠ“ï¼›</li><li>æ‰‘å…‹ä¸æ˜¯å®Œå…¨çš„æ¦‚ç‡æ¸¸æˆï¼Œéœ€è¦å¿ƒé‡Œåšå¼ˆï¼›</li></ol>]]></content>
      
      
      <categories>
          
          <category> è¶£é—» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åšå¼ˆè®º </tag>
            
            <tag> æ¦‚ç‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2025/03/17/hello-world/"/>
      <url>/2025/03/17/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="quick-start"><a class="markdownIt-Anchor" href="#quick-start"></a> Quick Start</h2><h3 id="create-a-new-post"><a class="markdownIt-Anchor" href="#create-a-new-post"></a> Create a new post</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexo new <span class="token string">"My New Post"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="run-server"><a class="markdownIt-Anchor" href="#run-server"></a> Run server</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="generate-static-files"><a class="markdownIt-Anchor" href="#generate-static-files"></a> Generate static files</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexo generate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="deploy-to-remote-sites"><a class="markdownIt-Anchor" href="#deploy-to-remote-sites"></a> Deploy to remote sites</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
